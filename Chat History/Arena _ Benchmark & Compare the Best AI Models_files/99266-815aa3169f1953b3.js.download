!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._posthogChunkIds=e._posthogChunkIds||{},e._posthogChunkIds[n]="019c97ba-c8b2-7322-9a53-6881c6bed408")}catch(e){}}();(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[99266],{315:(e,t,a)=>{"use strict";a.d(t,{NG:()=>g,sd:()=>f,Hd:()=>v});var i=a(91147),s=a(41568),r=a(96137),n=a(714),l=a(55771),o=a(53392),c=a(7860),d=a(1447),u=a(69460),m=a(45809),p=a(10744),h=a.n(p);function g(e){let{children:t,className:a,...s}=e;return(0,i.jsx)("div",{className:(0,c.cn)("not-prose my-0 flex w-full flex-col overflow-clip border","border-border text-text-primary rounded-lg",a),...s,children:t})}let f=(0,l.memo)(function(e){let{code:t,language:a="tsx",className:s,...o}=e,{highlightedHtml:d}=function(e){let{code:t,language:a}=e,[i,s]=(0,l.useState)(""),[o,c]=(0,l.useState)(!1),{resolvedTheme:d}=(0,n.D)();return(0,l.useEffect)(()=>{let e=!1;return async function(){if(!t)return s("");c(!0);try{let i=await (0,r.wY)(t,a,"dark"===d?"github-dark":"github-light");e||s(i)}catch(a){if(console.error("Error highlighting code:",a),!e){let e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");s('<pre class="shiki-code-block"><code>'.concat(e,"</code></pre>"))}}finally{e||c(!1)}}(),()=>{e=!0}},[t,a,d]),{highlightedHtml:i,isHighlighting:o}}({code:t,language:a}),u=(0,c.cn)(h().container,s);return d?(0,i.jsx)("div",{className:u,dangerouslySetInnerHTML:{__html:d},...o}):(0,i.jsx)("div",{className:u,...o,children:(0,i.jsx)("pre",{className:"m-0 whitespace-pre-wrap rounded-none px-4 py-3 font-mono text-[#24292e] dark:text-[#e1e4e8]",children:(0,i.jsx)("code",{className:"text-[11px] leading-normal sm:text-[13px]",children:t})})})});function x(e){let{children:t,className:a,...s}=e;return(0,i.jsx)("div",{className:(0,c.cn)("border-border flex items-center justify-between border-b px-4 py-2",a),...s,children:t})}function v(e){var t;let{inline:a,className:r,children:n,...l}=e,[,p]=(0,d.A)(),h=String(n).includes("\n"),v=null==r?void 0:r.includes("language-");if(!1!==a&&!h&&!v)return(0,i.jsx)("code",{className:(0,c.cn)("rounded px-1.5 py-0.5","bg-surface-tertiary","font-mono text-[0.9em]","text-text-primary font-medium",r),...l,children:n});let b=/language-(\w+)/.exec(null!=r?r:""),y=null!=(t=null==b?void 0:b[1])?t:"text",w=String(n).replace(/\n$/,"");return"math"===y?(0,i.jsx)("pre",{children:(0,i.jsx)("code",{className:r,...l,children:n})}):(0,i.jsxs)(g,{className:"not-prose relative","data-code-block":"true",children:[(0,i.jsxs)(x,{children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(s.FileCode,{size:14,className:"text-text-secondary"}),(0,i.jsx)("span",{className:"text-text-secondary text-sm font-medium",children:(0,o.eV)(y)})]}),(0,i.jsx)(u.G,{content:"Copy code",children:(0,i.jsx)(m.i,{variant:"textLink",size:16,onClick:()=>{p(w)}})})]}),(0,i.jsx)(f,{code:w,language:y})]})}},9024:(e,t,a)=>{"use strict";a.d(t,{Or:()=>r,UQ:()=>l,zH:()=>n});var i=a(91147),s=a(7860);let r=e=>{let{children:t,className:a,...r}=e;return(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsx)("table",{...r,className:(0,s.cn)("min-w-full",a),children:t})})},n=e=>{let{children:t,className:a,...r}=e;return(0,i.jsx)("th",{...r,className:(0,s.cn)("whitespace-nowrap px-3 py-2",a),children:t})},l=e=>{let{children:t,className:a,...r}=e;return(0,i.jsx)("td",{...r,className:(0,s.cn)("px-3 py-2",a),children:t})}},10744:e=>{e.exports={container:"code-block_container__lbMX4"}},11630:(e,t,a)=>{Promise.resolve().then(a.bind(a,62010))},25634:(e,t)=>{"use strict";t.D=function(e){switch(e){case"arcstride":return"arcstride";case"control":case!1:case void 0:return null}}},30911:(e,t)=>{"use strict";t.Bt=void 0,t.Bt="Conversation is too long. Please start a new chat."},32914:(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var i=a(91147),s=a(7860),r=a(16011),n=a(55771),l=a(98574),o=a(19730),c=a(65959),d=a(93315),u=a(93534);a(24568);var m=a(315),p=a(9024);let h=(0,n.memo)(e=>{let{content:t,id:a,className:l}=e,o=(0,n.useMemo)(()=>r.xI.lexer(t).map(e=>e.raw),[t]);return(0,i.jsx)("div",{className:(0,s.cn)("prose prose-sm prose-pre:bg-transparent prose-pre:p-0 text-wrap break-words",l),children:o.map((e,t)=>(0,i.jsx)(g,{content:e},"".concat(a,"-block_").concat(t)))})});h.displayName="MemoizedMarkdown";let g=(0,n.memo)(e=>{let{content:t}=e;return(0,i.jsx)(l.oz,{remarkPlugins:[c.A,d.A,[u.A,{singleDollarTextMath:!0}]],rehypePlugins:[[o.A,{displayMode:!0,throwOnError:!1,errorColor:"#cc0000"}]],components:{code:m.Hd,table:p.Or,th:p.zH,td:p.UQ},children:t})},(e,t)=>e.content===t.content);g.displayName="MemoizedMarkdownBlock"},33725:(e,t)=>{"use strict";t.f=function(e,t,a){if(!t||!t.trim())throw Error("Context cannot be empty.");let i=function(e,t,a){let i=e.indexOf(t);if(-1===i)return null;let s=e.indexOf(t,i+1);if(-1!==s){let a=2,i=s;for(;-1!==(i=e.indexOf(t,i+1))&&a<100;)a++;throw Error("Found ".concat(a," matches. Include more surrounding lines to make unique."))}return e.substring(0,i)+a+e.substring(i+t.length)}(e,t,a);if(i)return{content:i,matchType:"exact"};let s=/\S+/g,r=t.match(s);if(!r||0===r.length)throw Error("Context contains no searchable text.");let n=[];for(let t of e.matchAll(s)){if(void 0===t.index)throw Error("Unexpected error: match.index is undefined");n.push({text:t[0],start:t.index,end:t.index+t[0].length})}let l=[];for(let e=0;e<=n.length-r.length;e++){let t=!0;for(let a=0;a<r.length;a++){var o;if((null==(o=n[e+a])?void 0:o.text)!==r[a]){t=!1;break}}t&&l.push({startToken:n[e],endToken:n[e+r.length-1]})}let[c]=l;if(!c)throw Error("Context not found. Read the file to verify the text exists.");if(l.length>1)throw Error("Found ".concat(l.length," matches. Include more surrounding lines to make unique."));let d=c.startToken.start,u=c.endToken.end,m=e.substring(d,u);return{content:e.substring(0,d)+a+e.substring(u),matchType:"fuzzy",matchedText:m}}},39983:(e,t,a)=>{"use strict";t.VM=t.f0=void 0;let i=a(87953),s=a(83993);t.f0=i.z.object({status:i.z.literal("error"),message:i.z.string(),stdout:i.z.string().optional(),stderr:i.z.string().optional()});let r=i.z.object({toolCallId:i.z.string()}),n=r.extend({toolName:i.z.literal("create_file"),args:i.z.object({path:i.z.string(),content:i.z.string()}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),message:i.z.string(),lint_error:i.z.string().optional()}),t.f0]).nullable().catch(null)}),l=r.extend({toolName:i.z.literal("edit_file"),args:i.z.object({path:i.z.string(),context:i.z.string(),replacement:i.z.string()}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),message:i.z.string().optional(),match_type:i.z.enum(["exact","fuzzy"]).optional(),matched_text:i.z.string().optional(),lint_error:i.z.string().optional()}),t.f0]).nullable().catch(null)}),o=r.extend({toolName:i.z.literal("read_file"),args:i.z.object({path:i.z.string()}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),file:s.WebDevFileSchema}),t.f0]).nullable().catch(null)}),c=r.extend({toolName:i.z.literal("list_files"),args:i.z.object({}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),files:i.z.array(i.z.object({path:i.z.string()}))}),t.f0]).nullable().catch(null)}),d=r.extend({toolName:i.z.literal("delete_file"),args:i.z.object({path:i.z.string()}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success")}),t.f0]).nullable().catch(null)}),u=r.extend({toolName:i.z.literal("install_npm_packages"),args:i.z.object({packages:i.z.array(i.z.string())}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),stdout:i.z.string().optional(),stderr:i.z.string().optional()}),t.f0]).nullable().catch(null)}),m=r.extend({toolName:i.z.literal("build_project"),args:i.z.object({}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),stdout:i.z.string(),stderr:i.z.string()}),t.f0]).nullable().catch(null)}),p=r.extend({toolName:i.z.literal("deploy_project"),args:i.z.object({}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success")}),t.f0]).nullable().catch(null)}),h=r.extend({toolName:i.z.literal("apply_patch"),args:i.z.object({input:i.z.string()}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),message:i.z.string(),lint_error:i.z.string().optional()}),t.f0]).nullable().catch(null)}),g=r.extend({toolName:i.z.literal("shell_command"),args:i.z.object({command:i.z.string(),workdir:i.z.string().optional()}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success"),stdout:i.z.string().optional(),stderr:i.z.string().optional()}),t.f0]).nullable().catch(null)}),f=i.z.object({step:i.z.string(),status:i.z.string()}),x=r.extend({toolName:i.z.literal("update_plan"),args:i.z.object({explanation:i.z.string().optional(),plan:i.z.array(f)}),result:i.z.discriminatedUnion("status",[i.z.object({status:i.z.literal("success")}),t.f0]).nullable().catch(null)});t.VM=i.z.discriminatedUnion("toolName",[n,l,o,c,d,u,m,p,h,g,x])},40909:(e,t,a)=>{"use strict";a.d(t,{Ke:()=>n,Nt:()=>s,R6:()=>r});var i=a(32783);let s=i.bL,r=i.R6,n=i.Ke},41565:(e,t,a)=>{"use strict";t.ff=t.yR=void 0;let i=function(e){return e&&e.__esModule?e:{default:e}}(a(6391)),s=a(52283);t.yR=e=>{var t;let{seed:a,battlesInDirectTreatment:s,previousTurnMode:r,n}=e,l=(0,i.default)(a),o=l();if(!r||"battle"===r||0===n)return"direct";for(;n>0;)o=l(),n--;let c=function(e){switch(e){case"random-random-10":return{probability:.1,strategy:"random-random"};case"random-random-20":return{probability:.2,strategy:"random-random"};case"random-user-selected-10":return{probability:.1,strategy:"random-user-selected"};case"random-user-selected-20":return{probability:.2,strategy:"random-user-selected"};case"always-battle-random":return{probability:1,strategy:"random-random"};case"always-battle-user-selected":return{probability:1,strategy:"random-user-selected"};case"control":case void 0:return null}}(s);return o<(null!=(t=null==c?void 0:c.probability)?t:0)?"battle":"direct"},t.ff=e=>{switch(e.length){case 1:return s.EChatMode.DIRECT;case 2:return s.EChatMode.BATTLE;default:return}}},45809:(e,t,a)=>{"use strict";a.d(t,{i:()=>o});var i=a(91147),s=a(41568),r=a(55771),n=a(7860),l=a(31959);let o=e=>{let{onClick:t,className:a,size:o=18,...c}=e,{copyState:d,handleClick:u}=(()=>{let[e,t]=(0,r.useState)("idle"),a=(0,r.useRef)(null),i=(0,r.useRef)(null);return{copyState:e,handleClick:()=>{null!=a.current&&clearTimeout(a.current),null!=i.current&&clearTimeout(i.current),t("copied"),a.current=setTimeout(()=>{t("resetting"),i.current=setTimeout(()=>{t("idle")},300)},2e3)}}})();return(0,i.jsxs)(l.Button,{variant:"outline",className:(0,n.cn)("relative rounded-lg p-[6px]",a),onClick:e=>{null==t||t(e),u()},...c,children:[(0,i.jsx)(s.Check,{size:o,className:(0,n.cn)("text-interactive-positive absolute inset-0 m-auto rotate-90 opacity-0 transition-all duration-300",{"rotate-0 opacity-100":"copied"===d,"rotate-0 opacity-0":"resetting"===d})}),(0,i.jsx)(s.Copy,{size:o,className:(0,n.cn)("absolute inset-0 m-auto opacity-100 transition-opacity duration-300",{"opacity-0":"copied"===d})})]})}},46988:(e,t,a)=>{"use strict";a.d(t,{FO:()=>r,Yq:()=>i,ZV:()=>s});let i=e=>{if(isNaN(e.getTime()))return"N/A";let t=new Date;return e>t?(console.warn("Future date detected: ".concat(e,", using today's date instead")),t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}).replace(/(\w+) (\d+), (\d+)/,"$1 $2, $3")):e.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}).replace(/(\w+) (\d+), (\d+)/,"$1 $2, $3")},s=e=>null==e?"0":e.toLocaleString("en-US"),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;if(!e)return null;let a=("string"==typeof e?new Date(e):e).getTime()-t.getTime();if(a<=0)return null;let i=Math.ceil(a/1e3),s=Math.ceil(a/6e4),r=Math.ceil(a/36e5);return i<60?"".concat(i," second").concat(1===i?"":"s"):s<60?"".concat(s," minute").concat(1===s?"":"s"):"".concat(r," hour").concat(1===r?"":"s")}},50947:(e,t,a)=>{"use strict";a.d(t,{A:()=>s,I:()=>r});var i=a(10708);let s=(0,i.eU)([]),r=(0,i.eU)({})},53392:(e,t,a)=>{"use strict";a.d(t,{eV:()=>s,sQ:()=>r});let i={js:"JavaScript",javascript:"JavaScript",ts:"TypeScript",typescript:"TypeScript",jsx:"React",tsx:"React",py:"Python",python:"Python",java:"Java",c:"C",cpp:"C++",cs:"C#",php:"PHP",rb:"Ruby",ruby:"Ruby",go:"Go",rs:"Rust",rust:"Rust",kt:"Kotlin",kotlin:"Kotlin",swift:"Swift",m:"Objective-C",objc:"Objective-C",scala:"Scala",shell:"Shell",bash:"Bash",sh:"Shell",powershell:"PowerShell",ps1:"PowerShell",yaml:"YAML",yml:"YAML",json:"JSON",xml:"XML",html:"HTML",css:"CSS",scss:"SCSS",sass:"Sass",less:"Less",sql:"SQL",graphql:"GraphQL",md:"Markdown",markdown:"Markdown",tex:"LaTeX",latex:"LaTeX",r:"R",matlab:"MATLAB",perl:"Perl",lua:"Lua",vim:"Vim",diff:"Diff",dockerfile:"Dockerfile",docker:"Docker",makefile:"Makefile",make:"Makefile"};function s(e){var t;return null!=(t=i[e.toLowerCase()])?t:e}function r(e){var t;switch(null==(t=e.split(".").pop())?void 0:t.toLowerCase()){case"js":case"jsx":return"javascript";case"ts":case"tsx":return"typescript";case"py":return"python";case"json":return"json";case"css":case"scss":case"sass":return"css";case"html":return"html";case"md":return"markdown";case"yml":case"yaml":return"yaml";case"sql":return"sql";case"java":return"java";case"cpp":case"cc":case"cxx":return"cpp";case"c":return"c";case"go":return"go";case"rs":return"rust";case"php":return"php";case"rb":return"ruby";case"swift":return"swift";case"kt":return"kotlin";case"scala":return"scala";case"sh":case"bash":return"bash";case"ps1":return"powershell";case"xml":return"xml";case"graphql":case"gql":return"graphql";case"tex":return"latex";case"r":return"r";case"lua":return"lua";case"perl":case"pl":return"perl";case"vim":return"vim";case"dockerfile":return"dockerfile";case"makefile":case"make":return"makefile";default:return"text"}}},62010:(e,t,a)=>{"use strict";a.d(t,{Evaluation:()=>lI});var i=a(91147),s=a(24919),r=a(41568),n=a(20480),l=a(31959),o=a(1835),c=a(57878),d=a(85841),u=a(37995),m=a(40612),p=a(10708),h=a(63180),g=a(55771),f=a(27069);let x=(0,p.eU)(!1),v=(0,p.eU)(null);function b(){let[e,t]=(0,h.fp)(x),[a,i]=(0,h.fp)(v);return{isOpen:e,setOpen:t,promiseHandlers:a,setPromiseHandlers:i}}function y(){let{isOpen:e,setOpen:t,promiseHandlers:a,setPromiseHandlers:s}=b(),{setTouConsentTimestamp:p,userCreationPromise:h}=(0,m.kH)(e=>e),[x,v]=(0,g.useState)(!1),y=async()=>{try{await h,p(new Date().toISOString()),null==a||a.resolve(),s(null),t(!1),u.F.me["update-tou-consent"].$post().catch(()=>{console.error("Failed to persist TOU consent to server")})}catch(e){d.z.capture({action:"terms_of_service_modal_accept_failed"}),f.oR.error("Failed to accept terms-of-use"),null==a||a.reject(),s(null)}finally{v(!1)}};return(0,i.jsx)(o.lG,{open:e,onOpenChange:e=>{e||(v(!1),null==a||a.reject(),s(null),t(!1))},children:(0,i.jsxs)(o.Cf,{className:"border-border-faint w-[calc(100%-2rem)] max-w-[610px] rounded-lg p-4 sm:p-6",children:[(0,i.jsxs)(o.c7,{className:"flex flex-col gap-3 sm:gap-4",children:[(0,i.jsxs)(o.L3,{className:"flex items-center gap-2 text-base sm:text-lg",children:[(0,i.jsx)(c.E,{size:20,className:"sm:hidden"}),(0,i.jsx)(c.E,{size:24,className:"hidden sm:block"}),(0,i.jsx)("span",{className:"leading-tight",children:"Terms of Use & Privacy Policy"})]}),(0,i.jsxs)(o.rr,{className:"text-xs leading-relaxed sm:text-sm",children:['By clicking "Agree", you agree to be bound by our'," ",(0,i.jsx)(n.Link,{href:"/terms-of-use",target:"_blank",className:"underline",children:"Terms of Use"})," ","and acknowledge receipt and understanding of our"," ",(0,i.jsx)(n.Link,{href:"/privacy-policy",target:"_blank",className:"underline",children:"Privacy Policy"}),'. Our Services must not be used for any illegal, harmful, violent, racist, sexual, or other offensive purposes, or to upload sensitive information. Due to the nature of artificial intelligence ("AI") technologies, the Services may make mistakes and provide responses that are inaccurate or inappropriate for your input. ',"Arena"," is not responsible for any such mistakes, inaccuracies, or inappropriate responses and you should verify the responses' accuracy. This site is protected by reCAPTCHA and the Google"," ",(0,i.jsx)(n.Link,{href:"https://policies.google.com/privacy",children:"Privacy Policy"})," and"," ",(0,i.jsx)(n.Link,{href:"https://policies.google.com/terms",children:"Terms of Service"})," apply."]}),(0,i.jsx)("div",{children:(0,i.jsxs)(n.Link,{href:"/how-it-works",className:"text-primary inline-flex items-center gap-1 hover:underline",target:"_blank",children:[(0,i.jsx)("span",{className:"text-xs sm:text-sm",children:"Learn more about How it Works"}),(0,i.jsx)(r.ArrowRight,{size:12,className:"sm:hidden"}),(0,i.jsx)(r.ArrowRight,{size:14,className:"hidden sm:block"})]})})]}),(0,i.jsxs)(o.Es,{className:"bg-surface-tertiary -mx-4 -mb-4 w-[calc(100%+2rem)] flex-col gap-3 rounded-b-lg px-4 py-3 sm:-mx-6 sm:-mb-6 sm:w-[calc(100%+3rem)] sm:flex-row sm:items-center sm:justify-between sm:px-6 sm:py-4",children:[(0,i.jsxs)("div",{className:"hidden items-center justify-start gap-1 sm:flex",children:[(0,i.jsx)(r.CornerDownRight,{size:16,className:"text-text-secondary"}),(0,i.jsxs)("span",{className:"text-text-tertiary text-xs",children:["Or hit ",(0,i.jsx)("span",{className:"text-text-secondary font-medium",children:"Enter"})," on your keyboard to agree"]})]}),(0,i.jsx)(l.Button,{disabled:x,onClick:()=>{v(!0),y()},type:"submit",className:"w-full sm:w-auto",children:"Agree"})]})]})})}var w=a(25886),j=a(62770),N=a(91428),k=a(29686),E=a(69213),A=a(73647);function C(){return"treatment-1"===(0,A._P)("in-app-chat-notifications-m1-round-2")}var _=a(7860),B=a(22036),T=a(51547),I=a(72711),S=a(5269),R=a(64751),M=a(22862);function D(){let e=(0,M.A)(),t=(0,S.d)("md"),[a,n,l]=(0,N.g)((0,k.k)(e=>[e.mode,e.modality,e.messages.length>0])),[,o]=(0,R.b)(),c=(0,w.rd)(),d="control"!==(0,A._P)("battles-in-direct-2"),u=n===s.Jg.VIDEO,m=(0,g.useMemo)(()=>{switch(a){case s.lY.BATTLE:return(0,i.jsx)(O,{title:"Battle Mode",Icon:r.Swords});case s.lY.SIDE_BY_SIDE:return(0,i.jsx)(O,{title:"Side by Side",Icon:r.Columns2});case s.lY.DIRECT:return(0,i.jsx)(O,{title:"Direct",Icon:r.SendHorizontal});case s.lY.DIRECT_BATTLE:return(0,i.jsx)(O,{title:"Direct",Icon:r.Send});default:throw Error("Invalid mode")}},[a]),p=(0,g.useCallback)(t=>{if(!e()||t===a)return;let i=n===s.Jg.AUTO||n===s.Jg.P2L?s.Jg.CHAT:n;l?c.push((0,j.PY)(i,t)):o(t)},[e,c,a,n,l,o]);return(0,i.jsxs)(I.l6,{value:a,onValueChange:p,children:[(0,i.jsx)(I.bq,{className:"h-[29px] w-[280px] max-w-max border-none",children:(0,i.jsx)(I.yv,{children:m})}),(0,i.jsx)(I.gC,{align:t?"center":"start","data-mode-selector":!0,className:"bg-surface-secondary w-[290px] rounded-[6px] [&>[data-radix-select-viewport]]:p-0",children:(0,i.jsxs)(I.s3,{children:[(0,i.jsx)(P,{value:s.lY.BATTLE,headerText:"Battle Mode",descriptionText:"Battle 2 anonymous models",Icon:r.Swords}),(0,i.jsx)(I.mi,{className:"-mx-0 my-0 w-[calc(100%+8px)]"}),(0,i.jsx)(P,{value:s.lY.SIDE_BY_SIDE,headerText:"Side by Side",descriptionText:u?"Not available for Video":"Compare 2 models of your choice",Icon:r.Columns2,disabled:u}),(0,i.jsx)(I.mi,{className:"-mx-0 my-0 w-[calc(100%+8px)]"}),(0,i.jsx)(P,{value:d?s.lY.DIRECT_BATTLE:s.lY.DIRECT,headerText:"Direct",descriptionText:u?"Not available for Video":"Chat with 1 model at a time",Icon:d?r.Send:r.SendHorizontal,disabled:u})]})})]})}function O(e){let{title:t,Icon:a}=e;return(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(a,{className:"h-[18px] w-[18px]"}),(0,i.jsx)("p",{className:"text-base font-normal",children:t})]})}function P(e){let{value:t,headerText:a,descriptionText:s,Icon:r,disabled:n}=e;return(0,i.jsx)(I.eb,{value:t,showCheck:!1,disabled:n,className:"data-[state=checked]:text-text-tertiary data-[state=checked]:hover:text-header-primary group relative cursor-pointer rounded-none p-0",children:(0,i.jsxs)("div",{className:"flex items-center justify-center gap-3 p-2",children:[(0,i.jsx)(r,{className:"size-6"}),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{className:"text-base font-normal",children:a}),(0,i.jsx)("p",{className:"text-text-tertiary text-sm font-thin",children:s})]})]})})}var z=a(67487),L=a(98159),U=a(80336);function F(e,t){if(!e)return!1;let a=t.find(t=>t.id===e);return!!a&&((0,U.S1)(a)||(0,U.j4)(a)||(0,U.HI)(a)||(0,U.Jo)(a))}function G(e,t){var a,i;if(!e)return!1;let s=t.find(t=>t.id===e);return!!s&&!!(null==(i=s.capabilities)||null==(a=i.inputCapabilities)?void 0:a.file)}function H(e,t,a,i,r){switch(e){case s.lY.BATTLE:if(r===s.Jg.SEARCH)return!1;return r===s.Jg.CHAT||r===s.Jg.WEBDEV||r===s.Jg.AUTO||r===s.Jg.IMAGE||r===s.Jg.VIDEO;case s.lY.SIDE_BY_SIDE:return F(t,i)&&F(a,i);case s.lY.DIRECT:case s.lY.DIRECT_BATTLE:default:return F(t,i)}}function V(e,t,a,i,r){if(r!==s.Jg.CHAT&&r!==s.Jg.AUTO)return!1;switch(e){case s.lY.BATTLE:return!0;case s.lY.SIDE_BY_SIDE:return G(t,i)&&G(a,i);case s.lY.DIRECT:case s.lY.DIRECT_BATTLE:default:return G(t,i)}}function W(e,t){var a,i;if(!e)return!1;let s=t.find(t=>t.id===e);if(!s)return!1;let r=null==(i=s.capabilities)||null==(a=i.inputCapabilities)?void 0:a.image;return"object"==typeof r&&!0===r.requiresUpload}var Y=a(50947);let J=(0,p.eU)(!1),q=(0,p.eU)(null);function Q(){let[e,t]=(0,h.fp)(J),[a,i]=(0,h.fp)(q);return{isOpen:e,setOpen:t,navigationTarget:a,setNavigationTarget:i,showModalitySwitchModal:e=>{i(null!=e?e:null),t(!0)}}}function K(){let{isOpen:e,setOpen:t,navigationTarget:a}=Q(),s=(0,w.rd)();return e?(0,i.jsx)(o.lG,{open:!0,onOpenChange:e=>{e||t(!1)},children:(0,i.jsxs)(o.Cf,{className:"w-[calc(100%-2rem)] max-w-lg rounded-lg p-4 sm:p-6",children:[(0,i.jsxs)(o.c7,{className:"flex flex-col gap-2",children:[(0,i.jsx)(o.L3,{className:"text-base leading-tight sm:text-lg",children:"Start new chat session?"}),(0,i.jsx)(o.rr,{className:"text-xs leading-relaxed sm:text-sm",children:"Changing modalities will start a new chat session. Your current session will be saved in your chat history."})]}),(0,i.jsxs)(o.Es,{className:"w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-end sm:gap-2",children:[(0,i.jsx)(l.Button,{onClick:()=>void(t(!1),s.push(null!=a?a:"/")),type:"submit",className:"w-full sm:order-2 sm:w-auto",children:"Continue"}),(0,i.jsxs)("div",{className:"order-1 hidden items-center justify-start gap-1 sm:flex",children:[(0,i.jsx)(r.CornerDownRight,{size:16,className:"text-text-secondary"}),(0,i.jsxs)("span",{className:"text-text-tertiary text-xs",children:["Or hit ",(0,i.jsx)("span",{className:"text-text-secondary font-medium",children:"Enter"})," on your keyboard to continue"]})]})]})]})}):null}var X=a(33592),Z=a(86426);function $(){let[e,t,a]=(0,N.g)((0,k.k)(e=>[e.modality,e.mode,e.initialize]));return[function(e){switch(e){case s.Jg.CHAT:return"chat";case s.Jg.IMAGE:return"image";case s.Jg.WEBDEV:return"code";case s.Jg.SEARCH:return"search";case s.Jg.VIDEO:return"video";case s.Jg.AUTO:return"auto";case s.Jg.AUDIO:case s.Jg.P2L:default:return"chat"}}(e),(0,g.useCallback)((e,i)=>{let r=null!=i?i:t;a((0,X.Oe)(r,e,e===s.Jg.AUTO));let n=(0,j.PY)(e,r);(0,Z.LB)(n),(0,Z.$H)(n)},[t,a])]}function ee(){let{modality:e,messagesLength:t,mode:a}=(0,N.g)((0,k.k)(e=>({modality:e.modality,messagesLength:e.messages.length,mode:e.mode}))),{setModelAId:i,setModelBId:r}=(0,L.g)((0,k.k)(e=>({setModelAId:e.setModelAId,setModelBId:e.setModelBId}))),[,n]=$(),{showModalitySwitchModal:l}=Q();return(0,g.useCallback)(o=>{let c=null!=o?o:s.Jg.CHAT,d=c===s.Jg.VIDEO?s.lY.BATTLE:a;if(o===e)return t>0?void l("/text"):(n(s.Jg.CHAT,d),i(null),void r(null));t>0?l((0,j.PY)(c,d)):n(c,d)},[e,t,a,l,n,i,r])}var et=a(77585),ea=a(83718),ei=a(84602),es=a(68930);function er(e){let{isSelected:t}=e;return(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(es.e,{size:24,className:"min-h-6 min-w-6 flex-none"}),(0,i.jsxs)("div",{className:"flex flex-col items-start gap-[4px]",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-interactive-normal text-lg leading-5",children:"Max"}),t&&(0,i.jsx)(r.Check,{className:"text-interactive-positive size-6 flex-none"})]}),(0,i.jsxs)("p",{className:"text-text-tertiary text-balance text-base leading-5",children:["Intelligently routes you to the most capable model for your specific prompt with latency in mind."," ",(0,i.jsx)(n.Link,{href:"https://arena.ai/blog/introducing-max",className:"text-interactive-link hover:underline",onClick:e=>e.stopPropagation(),children:"Learn more"})]})]})]})}function en(e){var t;let{model:a,isSelected:s,onSelect:r,variant:n="command"}=e,l="flex flex-col items-start gap-1 rounded-[4px] px-3 py-2 hover:bg-surface-tertiary cursor-pointer";return"button"===n?(0,i.jsx)("button",{type:"button",onClick:()=>r(a.id),className:(0,_.cn)(l,"w-full text-left"),children:(0,i.jsx)(er,{isSelected:s})}):(0,i.jsx)(ei.h_,{value:null!=(t=a.displayName)?t:a.publicName,keywords:["max","auto","router"],onSelect:()=>r(a.id),className:l,children:(0,i.jsx)(er,{isSelected:s})})}var el=a(34450),eo=a(42328),ec=a(20947);function ed(e){var t,a,s,n,l,o,c,d,u;let{capabilities:m}=e,p="object"==typeof(null==m||null==(t=m.inputCapabilities)?void 0:t.image)&&(null==m||null==(s=m.inputCapabilities)||null==(a=s.image)?void 0:a.requiresUpload)===!0,h=(null==m||null==(n=m.inputCapabilities)?void 0:n.text)&&(null==m||null==(l=m.inputCapabilities)?void 0:l.image),g=(null==m||null==(o=m.inputCapabilities)?void 0:o.file)&&(null==m||null==(c=m.inputCapabilities)?void 0:c.text);return(0,i.jsxs)("div",{className:"flex gap-3",children:[h&&(0,i.jsxs)(eo.m_,{children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:"pointer-events-auto inline-flex cursor-help",children:(0,i.jsx)(r.Glasses,{className:"text-text-tertiary size-4"})})}),(0,i.jsx)(eo.ZI,{side:"top",sideOffset:4,children:"Vision"})]}),(null==m||null==(d=m.outputCapabilities)?void 0:d.search)&&(0,i.jsxs)(eo.m_,{children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:"pointer-events-auto inline-flex cursor-help",children:(0,i.jsx)(r.Globe,{className:"text-text-tertiary size-4"})})}),(0,i.jsx)(eo.ZI,{side:"top",sideOffset:4,children:"Search"})]}),p&&(0,i.jsxs)(eo.m_,{children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:"pointer-events-auto inline-flex cursor-help",children:(0,i.jsx)(r.ImageUp,{className:"text-text-tertiary size-4"})})}),(0,i.jsx)(eo.ZI,{side:"top",sideOffset:4,children:"Requires Image Upload"})]}),(null==m||null==(u=m.outputCapabilities)?void 0:u.image)&&(0,i.jsxs)(eo.m_,{children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:"pointer-events-auto inline-flex cursor-help",children:(0,i.jsx)(r.Image,{className:"text-text-tertiary size-4"})})}),(0,i.jsx)(eo.ZI,{side:"top",sideOffset:4,children:"Image Generation"})]}),g&&(0,i.jsxs)(eo.m_,{children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:"pointer-events-auto inline-flex cursor-help",children:(0,i.jsx)(ec.A,{className:"text-text-tertiary size-4"})})}),(0,i.jsx)(eo.ZI,{side:"top",sideOffset:4,children:"File Upload"})]})]})}function eu(e){var t;let{item:a,showRank:s=!0,badge:n}=e,{model:l,isSelected:o,isExcluded:c,displayRank:d}=a;return(0,i.jsxs)(i.Fragment,{children:[l.organization&&(0,i.jsx)(el.D,{className:"size-4 flex-none",organization:l.organization}),(0,i.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:[(0,i.jsx)("span",{className:(0,_.cn)("truncate font-mono text-sm",o?"text-interactive-positive":"text-interactive-normal"),children:null!=(t=l.displayName)?t:l.publicName}),n,o&&(0,i.jsx)(r.Check,{className:(0,_.cn)("text-interactive-positive size-4 flex-none")}),c&&!o&&(0,i.jsx)(r.Check,{className:"text-interactive-normal size-4 flex-none"})]}),(0,i.jsx)("div",{className:"flex flex-none items-center gap-2",children:(0,i.jsx)(ed,{capabilities:l.capabilities})})]})}function em(e){let{visibleArenaOptions:t,selectedArenaOptionId:a,disabledArenaOptionIds:s,onArenaChange:r,className:n,preventEventPropagation:o=!1}=e;return(0,i.jsx)("div",{className:(0,_.cn)("flex gap-2 py-2",n),"data-arena-buttons":!0,children:t.map(e=>(0,i.jsxs)(l.Button,{variant:"outline",disabled:null==s?void 0:s.includes(e.id),onClick:t=>{o&&(t.preventDefault(),t.stopPropagation()),a!==e.id&&r(e.id)},className:(0,_.cn)("flex-1 rounded-[4px]","hover:bg-surface-tertiary",a===e.id&&"text-text-tertiary bg-surface-primary border-border-faint hover:text-text-tertiary hover:bg-surface-primary"),children:[e.icon,e.label]},e.id))})}function ep(e){let{children:t}=e;return(0,i.jsx)("div",{className:"text-text-secondary py-2 text-sm font-medium",children:t})}function eh(){return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center px-4 py-8 text-center",children:[(0,i.jsx)("div",{className:"text-text-tertiary mb-3",children:(0,i.jsx)(r.Search,{className:"mr-2 size-6 shrink-0 opacity-50"})}),(0,i.jsx)("p",{className:"text-text-secondary mb-1 text-sm",children:"No models found"}),(0,i.jsx)("p",{className:"text-text-tertiary text-xs",children:"Try adjusting your search term"})]})}function eg(e){let{show:t,className:a}=e;return(0,i.jsx)("div",{className:(0,_.cn)("pointer-events-none absolute bottom-0 left-0 right-0 h-[60px] rounded-b-3xl bg-[linear-gradient(0deg,rgba(253,253,254,1)_0%,rgba(253,253,254,0)_100%)] transition-opacity duration-150 ease-out dark:bg-[linear-gradient(0deg,rgba(29,29,32,1)_0%,rgba(29,29,32,0)_100%)]",t?"opacity-100":"opacity-0",a)})}function ef(e){let{onClear:t,className:a}=e;return(0,i.jsx)("button",{onClick:t,className:(0,_.cn)("hover:bg-surface-secondary rounded-md p-1 transition-colors",a),type:"button",children:(0,i.jsx)(r.X,{className:"text-text-tertiary size-3"})})}function ex(e,t){var a;if(!e)return"All Models";let i=null==(a=t.find(t=>t.id===e))?void 0:a.label;return i?"Top ".concat(i," Models"):"All Models"}var ev=a(72949),eb=a(16157),ey=a(82216);let ew=(0,ev.F)("inline-flex items-center gap-1 rounded-[4px] border font-normal transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{size:{small:"px-1 py-0.5 text-[10px]",regular:"px-1.5 py-0.5 text-xs"},variant:{default:"border-transparent bg-interactive-cta text-interactive-on-cta",secondary:"border-transparent bg-surface-tertiary text-text-secondary",destructive:"border-transparent bg-interactive-negative text-interactive-inverted",outline:"border-border-faint bg-surface-primary text-text-primary",info:"border-transparent bg-interactive-link/15 text-interactive-link",positive:"border-transparent bg-interactive-positive/15 text-interactive-positive",notice:"border-transparent bg-interactive-warning/15 text-interactive-warning",warning:"border-transparent bg-interactive-negative/15 text-interactive-negative",announcement:"border-transparent text-text-muted bg-gradient-to-r from-interactive-link/20 to-interactive-purple/20"}},defaultVariants:{size:"regular",variant:"secondary"}});function ej(e){let{size:t,variant:a,className:s,...r}=e;return(0,i.jsx)("span",{className:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,ey.QP)((0,eb.$)(t))}(ew({size:t,variant:a}),s),...r})}var eN=a(79787);let ek=[{icon:(0,i.jsx)(r.Type,{className:"size-4"}),label:"Text",id:"text"},{icon:(0,i.jsx)(r.Code,{className:"size-4"}),label:"Code",id:"code"},{icon:(0,i.jsx)(r.Image,{className:"size-4"}),label:"Image",id:"text-to-image"},{icon:(0,i.jsx)(r.Globe,{className:"size-4"}),label:"Search",id:"search"}];r.Image,r.Globe;let eE={text:e=>(0,U.oN)(e),vision:e=>(0,U.S1)(e),"text-to-image":e=>(0,U.hK)(e),"image-edit":e=>(0,U.j4)(e),search:e=>(0,U.cK)(e),"text-to-video":e=>(0,U.D_)(e),"video-to-video":e=>(0,U.H3)(e),code:e=>(0,U.JQ)(e),"image-to-code":e=>(0,U.Jo)(e),"image-to-video":e=>(0,U.HI)(e),"multi-image-edit":e=>(0,U.j4)(e),document:e=>(0,U.RS)(e)},eA={text:s.Jg.CHAT,vision:s.Jg.CHAT,"text-to-image":s.Jg.IMAGE,"image-edit":s.Jg.IMAGE,"multi-image-edit":s.Jg.IMAGE,search:s.Jg.SEARCH,"text-to-video":s.Jg.VIDEO,"image-to-video":s.Jg.VIDEO,"video-to-video":s.Jg.VIDEO,code:s.Jg.WEBDEV,"image-to-code":s.Jg.WEBDEV,document:s.Jg.CHAT},eC={[s.Jg.AUTO]:"text",[s.Jg.CHAT]:"text",[s.Jg.AUDIO]:"text",[s.Jg.IMAGE]:"text-to-image",[s.Jg.SEARCH]:"search",[s.Jg.VIDEO]:"text-to-video",[s.Jg.WEBDEV]:"code",[s.Jg.P2L]:"text"},e_={NEW:(0,i.jsx)(ej,{variant:"info",size:"small",children:"NEW"}),BETA:(0,i.jsx)(ej,{variant:"notice",size:"small",children:"BETA"})},eB=e=>void 0!==e&&"string"!=typeof e&&"modelName"in e;function eT(e){return e.toLowerCase().replace(/[\s.\-_]/g,"")}function eI(e,t){if(!t)return!0;let a=eT(null!=e?e:"");return t.trim().toLowerCase().split(/\s+/).every(e=>a.includes(eT(e)))}function eS(e){var t,a;let{models:i,modelA:s,searchValue:r,setSearchValue:n,disabledFlags:l,currentArena:o,anchorRequiresImageUpload:c,hasImageAttachment:u,hasFileAttachment:m,excludeModelIds:p,fadeThreshold:h=3}=e,[f,x]=(0,g.useState)(!1),v=(0,g.useRef)(null),b=(0,A.qc)("model-selector-featured-models"),y=null!=b?b:[{modelName:"boss-bandit",callout:"NEW"}],w=(0,g.useMemo)(()=>(null==s?void 0:s.id)?[s.id]:[],[null==s?void 0:s.id]),j=(0,g.useMemo)(()=>(null==l?void 0:l.isRemoveADisabled)&&(null==s?void 0:s.id)?[s.id]:[],[null==l?void 0:l.isRemoveADisabled,null==s?void 0:s.id]),N=(0,g.useMemo)(()=>{let e=(null!=r?r:"").trim();return e?i.filter(t=>eI(t.displayName,e)):i},[i,r]);(0,g.useLayoutEffect)(()=>{let e=v.current;e&&x(e.scrollTop+e.clientHeight>=e.scrollHeight-1)},[N.length]);let k=(0,g.useCallback)(e=>{let t=e.currentTarget;x(t.scrollTop+t.clientHeight>=t.scrollHeight-1)},[]),E=N.length>=h&&!f,C=(0,eN.Y)((e,t,a)=>{d.z.capture({action:"model_search_completed",params:{query:e,results_count:t,arena:null!=a?a:void 0}})},500),_=(0,g.useCallback)(e=>{if(e===r)return;n(e);let t=(null!=e?e:"").trim();if(!t)return;let a=t?i.filter(e=>eI(e.displayName,t)).length:i.length;C(t,a,null!=o?o:null)},[r,n,i,C,o]),B=(0,g.useCallback)(()=>{r&&n("")},[r,n]),T=(0,g.useMemo)(()=>new Set(w),[w]),I=(0,g.useMemo)(()=>new Set(j),[j]),S=u&&"text"===o,R=m&&"text"===o,M=null==s||null==(a=s.capabilities)||null==(t=a.inputCapabilities)?void 0:t.image,D="object"==typeof M&&(null==M?void 0:M.requiresUpload)===!0,O=(0,g.useMemo)(()=>new Set(null!=p?p:[]),[p]),P=o?eA[o]:void 0,z=(0,g.useMemo)(()=>N.map(e=>{var t,a,i,s,r;let n=T.has(e.id),l=I.has(e.id),o=null==(a=e.capabilities)||null==(t=a.inputCapabilities)?void 0:t.image,d="object"==typeof o&&(null==o?void 0:o.requiresUpload)===!0,u=(0,U.j4)(e),m=!n&&null!=c&&d!==c,p=!n&&S&&!(0,U.S1)(e),h=!n&&R&&!(0,U.RS)(e),g=!n&&D&&!u,f=!n&&O.has(e.id),x=null!=(r=null!=(s=P?null==(i=e.rankByModality)?void 0:i[P]:void 0)?s:e.rank)?r:null;return{model:e,isSelected:n,isLocked:l,requiresUpload:d,isDisabled:m||p||h||g,isExcluded:f,displayRank:x}}),[N,T,I,c,S,R,D,O,P]),L=(0,g.useMemo)(()=>{try{if(!y||!Array.isArray(y)||y.some(e=>"string"!=typeof e&&!eB(e)))return[];return y}catch(e){return console.error("Error parsing featured models",e),[]}},[y]),F=(0,g.useMemo)(()=>L.map(e=>eB(e)?e.modelName:e),[L]),G=(0,g.useMemo)(()=>{let e=new Set(F);return(null==L?void 0:L.length)?[...z].filter(t=>!t.isDisabled&&null!=t.model.name&&e.has(t.model.name)).map(e=>{let t=L.find(t=>eB(t)&&t.modelName===e.model.name),a=eB(t)?t.callout:void 0;return{...e,badge:a?e_[a]:void 0}}).sort((e,t)=>{var a,i;return F.indexOf(null!=(a=e.model.name)?a:"")-F.indexOf(null!=(i=t.model.name)?i:"")}):[]},[z,F,L]),H=(0,g.useMemo)(()=>{let e=new Set(F);return[...z].filter(t=>!t.isDisabled&&(null==t.model.name||!e.has(t.model.name))).sort((e,t)=>e.displayRank&&!t.displayRank?-1:!e.displayRank&&t.displayRank?1:e.displayRank&&t.displayRank?e.displayRank-t.displayRank:0)},[z,F]);return{items:z,sortedItems:H,featuredItems:G,visibleArenaOptions:ek,showFade:E,onScroll:k,scrollRef:v,handleSearchValue:_,clearSearch:B}}function eR(e){let{item:t,onSelect:a,showRank:s=!0,badge:r}=e,{model:n,isSelected:l,isLocked:o,isDisabled:c,isExcluded:d}=t,u=c||d;return(0,i.jsx)("button",{type:"button",onClick:()=>{o||(l||!u)&&a(n.id)},className:(0,_.cn)("flex w-full items-center gap-2 px-3 py-3.5 text-left transition-colors",!l&&!u&&"hover:bg-surface-tertiary",l&&"text-interactive-positive",u&&"cursor-not-allowed",c&&!l&&"opacity-20",l&&o&&"cursor-not-allowed"),"aria-disabled":u,children:(0,i.jsx)(eu,{item:t,showRank:s,badge:r})})}function eM(e){let{modelA:t,searchValue:a,setSearchValue:s,models:r,handleSelectModel:n,currentArena:l,onArenaChange:o,anchorRequiresImageUpload:c,selectedArenaOptionId:d,disabledArenaOptionIds:u,hasImageAttachment:m,hasFileAttachment:p,excludeModelIds:h,disabledFlags:g}=e,{sortedItems:f,featuredItems:x,visibleArenaOptions:v,showFade:b,onScroll:y,scrollRef:w,handleSearchValue:j,clearSearch:N}=eS({models:r,modelA:t,searchValue:a,setSearchValue:s,disabledFlags:g,currentArena:l,anchorRequiresImageUpload:c,hasImageAttachment:m,hasFileAttachment:p,excludeModelIds:h});return(0,i.jsxs)("div",{className:"flex h-[500px] flex-col pb-4 pt-6",children:[(0,i.jsxs)("div",{className:"flex-none px-4",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(et.p,{placeholder:"Search models",value:a,onChange:e=>j(e.target.value),className:"rounded-[4px] pr-8"}),a&&(0,i.jsx)(ef,{onClear:N,className:"absolute right-2 top-1/2 -translate-y-1/2"})]}),(0,i.jsx)(em,{visibleArenaOptions:v,selectedArenaOptionId:d,disabledArenaOptionIds:u,onArenaChange:e=>void o(e),className:"overflow-x-auto"})]}),(0,i.jsx)(ea.F,{ref:w,onScroll:y,className:"min-h-0 flex-1",children:(0,i.jsxs)("div",{className:"relative px-4",children:[0===f.length&&0===x.length?(0,i.jsx)(eh,{}):(0,i.jsxs)(i.Fragment,{children:[x.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ep,{children:"New & Featured"}),(0,i.jsx)("div",{children:x.map(e=>e.model.name===z.qP?(0,i.jsx)(en,{model:e.model,isSelected:e.isSelected,onSelect:n,variant:"button"},e.model.id):(0,i.jsx)(eR,{item:e,onSelect:n,showRank:!1,badge:e.badge},e.model.id))})]}),f.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ep,{children:ex(d,v)}),(0,i.jsx)("div",{children:f.map(e=>(0,i.jsx)(eR,{item:e,onSelect:n},e.model.id))})]})]}),(0,i.jsx)(eg,{show:b})]})})]})}var eD=a(21912);let eO=(0,g.forwardRef)((e,t)=>{var a,s;let{model:n,className:o,isOpen:c=!1,isMobile:d=!1,...u}=e;return(0,i.jsxs)(l.Button,{ref:t,type:"button",variant:"outline",size:"sm",className:(0,_.cn)("text-interactive-active hover:bg-surface-tertiary hover:text-interactive-active active:text-interactive-active flex h-[29px] max-w-[180px] items-center justify-between gap-1 rounded-[4px] border-transparent px-2",d&&"min-w-0 max-w-none flex-1",c&&"bg-surface-tertiary",o),...u,children:[(0,i.jsx)(el.D,{className:"size-4 flex-none",organization:null==n?void 0:n.organization}),(0,i.jsx)("span",{className:"flex-1 truncate text-left text-sm font-normal",children:n?null!=(s=null!=(a=n.displayName)?a:n.publicName)?s:n.id:"Select model"}),(0,i.jsx)(r.ChevronDown,{className:(0,_.cn)("text-text-tertiary size-4 flex-none transition-transform duration-200 ease-out",c&&"-rotate-180")})]})});function eP(e){let{setSearchValue:t,model:a,searchValue:r,models:n,handleSelectModel:l,currentArena:o,onArenaChange:c,anchorRequiresImageUpload:u,hasImageAttachment:m,hasFileAttachment:p,selectedArenaOptionId:h,disabledArenaOptionIds:g,excludeModelIds:f,disabledFlags:x,triggerDisabled:v,open:b,setOpen:y}=e,w=(0,N.g)(e=>e.mode),j=(0,N.g)(e=>e.messages.length),{showModalitySwitchModal:k}=Q(),E=w===s.lY.BATTLE,A=j>0;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(eD._s,{open:!v&&null!=b&&b,onOpenChange:e=>{if(!v){if(e)return(d.z.capture({action:"model_settings_menu_clicked",params:{has_model_a:!!a,has_model_b:!1}}),E&&A)?void k("/"):(d.z.capture({action:"model_menu_opened",params:{has_model_a:!!a,has_model_b:!1}}),void y(!0));y(e),t("")}},children:[(0,i.jsx)(eD.Uz,{asChild:!0,children:(0,i.jsx)(eO,{model:a,disabled:v,isOpen:null!=b&&b,isMobile:!0})}),(0,i.jsxs)(eD.zj,{className:"transition-transform duration-200",children:[(0,i.jsx)(eD.BE,{className:"hidden","aria-hidden":!0,children:(0,i.jsx)(eD.gk,{children:"Model Selector"})}),(0,i.jsx)(eM,{modelA:a,searchValue:r,setSearchValue:t,models:n,handleSelectModel:l,currentArena:o,onArenaChange:c,anchorRequiresImageUpload:u,hasImageAttachment:m,hasFileAttachment:p,selectedArenaOptionId:h,disabledArenaOptionIds:g,excludeModelIds:f,disabledFlags:x})]})]})})}function ez(e){var t;let{item:a,onSelect:s,showRank:r=!0,badge:n}=e,{model:l,isSelected:o,isLocked:c,isDisabled:d,isExcluded:u}=a,m=d||u;return(0,i.jsx)(ei.h_,{value:null!=(t=l.displayName)?t:l.publicName,onSelect:()=>{(o||!m)&&(c||s(l.id))},disabled:!o&&m,className:(0,_.cn)("flex cursor-pointer items-center gap-2 rounded-[4px] px-3 py-3.5 transition-colors",!o&&!m&&"hover:bg-surface-tertiary",o&&"text-interactive-positive",m&&"cursor-not-allowed",o&&c&&"cursor-not-allowed"),children:(0,i.jsx)(eu,{item:a,showRank:r,badge:n,isCommandItem:!0})})}function eL(e){let{modelA:t,searchValue:a,setSearchValue:s,models:r,handleSelectModel:n,currentArena:l,onArenaChange:o,anchorRequiresImageUpload:c,selectedArenaOptionId:d,disabledArenaOptionIds:u,hasImageAttachment:m,hasFileAttachment:p,excludeModelIds:h,disabledFlags:g}=e,{sortedItems:f,featuredItems:x,visibleArenaOptions:v,showFade:b,onScroll:y,scrollRef:w,handleSearchValue:j,clearSearch:N}=eS({models:r,modelA:t,searchValue:a,setSearchValue:s,disabledFlags:g,currentArena:l,anchorRequiresImageUpload:c,hasImageAttachment:m,hasFileAttachment:p,excludeModelIds:h});return(0,i.jsxs)("div",{className:"flex h-[400px] flex-col",children:[(0,i.jsxs)("div",{className:"flex-none px-4 pt-4",children:[(0,i.jsxs)("div",{className:"border-border relative rounded-[4px] border [&_[cmdk-input-wrapper]]:border-0",children:[(0,i.jsx)(ei.G7,{placeholder:"Search models",className:"mb-0 border-0",value:a,autoFocus:!0,onValueChange:j}),a&&(0,i.jsx)(ef,{onClear:N,className:"absolute right-3 top-1/2 -translate-y-1/2"})]}),(0,i.jsx)(em,{visibleArenaOptions:v,selectedArenaOptionId:d,disabledArenaOptionIds:u,onArenaChange:o,preventEventPropagation:!0})]}),(0,i.jsx)(ea.F,{ref:w,onScroll:y,className:"min-h-0 flex-1",children:(0,i.jsxs)("div",{className:"relative px-4",children:[(0,i.jsxs)(ei.oI,{className:"max-h-none",children:[(0,i.jsx)(ei.xL,{children:(0,i.jsx)(eh,{})}),x.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ep,{children:"New & Featured"}),(0,i.jsx)(ei.L$,{className:"relative p-0 pb-2",children:x.map(e=>e.model.name===z.qP?(0,i.jsx)(en,{model:e.model,isSelected:e.isSelected,onSelect:n},e.model.id):(0,i.jsx)(ez,{item:e,onSelect:n,showRank:!1,badge:e.badge},e.model.id))})]}),f.length>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ep,{children:ex(d,v)}),(0,i.jsx)(ei.L$,{className:"relative p-0 pb-2",children:f.map(e=>(0,i.jsx)(ez,{item:e,onSelect:n},e.model.id))})]})]}),(0,i.jsx)(eg,{show:b,className:"z-10"})]})})]})}eO.displayName="ModelSelectorTrigger";var eU=a(88870);function eF(e){var t,a;let{setSearchValue:r,model:n,searchValue:l,models:o,handleSelectModel:c,currentArena:u,onArenaChange:m,anchorRequiresImageUpload:p,hasImageAttachment:h,hasFileAttachment:g,selectedArenaOptionId:f,disabledArenaOptionIds:x,excludeModelIds:v,disabledFlags:b,triggerDisabled:y,open:w,setOpen:j}=e,k=(0,N.g)(e=>e.mode),E=(0,N.g)(e=>e.messages.length),{showModalitySwitchModal:A}=Q(),C=k===s.lY.BATTLE,_=E>0;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(eU.AM,{open:!y&&null!=w&&w,onOpenChange:e=>{if(!y){if(e)return(d.z.capture({action:"model_settings_menu_clicked",params:{has_model_a:!!n,has_model_b:!1}}),C&&_)?void A("/"):(d.z.capture({action:"model_menu_opened",params:{has_model_a:!!n,has_model_b:!1}}),void j(!0));j(!1),r("")}},children:[(0,i.jsx)(eU.Wv,{asChild:!0,children:(0,i.jsx)(eO,{model:n,disabled:y,isOpen:null!=w&&w})}),(0,i.jsx)(eU.hl,{className:"data-[state=closed]:zoom-out-100 data-[state=open]:zoom-in-100 data-[side=bottom]:slide-in-from-top-0 data-[side=left]:slide-in-from-right-0 data-[side=right]:slide-in-from-left-0 data-[side=top]:slide-in-from-bottom-0 duration-50 relative w-[500px] origin-[--radix-popover-content-transform-origin] bg-transparent shadow-none",align:"start",sideOffset:4,side:"top",children:(0,i.jsx)(ei.uB,{defaultValue:null!=(a=null!=(t=null==n?void 0:n.displayName)?t:null==n?void 0:n.publicName)?a:"",className:"bg-surface-secondary overflow-hidden rounded-[12px] pb-0 shadow-lg",children:(0,i.jsx)(eL,{modelA:n,searchValue:l,setSearchValue:r,models:o,handleSelectModel:c,currentArena:u,onArenaChange:m,anchorRequiresImageUpload:p,hasImageAttachment:h,hasFileAttachment:g,selectedArenaOptionId:f,disabledArenaOptionIds:x,excludeModelIds:v,disabledFlags:b})})})]})})}function eG(e){var t,a,r;let{allowMultipleModels:n,disabled:l}=e,o=(0,S.d)("md"),c=(0,h.md)(Y.A),{modality:u,mode:m,messages:p,evaluationSessionHasImageAttachment:f,evaluationSessionHasFileAttachment:x}=(0,N.g)((0,k.k)(e=>({modality:e.modality,setMode:e.setMode,mode:e.mode,messages:e.messages,evaluationSessionHasImageAttachment:e.messages.some(e=>{var t;return e.role===s.PG.USER&&(null==(t=e.experimental_attachments)?void 0:t.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("image/")}))}),evaluationSessionHasFileAttachment:e.messages.some(e=>{var t;return e.role===s.PG.USER&&(null==(t=e.experimental_attachments)?void 0:t.some(e=>null!=e.contentType&&z.EC.includes(e.contentType)))})}))),{models:v,modelAId:b,modelBId:y,setModelAId:w,setModelBId:j}=(0,L.g)(e=>e),[E,A]=(0,g.useState)(""),[C,_]=(0,g.useState)(""),[B,T]=(0,g.useState)(null),[I,R]=(0,g.useState)(null),M=null!=n?n:m===s.lY.SIDE_BY_SIDE,D=null!=(r=eC[u])?r:"text",O=c.some(e=>{var t;return null==(t=e.file.type)?void 0:t.startsWith("image/")}),P=c.some(e=>null!=e.file.type&&z.EC.includes(e.file.type)),U=O||f,F=(0,g.useMemo)(()=>{if(!D)return null;switch(D){case"vision":case"image-edit":case"multi-image-edit":return"text-to-image";case"text":case"search":case"text-to-image":case"code":return D;case"image-to-code":return"code";case"document":return"text";default:return null}},[D]),G=(0,g.useMemo)(()=>U?ek.map(e=>e.id).filter(e=>"search"===e):[],[U]),H=(0,g.useMemo)(()=>{let e=((e,t)=>{var a;let i=t&&null!=(a=eE[t])?a:eE.text;return e.filter(e=>null!=e.provider&&null!=e.organization).filter(i)})(null!=v?v:[],D);return m!==s.lY.DIRECT&&m!==s.lY.DIRECT_BATTLE?e.filter(e=>e.name!==z.qP):e},[v,D,m]),V=null!=(t=H.find(e=>e.id===b))?t:null,W=M&&null!=(a=H.find(e=>e.id===y))?a:null,J=p.length>0,q=J&&p.some(e=>"b"===e.participantPosition),Q=!M&&J&&!q,K=(0,g.useMemo)(()=>({isAddDisabled:Q,isRemoveADisabled:!1,isRemoveBDisabled:!1,isModalityLocked:J}),[Q,J]),X=(0,g.useCallback)((e,t)=>{let a="a"===e;M&&(a?y:b)===t||(a?w(t):j(t),d.z.capture({action:"model_selected",params:{model_id:t,slot:e}}),a?T(!1):R(!1))},[b,y,w,j,M]),Z=ee(),$=(0,g.useCallback)(async e=>{var t;e!==D&&Z(null!=(t=eA[e])?t:s.Jg.CHAT)},[Z,D]),et=(0,g.useMemo)(()=>{let e=[{slot:"a",model:V,searchValue:E,setSearchValue:A,excludeModelIds:M&&y?[y]:void 0,open:B,setOpen:T,triggerDisabled:null!=l&&l}];return M&&e.push({slot:"b",model:W,searchValue:C,setSearchValue:_,excludeModelIds:b?[b]:void 0,open:I,setOpen:R,triggerDisabled:Q}),e},[V,W,E,C,M,y,b,B,I,Q,A,_,T,R,l]),ea={models:H,currentArena:D,onArenaChange:$,anchorRequiresImageUpload:null,hasImageAttachment:U,hasFileAttachment:P||x,selectedArenaOptionId:F,disabledArenaOptionIds:G,disabledFlags:K};return o?(0,i.jsx)("div",{className:"flex w-full min-w-0 flex-row items-center justify-center gap-2",children:et.map(e=>{let{slot:t,...a}=e;return(0,i.jsx)(eP,{...ea,...a,handleSelectModel:e=>X(t,e)},"model-selector-drawer-".concat(t))})}):(0,i.jsx)("div",{className:"flex w-full min-w-0 flex-row items-center justify-center gap-2",children:et.map(e=>{let{slot:t,...a}=e;return(0,i.jsx)("div",{className:"min-w-0",children:(0,i.jsx)(eF,{...ea,...a,handleSelectModel:e=>X(t,e)},"model-selector-popover-".concat(t))},"model-selector-popover-".concat(t))})})}function eH(){var e;let{modelAId:t,setModelAId:a,models:r}=(0,L.g)((0,k.k)(e=>({modelAId:e.modelAId,setModelAId:e.setModelAId,models:e.models}))),{mode:n,messages:l,modality:o,lastMessageIds:c}=(0,N.g)((0,k.k)(e=>({mode:e.mode,messages:e.messages,modality:e.modality,lastMessageIds:e.lastMessageIds}))),d=(0,g.useMemo)(()=>{let e=function(e,t,a){let i=e.filter(e=>null!=e.organization&&null!=e.provider).filter(e=>t===s.Jg.IMAGE?(0,U.hK)(e):t===s.Jg.SEARCH?(0,U.cK)(e):t===s.Jg.WEBDEV?(0,U.JQ)(e):t===s.Jg.VIDEO?(0,U.D_)(e):(0,U.oN)(e));return a.some(e=>{var t;return null==(t=e.experimental_attachments)?void 0:t.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("image/")})})&&(t===s.Jg.CHAT||t===s.Jg.WEBDEV||t===s.Jg.AUTO)?i.filter(e=>{let t=(0,U.S1)(e),a=(0,U.HI)(e),i=(0,U.Jo)(e);return t||a||i}):i}(r,o,l),t=["gemini-3-pro-image-preview","claude-opus-4-5"],a=e.sort((e,a)=>{var i,s,r,n;let l=t.some(t=>{var a;return null==(a=e.name)?void 0:a.includes(t)}),c=t.some(e=>{var t;return null==(t=a.name)?void 0:t.includes(e)});if(l&&!c)return -1;if(!l&&c)return 1;let d=null!=(r=null==(i=e.rankByModality)?void 0:i[o])?r:e.rank,u=null!=(n=null==(s=a.rankByModality)?void 0:s[o])?n:a.rank,m=void 0===d||d>1e3,p=void 0===u||u>1e3;return m&&!p?1:!m&&p?-1:void 0!==d&&void 0!==u?d-u:0});if(n!==s.lY.DIRECT&&n!==s.lY.DIRECT_BATTLE)return a.filter(e=>e.name!==z.qP);let i=a.find(e=>e.name===z.qP),c=a.filter(e=>e.name!==z.qP);return i?[i,...c]:c},[r,l,o,n]),u=(0,g.useRef)(n);if((0,g.useEffect)(()=>{if(u.current===n)return;u.current=n;let e=r.find(e=>e.id===t),i=r.find(e=>e.name===z.qP);if(n===s.lY.DIRECT||n===s.lY.DIRECT_BATTLE)i&&a(i.id);else if((null==e?void 0:e.name)===z.qP){let e=d.find(e=>e.name!==z.qP);e&&a(e.id)}},[n,r,t,d,a]),n===s.lY.BATTLE)return null;let m=o===s.Jg.VIDEO,p=(null==(e=l.find(e=>c.includes(e.id)))?void 0:e.pairwiseFeedbackId)!=null,h=m||n===s.lY.DIRECT_BATTLE&&c.length>1&&!p;return(0,i.jsx)(eG,{allowMultipleModels:![s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(n),disabled:h})}var eV=a(25669),eW=a(89041),eY=a(86398);function eJ(){let{showLoginButton:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,N.g)((0,k.k)(e=>({id:e.id,title:e.title,createdAt:e.createdAt,updatedAt:e.updatedAt,mode:e.mode,modality:e.modality,archivedAt:e.archivedAt}))),a=t.mode===s.lY.BATTLE,{toggleSidebar:o}=(0,E.cL)(),c=C(),d="treatment"===(0,A._P)("archive-chat-enabled"),u=(0,w.a8)(),m=u.startsWith("/c/")&&"/c"!==u,[p,h,g]=(0,B.L)((0,k.k)(e=>[(0,T.JO)(e),(0,T.Wy)(e,!0),(0,T.Iv)(e)])),f=p+h>0;return(0,i.jsxs)("div",{className:"bg-surface-primary border-border-faint flex-shrink-0 border-b",children:[(0,i.jsx)("div",{className:"flex flex-col md:hidden",children:(0,i.jsxs)("div",{className:(0,_.cn)("grid min-h-14 w-full flex-none grid-cols-[1fr_auto_1fr] items-center gap-2 px-3 py-2.5",{"py-1":a}),children:[(0,i.jsx)("div",{className:"flex justify-start",children:c?(0,i.jsx)("div",{className:(0,_.cn)("rounded-md",{"bg-surface-tertiary":f}),children:(0,i.jsxs)(l.Button,{variant:"textLink",onClick:o,className:"touch-hitbox px-2",children:[(0,i.jsx)(r.PanelRightClose,{size:18}),f&&(0,i.jsx)(eY.s,{unreadCount:p,inProgressCount:h,status:g>0?"error":"success"})]})}):(0,i.jsx)(l.Button,{variant:"textLink",size:"icon",onClick:o,className:"touch-hitbox",children:(0,i.jsx)(r.PanelRightClose,{size:18})})}),(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)(D,{})}),(0,i.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[d&&m&&(0,i.jsx)(eW.E,{session:t,triggerClassName:"touch-hitbox flex h-10 w-10 items-center justify-center rounded-md text-text-tertiary hover:text-text-secondary hover:bg-surface-tertiary"}),(0,i.jsx)(l.Button,{variant:"textLink",size:"icon",asChild:!0,className:"touch-hitbox",children:(0,i.jsx)(n.Link,{href:"/",disableLinkColor:!0,children:(0,i.jsx)(r.SquarePen,{size:18})})})]}),!a&&(0,i.jsx)("div",{className:"border-border-faint col-span-3 flex w-full border-t pt-2",children:(0,i.jsx)(eH,{})})]})}),(0,i.jsxs)("div",{className:"hidden min-h-12 items-center justify-between gap-2 px-4 py-2 md:flex",children:[(0,i.jsxs)("div",{className:"flex min-w-0 flex-wrap items-center justify-start gap-2",children:[(0,i.jsx)(D,{}),(0,i.jsx)("div",{className:"min-w-0 grow *:justify-start",children:(0,i.jsx)(eH,{})})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[d&&m&&(0,i.jsx)(eW.E,{session:t,triggerClassName:"touch-hitbox flex h-10 w-10 items-center justify-center rounded-md text-text-tertiary hover:text-text-secondary hover:bg-surface-tertiary"}),e&&(0,i.jsx)(eq,{})]})]})]})}function eq(){let e=(0,m.kH)(m.Q_),{setLocation:t}=(0,eV.G)();return e?(0,i.jsx)(l.Button,{variant:"tertiary",size:"md",onClick:()=>t("top-right"),children:"Login"}):(0,i.jsx)("div",{})}let eQ="chat-area",eK="100px",eX=new Date("2025-09-05T00:00:00.000Z");var eZ=a(69460);let e$=(0,a(48364).A)(e=>t=>{e.current.scrollTop=t}),e0=g.useLayoutEffect;var e1=a(46373),e2=a(83993),e4=a(13375);async function e5(e,t){let{signal:a,onTextChunk:i,onImageChunk:r,onSourceChunk:n,onVideoChunk:l,onWebDevChunk:o,onReasoningChunk:c,onToolCallChunk:d,onToolResultChunk:u,onRoutedModelChunk:m,onFinish:p,onError:h}=t,g=new TextDecoder("utf-8"),f="",x=new Map;for(;;){var v,b,y,w,j;if(null==a?void 0:a.aborted)break;let{done:t,value:N}=await e.read();if(t)break;let k=(f+=g.decode(N)).split("\n");for(let e=0;e<k.length-1;e++){let t=k[e];if(null==t)continue;let[a,g]=0===t.length?["",""]:[t.charAt(0),t.slice(1)];if(null==g?void 0:g.includes(s.qe)){h(a);continue}let{type:f,value:j}=(0,e4.D9)(g);if("error"===f){h(a,"string"==typeof j?j:void 0);continue}if("finish_message"===f&&(null==j?void 0:j.finishReason)==="error"){h(a);continue}if("finish_message"===f){p(a);continue}if("tool_call_delta"===f&&"citation-source"===j.toolCallId)try{let e=JSON.parse(j.argsTextDelta).source;e&&n(a,e)}catch(e){}if("text"===f&&i(a,j),"reasoning"===f&&c&&c(a,j),"tool_call"===f&&(null==d||d(a,j),x.set(j.toolCallId,j)),"tool_result"===f){let e=x.get(j.toolCallId);e?(null==u||u(a,j,e),x.delete(j.toolCallId)):console.error("Matching tool_call not found for tool_result: ".concat(j.toolCallId))}if("data"===f){if(j.length>0&&(null==(v=j[0])?void 0:v.type)==="image"){let e=j[0];e.data&&!e.image&&(e.image="data:".concat(e.mimeType||"image/png",";base64,").concat(e.data)),r(a,e)}if(j.length>0&&(null==(b=j[0])?void 0:b.type)==="video"&&l(a,j[0]),j.length>0&&(null==(y=j[0])?void 0:y.type)==="webdev"){let e=e2.WebDevPartSchema.safeParse(j[0]);e.success?o(a,e.data.event):console.error("Invalid webdev part",e.error)}j.length>0&&(null==(w=j[0])?void 0:w.type)==="routed_model"&&m&&m(a,j[0])}"file"===f&&j.mimeType.startsWith("image")&&r(a,{type:"image",mimeType:j.mimeType,image:"data:".concat(j.mimeType||"image/png",";base64,").concat(j.data)})}f=null!=(j=k[k.length-1])?j:""}}var e3=a(41565),e6=a(91256),e9=a(96589),e8=a(3619),e7=a(39983);let te={desktop:"100%",tablet:768,mobile:375};function tt(){return{selectedMode:(0,p.eU)("a"),selectedView:(0,p.eU)({mode:"preview"}),activeUserMessage:(0,p.eU)(null),mobileDrawerOpen:(0,p.eU)(!1),iframeRefreshVersion:(0,p.eU)(0),iframePath:(0,p.eU)("/"),viewport:(0,p.eU)("desktop"),pinnedTabs:(0,p.eU)(null),previewTab:(0,p.eU)(null)}}let ta=(0,g.createContext)(tt());function ti(e){let{children:t}=e,[a]=(0,g.useState)(()=>tt());return(0,i.jsx)(ta,{value:a,children:t})}function ts(){let e=(0,g.useContext)(ta);if(!e)throw Error("useWebDevAtoms must be used within a WebDevStateProvider");return e}function tr(){let e=(0,m.kH)(e=>{var t;return null==(t=e.user)?void 0:t.id}),[t,a]=(0,N.g)((0,k.k)(e=>[e.id,e.mode])),i=tl(),[s,r]=(0,h.fp)(ts().selectedMode);return[s,(0,g.useCallback)((s,n,l)=>{r(r=>(l&&i(l),s!==r&&d.z.capture({action:"webdev_model_selected",params:{selected_model:s,previous_model:r,source:n,user_id:e,evaluation_id:t,mode:a}}),s))},[t,a,r,e,i])]}function tn(){let e=(0,m.kH)(e=>{var t;return null==(t=e.user)?void 0:t.id}),[t,a]=(0,N.g)((0,k.k)(e=>[e.id,e.mode])),[i,s]=(0,h.fp)(ts().selectedView);return[i,(0,g.useCallback)((i,r)=>{s(s=>(i.mode!==s.mode&&r&&d.z.capture({action:"webdev_view_selected",params:{selected_view:i.mode,previous_view:s.mode,source:r,user_id:e,evaluation_id:t,mode:a}}),i))},[t,a,s,e])]}function tl(){return(0,h.Xr)(ts().activeUserMessage)}function to(e){let t=(0,h.md)(ts().activeUserMessage),a=(0,N.g)(e=>e.messages),i=(0,N.g)(e=>e.lastMessageIds),s=a.find(a=>a.participantPosition===e&&(t?a.parentMessageIds.includes(t):i.includes(a.id)));return null!=s?s:null}function tc(){return(0,h.fp)(ts().mobileDrawerOpen)}function td(){return(0,h.fp)(ts().iframeRefreshVersion)}function tu(){return(0,h.fp)(ts().iframePath)}function tm(){let e=(0,m.kH)(e=>{var t;return null==(t=e.user)?void 0:t.id}),[t,a]=(0,N.g)((0,k.k)(e=>[e.id,e.mode])),[i,s]=(0,h.fp)(ts().viewport);return[i,(0,g.useCallback)(i=>{s(s=>(i!==s&&d.z.capture({action:"webdev_viewport_changed",params:{selected_viewport:i,previous_viewport:s,user_id:e,evaluation_id:t,mode:a}}),i))},[t,a,s,e])]}function tp(e){let t=ts(),[a,i]=(0,h.fp)(t.pinnedTabs),[s,r]=(0,h.fp)(t.previewTab),n=(0,g.useMemo)(()=>null!=a?a:(null==e?void 0:e.defaultFile)&&!s?[e.defaultFile]:[],[a,null==e?void 0:e.defaultFile,s]);null===a&&i(n);let l=(0,g.useCallback)(e=>{if(n.includes(e))return void r(null);r(e)},[n,r]),o=(0,g.useCallback)(e=>{i(t=>{let a=null!=t?t:[];return a.includes(e)?a:[...a,e]}),s===e&&r(null)},[s,i,r]),c=(0,g.useCallback)(e=>{s===e?r(null):i(t=>(null!=t?t:[]).filter(t=>t!==e))},[s,i,r]),d=(0,g.useCallback)((e,t)=>{i(a=>{let i=[...null!=a?a:[]];i.includes(e)||i.push(e),i.includes(t)||i.push(t);let s=i.indexOf(e),r=i.indexOf(t);if(-1!==s&&-1!==r&&s!==r){let[e]=i.splice(s,1);e&&i.splice(r,0,e)}return i}),(s===e||s===t)&&r(null)},[s,i,r]);return{pinnedTabs:n,previewTab:s,previewFile:l,pinTab:o,closeTab:c,moveTab:d}}var th=a(2088),tg=a(5849),tf=a(47009),tx=a(33725),tv=a(66818),tb=a(43161),ty=a(39695);let tw=e=>(0,ty.j)({queryKey:["webdev","metadata",e],queryFn:async()=>tj(e)});async function tj(e){let t=await u.F.evaluation.webdev[":messageId"].$get({param:{messageId:e}});if(!t.ok){let e=await t.text();throw Error("Failed to fetch webdev metadata (".concat(t.status,"): ").concat(e))}let{manifest:a,previewUrl:i}=e1.Un.parse(await t.json());var s=a,r=i;switch(s.buildResult.status){case"success":return{status:"success",files:s.files,previewUrl:r};case"error":return{status:"build-error",files:s.files,message:s.buildResult.message}}}function tN(){let e=(0,tb.useQueryClient)();return async t=>{await e.invalidateQueries(tw(t))}}function tk(){let e=(0,tb.useQueryClient)();return(0,g.useCallback)(async(t,a)=>{e.setQueryData(tw(t).queryKey,{status:"pending",files:a})},[e])}function tE(){let e=(0,tb.useQueryClient)();return(0,g.useCallback)((t,a)=>{e.setQueryData(tw(t).queryKey,e=>{var t,i,s;if((null==(t=a.result)?void 0:t.status)==="error")return e;switch(a.toolName){case"create_file":return{status:"pending",files:[...null!=(i=null==e?void 0:e.files)?i:[],{path:a.args.path,content:a.args.content,contentType:(0,tv.N)(a.args.path)}]};case"edit_file":return{status:"pending",files:(null!=(s=null==e?void 0:e.files)?s:[]).map(e=>{if(e.path===a.args.path)try{return{...e,content:(0,tx.f)(e.content,a.args.context,a.args.replacement).content}}catch(e){console.error("Failed to edit file ".concat(a.args.path,": ").concat(e))}return e})};case"read_file":case"list_files":case"delete_file":case"install_npm_packages":case"build_project":case"deploy_project":case"apply_patch":case"shell_command":case"update_plan":return e}})},[e])}var tA=a(81861);let tC=(0,tA.Mz)([e=>e.messages,e=>e.lastMessageIds],(e,t)=>{let a=null,i=null;for(let n of t){var s,r;let t=e.find(e=>e.id===n);(null==t?void 0:t.participantPosition)===th.BQ.a&&(a=null!=(s=null==t?void 0:t.modelId)?s:null),(null==t?void 0:t.participantPosition)===th.BQ.b&&(i=null!=(r=null==t?void 0:t.modelId)?r:null)}return{modelAId:a,modelBId:i}});function t_(e){return e&&0!==e.length?e.startsWith("video")?"video":e.startsWith("image")?"image":e.startsWith("application/pdf")?"pdf":"file":"file"}function tB(e){let t=null==e?void 0:e.thumbnailUrl;if(!t||"string"!=typeof t)return;let a=t.trim();return a.length>0?a:void 0}function tT(e){if(!e||0===e.length)return;let t=e.map(e=>t_(e.contentType));return t.length>0?t:void 0}function tI(e){if(!e||0===e.length)return;let t=e.filter(e=>"application/pdf"===e.contentType).length;return t>0?{pdf:t}:void 0}var tS=a(43238),tR=a.n(tS),tM=a(98805);let tD={IMAGE:.8,VIDEO:.95,SEARCH:.8,CODE:.8},tO={CONSERVATIVE:.6,AGGRESSIVE:.8},tP={video:s.Jg.VIDEO,image:s.Jg.IMAGE,search:s.Jg.SEARCH,code:s.Jg.WEBDEV,text:s.Jg.CHAT},tz={modality:s.Jg.CHAT,shouldShowModalitySuggestion:!1,suggestedModalities:[],confidence:{image:0,search:0,text:0,video:0,code:0},disabledModalities:[],latencyMs:0,thresholds:tD};async function tL(e,t){let a=await fetch("/nextjs-api/auto-modality",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_prompt:e,has_image:t})});if(!a.ok)throw Error("Auto-modality API failed: ".concat(a.status));return a.json()}async function tU(e,t,a){let i=performance.now(),r=function(e){let t=[];return e&&t.push(s.Jg.SEARCH),t}(t),n=await tL(e,t),l=function(e,t){if(0===t.length)return e;let a=new Set;for(let e of t){let t=Object.keys(tP).find(t=>tP[t]===e);t&&a.add(t)}let i=0,s={...e};for(let e of Object.keys(s))a.has(e)?s[e]=0:i+=s[e];if(i>0)for(let e of Object.keys(s))a.has(e)||(s[e]=s[e]/i);else s.text=1,s.image=0,s.search=0,s.video=0,s.code=0;return s}(n.probabilities,r),o=function(e){var t;let a="text",i=e.text;for(let[t,s]of Object.entries(e))s>i&&(i=s,a=t);return null!=(t=tP[a])?t:s.Jg.CHAT}(l),c=function(e,t){var a,i;let s=Object.entries(e).sort((e,t)=>t[1]-e[1]),r=[],n=null!=(i=null==(a=s[0])?void 0:a[1])?i:0;for(let e=1;e<s.length&&n<t;e++){let t=s[e];if(!t)continue;let[a,i]=t,l=tP[a];l&&(r.push(l),n+=i)}return r}(l,"treatment-3"===a||"treatment-4"===a?tO.AGGRESSIVE:tO.CONSERVATIVE),d=c.length>0,u=Math.round(performance.now()-i);return{modality:o,shouldShowModalitySuggestion:d,suggestedModalities:c,confidence:n.probabilities,disabledModalities:r,latencyMs:u,thresholds:tD}}async function tF(e,t,a){try{return{...await tU(e,t,a),wasAutoSelected:!0,treatmentVariant:a}}catch(e){return{...tz,wasAutoSelected:!1,treatmentVariant:a}}}var tG=a(98415);function tH(){let e=(0,g.useContext)(N.P),t=(0,g.useContext)(L.Y),a=(0,g.useContext)(m.wm),i=(0,g.useContext)(B.c),{setLocation:r}=(0,eV.G)(),{addHistory:n,updateHistory:l,invalidateHistory:o}=(0,tf.m)(),{getRecaptchaV2Token:c}=(0,tG.eN)(),u=C(),p=(0,A._P)("auto-modality-enabled"),h=(0,A._P)("battles-in-direct-2"),x=(0,A._P)("recaptcha-force-low-bot-score"),v=tk(),b=tE(),y=tN(),w=tl();return{appendMultiStream:(0,g.useCallback)(async m=>{var g,j,N,k,E,A,C,_,B,T,I,S,R;let M,D,O,P,L,U,F=performance.now();if(null==e)throw Error("Evaluation session store is not available");if(null==t)throw Error("Model store is not available");if(null==a)throw Error("User store is not available");if(null==i)throw Error("Evaluation session notification store is not available");let G=e.getState(),W=i.getState(),{userCreationPromise:Y,user:J,setImageModalityRateLimitedUntil:q,setVideoModalityRateLimitedUntil:Q,userId:K}=a.getState(),X=t.getState(),Z=G.mode===s.lY.BATTLE?null:null!=(k=X.modelAId)?k:null,$=G.mode===s.lY.SIDE_BY_SIDE&&null!=(E=X.modelBId)?E:null,ee=X.updateModel,et=X.models,ea=G.mode,ei=G.modality,es=ea===s.lY.BATTLE,er=ea===s.lY.DIRECT,en=ea===s.lY.DIRECT_BATTLE,el=ea===s.lY.SIDE_BY_SIDE,eo=G.messages[G.messages.length-1],ec=0===G.messages.length,ed=!1,eu=!1,em=[],ep=e.getState().startNewStream();try{let t,a;null!=eo&&[s.nH.FAILED,s.nH.FLAGGED].includes(eo.status)&&G.deleteMessage(eo.id),M=(0,e8.generateSafeUUIDv7)();let i=e.getState().lastMessageIds,l=function(e,t,a,i,s,r){if(!s||0===s.length)return[];let n=H(e,t,a,i,r),l=V(e,t,a,i,r);return s.filter(e=>{let t=e.contentType;return!t||(t.startsWith("image/")?n:!z.EC.includes(t)||l)})}(ea,Z,$,et,m.experimental_attachments,ei);G.messages.reduce((e,t)=>{var a,i;return e+(null!=(i=null==(a=t.experimental_attachments)?void 0:a.length)?i:0)},0)+l.length>40&&f.oR.warning("Total file sizes exceeds limitation",{description:"Large uploads may cause issues, try starting a new chat"}),D={id:M,role:s.PG.USER,content:m.content,experimental_attachments:l,parentMessageIds:null!=i?i:[],participantPosition:th.BQ.a,modelId:null,evaluationSessionId:G.id,status:s.nH.PENDING,failureReason:null},G.addMessages([D]),ei===s.Jg.WEBDEV&&w(D.id);let g=((e,t)=>{let a=e.mode,i=(0,tg.KL)(t);if(a!==s.lY.DIRECT_BATTLE||!i)return!1;let r=[...e.messages.slice(-2)].filter(e=>e.role===s.PG.ASSISTANT),n=(0,e3.ff)(r),l=e.pairwiseFeedbacks.at(-1),o=n===s.lY.BATTLE&&(!l||l&&r.every(e=>e.id!==l.messageAId)&&r.every(e=>e.id!==l.messageBId));if(n===s.lY.BATTLE&&o)return!0;if(n!==s.lY.DIRECT)return!1;let c=e.messages.filter(e=>e.role===s.PG.USER),u=c.filter(e=>e.status!==s.nH.FAILED&&e.status!==s.nH.FLAGGED),m=u.length+1,p=(0,e3.yR)({seed:e.id,battlesInDirectTreatment:t,n:m,previousTurnMode:n});return"battle"===p&&d.z.capture({action:"direct_battle_fe_calculation",params:{evaluation_session_id:e.id,nextTurn:p,n:m,n_all_users:c.length+1,previousTurnMode:null!=n?n:null,battlesInDirectTreatment:null!=t?t:"unknown",previousTurnAssistantMessageIds:r.map(e=>e.id),previousTurnAssistantMessageCount:r.length,lastMessageIds:e.lastMessageIds,totalMessages:e.messages.length,failedUserMessageCount:c.length-u.length}}),"battle"===p})(G,h),v={id:O=(0,e8.generateSafeUUIDv7)(),role:s.PG.ASSISTANT,content:"",reasoning:"",experimental_attachments:[],parentMessageIds:[D.id],participantPosition:th.BQ.a,modelId:g?null:Z,evaluationSessionId:G.id,status:s.nH.PENDING,failureReason:null};if(em.push(v),(er||en)&&!g||(t={id:P=(0,e8.generateSafeUUIDv7)(),role:s.PG.ASSISTANT,content:"",reasoning:"",experimental_attachments:[],parentMessageIds:[D.id],participantPosition:th.BQ.b,modelId:g?null:$,evaluationSessionId:G.id,status:s.nH.PENDING,failureReason:null},em.push(t)),G.addMessages(em),G.setHasViewedLatestResponses(!1),ei===s.Jg.AUTO&&ec&&es){G.setIsPredictingModality(!0);let e=tJ(D);ei=(a=await tF(e,(null!=(C=null==(A=m.experimental_attachments)?void 0:A.length)?C:0)>0,p)).modality,G.setModality(a.modality),G.setAutoModalityMetadata(a),G.setIsPredictingModality(!1),d.z.capture({action:"auto_modality_router_called",params:{suggested_modality:a.modality,evaluation_session_id:G.id}})}null!=Y&&await Y;let b=null;try{b=await (0,tG.ic)("chat_submit")}catch(e){}null!=b&&""!==b&&d.z.capture({action:"chat_submit_user_with_recaptcha_token",params:{is_first_message:ec,mode:G.mode,user_id:K,modality:ei,evaluation_session_id:G.id,model_a_id:Z,model_b_id:$,has_attachments:(null!=(T=null==m||null==(_=m.experimental_attachments)?void 0:_.length)?T:0)>0,attachments_count:null!=(I=null==m||null==(B=m.experimental_attachments)?void 0:B.length)?I:0,attachment_type:tT(null==m?void 0:m.experimental_attachments),file_count:tI(null==m?void 0:m.experimental_attachments),input_length:m.content.length,has_edited_images:!1}});let y=e1.Gb.safeParse(m.content);if(!y.success)return void console.error("Invalid content:",y.error);let j={id:G.id,mode:ea,modelAId:es?void 0:null!=Z?Z:void 0,modelBId:el&&null!=$?$:void 0,userMessageId:M,modelAMessageId:O,modelBMessageId:P,userMessage:{content:y.data,experimental_attachments:l,metadata:{...m.metadata,...a&&{autoModalityMetadata:a}}},modality:ei,recaptchaV3Token:b,forceLowRecaptchaScore:!0===x||void 0},N=0===G.messages.length||1===G.messages.length&&G.messages[0]&&[s.nH.FAILED].includes(G.messages[0].status);try{if(N){let t=ei===s.Jg.WEBDEV?"New Chat":tJ(D).substring(0,100);n({id:G.id,createdAt:G.createdAt,updatedAt:G.updatedAt,mode:ea,modality:ei,modelAId:Z,modelBId:$,title:t,archivedAt:null}),null==e||e.setState(e=>({...e,title:t})),u&&W.addNotification({evaluationSessionId:G.id,modality:G.modality,mode:G.mode,modelAId:Z,modelBId:$,userPrompt:t}),L=e=>fetch("/nextjs-api/stream/create-evaluation",{method:"POST",body:JSON.stringify({...j,...e?{recaptchaV2Token:e,recaptchaV3Token:void 0}:{}})})}else u&&W.addNotification({evaluationSessionId:G.id,modality:G.modality,mode:G.mode,modelAId:Z,modelBId:$,userPrompt:G.title}),L=e=>fetch("/nextjs-api/stream/post-to-evaluation/".concat(G.id),{method:"POST",body:JSON.stringify({...j,...e?{recaptchaV2Token:e,recaptchaV3Token:void 0}:{},mode:void 0})});if(!(U=await L()).ok){let{error:e}=await t$(U);if(e&&[e9.EV,e9.aq].includes(e)){let t=await c();if(!(U=await L(t)).ok){let{error:t}=await t$(U);t===e9.EV&&(null==J?void 0:J.emailProvider)==null&&e===e9.EV&&r("low-recaptcha-score-modal")}}}}catch(t){let e=t instanceof Error?t:Error(String(t));d.z.captureException(e,{error_name:"chat_submit_request_failed",params:{mode:G.mode,modality:ei,evaluation_session_id:G.id,model_a_id:Z,model_b_id:$}}),console.error("Error creating evaluation session:",t),U=void 0}if(N&&o(),null==U||!U.ok){if(G.deleteMessage(O),null!=P&&G.deleteMessage(P),(null==U?void 0:U.status)===e6.TOO_MANY_REQUESTS){let e=tK(U.headers),t=tX(U.headers);if(null!=e)r("image-modality-rate-limit-modal"),q(e);else if(null!=t)Q(t),d.z.capture({action:"modality_rate_limit_hit",params:{user_id:K,modality:ei,mode:G.mode,evaluation_session_id:G.id,context:"chat_submit"}});else{let e=await (null==U?void 0:U.clone().json()),t=null==e?void 0:e.modelId,a=t0(U.headers);if(null!=t&&null!=a){let e=new Date(new Date().getTime()+a);ee({id:t,rateLimitedUntil:e.toISOString()})}}}let e=null;if(null!=U){let{error:t}=await t$(U);t===e9.tZ&&(e=e9.tZ)}G.updateMessage({id:D.id,status:(null==U?void 0:U.status)===e6.UNPROCESSABLE_ENTITY?s.nH.FLAGGED:s.nH.FAILED,failureReason:e}),u&&W.updateStatus(G.id,"error");return}}catch(t){console.error("Error creating evaluation session:",t);let e=t instanceof Error?t:Error(String(t));throw d.z.captureException(e,{error_name:"chat_submit_error",params:{mode:G.mode,modality:ei,evaluation_session_id:G.id,model_a_id:Z,model_b_id:$}}),t}d.z.capture({action:"chat_submit_success",params:{is_first_message:ec,mode:G.mode,user_id:K,modality:ei,evaluation_session_id:G.id,model_a_id:Z,model_b_id:$,has_attachments:(null!=(S=null==m||null==(g=m.experimental_attachments)?void 0:g.length)?S:0)>0,attachments_count:null!=(R=null==m||null==(j=m.experimental_attachments)?void 0:j.length)?R:0,attachment_type:tT(null==m?void 0:m.experimental_attachments),file_count:tI(null==m?void 0:m.experimental_attachments),input_length:m.content.length,n_attempts:1}});let eh=null==(N=U.body)?void 0:N.getReader();if(!eh){u&&W.updateStatus(G.id,"error");return}G.setCanResampleMessages(!0);let eg=!1,ef=!1;return e5(eh,{signal:ep.signal,onTextChunk:(e,t)=>{let a=em[0],i=em[1];if("a"===e&&null!=a&&!eg||"b"===e&&null!=i&&!ef){var r,n;"a"===e?eg=!0:ef=!0;let t=Number((performance.now()-F).toFixed(0));d.z.capture({action:"first_content_token_received",params:{time_to_first_content_token_ms:t,model_id:e===th.BQ.a?null!=(r=null==a?void 0:a.modelId)?r:null:null!=(n=null==i?void 0:i.modelId)?n:null,modality:ei,evaluation_session_id:G.id,message_id:"b"===e&&null!=P?P:O}})}let l=e=>{if(ei===s.Jg.WEBDEV){if("string"==typeof e.content){let t=e.content;e.content=t?[{type:"text",text:t}]:[]}if(Array.isArray(e.content)){let a=e.content[e.content.length-1];a&&"text"===a.type?a.text+=t:e.content.push({type:"text",text:t})}}else e.content+=t};e===th.BQ.a&&null!=a?(l(a),G.updateMessage({id:a.id,content:a.content,reasoning:a.reasoning})):e===th.BQ.b&&null!=i&&(l(i),G.updateMessage({id:i.id,content:i.content,reasoning:i.reasoning}))},onReasoningChunk:(e,t)=>{let a=em[0],i=em[1];e===th.BQ.a&&null!=a?(null!=a.reasoning||(a.reasoning=""),a.reasoning+=t,G.updateMessage({id:a.id,reasoning:a.reasoning,content:a.content})):e===th.BQ.b&&null!=i&&(null!=i.reasoning||(i.reasoning=""),i.reasoning+=t,G.updateMessage({id:i.id,reasoning:i.reasoning,content:i.content}))},onSourceChunk:(e,t)=>{var a,i;let s=em[0],r=em[1];if(e===th.BQ.a&&null!=s){let e=Array.isArray(t)?t:tq(null!=(a=s.sources)?a:[],t);s.sources=e,G.updateMessage({id:s.id,sources:e})}else if(e===th.BQ.b&&null!=r){let e=Array.isArray(t)?t:tq(null!=(i=r.sources)?i:[],t);r.sources=e,G.updateMessage({id:r.id,sources:e})}},onImageChunk:(e,t)=>{var a,i,s,r;let n=em[0],l=em[1];if(e===th.BQ.a&&null!=n){let e={url:t.image,contentType:null!=(a=t.mimeType)?a:"image/png"};n.experimental_attachments=[...null!=(i=n.experimental_attachments)?i:[],e],G.updateMessage({id:n.id,experimental_attachments:n.experimental_attachments})}else if(e===th.BQ.b&&null!=l){let e={url:t.image,contentType:null!=(s=t.mimeType)?s:"image/png"};l.experimental_attachments=[...null!=(r=l.experimental_attachments)?r:[],e],G.updateMessage({id:l.id,experimental_attachments:l.experimental_attachments})}},onVideoChunk:(e,t)=>{let a=tV(e,em);if(a){var i,s;let e={url:t.url,contentType:null!=(i=t.mimeType)?i:"video/mp4",thumbnailUrl:t.thumbnailUrl};a.experimental_attachments=[...null!=(s=a.experimental_attachments)?s:[],e],G.updateMessage({id:a.id,experimental_attachments:a.experimental_attachments})}},onWebDevChunk:(t,a)=>{let i=tV(t,em);if(i)switch(a.type){case"init":v(i.id,a.files);break;case"title":null==e||e.setState(e=>({...e,title:a.title})),l({id:G.id,title:a.title})}},onRoutedModelChunk:(e,t)=>{var a;let i=tV(e,em);i&&G.updateMessage({id:i.id,metadata:{...null!=(a=i.metadata)?a:{},routedModelOrganization:t.organization}})},onToolCallChunk:(e,t)=>{let a=tV(e,em);if(!a)return;a.content=tW(a.content);let i=a.content.findIndex(e=>"tool-call"===e.type&&e.toolCallId===t.toolCallId);-1!==i?a.content[i]={...t,type:"tool-call"}:a.content.push({...t,type:"tool-call"}),G.updateMessage({id:a.id,content:a.content})},onToolResultChunk:(e,t,a)=>{let i=tV(e,em);if(!i)return;let s=e7.VM.safeParse({toolCallId:a.toolCallId,toolName:a.toolName,args:a.args,result:t.result});s.success&&b(i.id,s.data),i.content=tW(i.content);let r=i.content.find(e=>"tool-call"===e.type&&e.toolCallId===t.toolCallId);r&&i.content.push({...t,type:"tool-result",toolName:r.toolName}),G.updateMessage({id:i.id,content:i.content})},onFinish:e=>{var t,a,i,r;let n=e===th.BQ.a?O:P,l=em.find(e=>e.id===n);e===th.BQ.a?ed=!0:eu=!0;let o=[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(G.mode)||(e===th.BQ.b?ed:eu);G.updateMessage({id:n,status:s.nH.SUCCESS}),d.z.capture({action:"chat_response_success",params:{response_type:"submit",mode:G.mode,user_id:K,modality:ei,evaluation_session_id:G.id,model_id:null==l?void 0:l.modelId,has_attachments:(null!=(r=null==l||null==(t=l.experimental_attachments)?void 0:t.length)?r:0)>0,attachments_count:null==l||null==(a=l.experimental_attachments)?void 0:a.length,attachment_type:tT(null==l?void 0:l.experimental_attachments),file_count:tI(null==l?void 0:l.experimental_attachments),response_length:null==l||null==(i=l.content)?void 0:i.length}}),o&&(d.z.capture({action:"chat_responses_success",params:{response_type:"submit",mode:G.mode,user_id:K,modality:ei}}),u&&W.updateStatus(G.id,"success")),ei===s.Jg.WEBDEV&&n&&y(n)},onError:(e,t)=>{G.updateMessage({id:e===th.BQ.a?O:P,status:s.nH.FAILED,failureReason:null!=t?t:null}),u&&W.updateStatus(G.id,"error")}})},[n,p,e,x,c,b,v,o,y,t,w,r,l,a,i,u,h])}}function tV(e,t){let[a,i]=t;return e===th.BQ.a&&null!=a?a:e===th.BQ.b&&null!=i?i:null}function tW(e){return"string"==typeof e?e.length>0?[{type:"text",text:e}]:[]:e}function tY(){let e=(0,g.useContext)(N.P),t=(0,g.useContext)(L.Y),a=(0,g.useContext)(m.wm),i=(0,g.useContext)(B.c),{setLocation:r}=(0,eV.G)(),{getRecaptchaV2Token:n}=(0,tG.eN)(),[,l]=td(),o=C(),c=(0,A._P)("recaptcha-force-low-bot-score"),u=tk(),p=tE(),h=tN(),x=function(){let e=(0,tb.useQueryClient)();return(0,g.useCallback)(t=>{e.removeQueries(tw(t))},[e])}();return{appendStream:(0,g.useCallback)(async m=>{var g;let v;if(null==e)throw Error("Evaluation session store is not available");if(null==t)throw Error("Model store is not available");if(null==a)throw Error("User store is not available");if(null==i)throw Error("Evaluation session notification store is not available");let b=e.getState(),y=i.getState(),{setImageModalityRateLimitedUntil:w,setVideoModalityRateLimitedUntil:j,userId:N,user:k}=a.getState(),{updateModel:E}=t.getState(),{modelAId:A,modelBId:C}=tC(b),_=b.messages.find(e=>e.id===m);if(null==_)throw Error("Model message not found");b.updateMessage({id:_.id,content:[],reasoning:"",experimental_attachments:[],sources:[],status:s.nH.PENDING}),o&&y.addNotification({evaluationSessionId:b.id,modality:b.modality,mode:b.mode,modelAId:A,modelBId:C,userPrompt:b.title}),b.modality===s.Jg.WEBDEV&&(x(m),l(e=>e+1)),b.modality===s.Jg.VIDEO&&b.removeViewedVideo(m),d.z.capture({action:"chat_retry",params:{mode:b.mode,user_id:N,modality:b.modality,evaluation_session_id:b.id,message_status:_.status}});let B=null;try{B=await (0,tG.ic)("chat_retry")}catch(e){}let T=e=>fetch("/nextjs-api/stream/retry-evaluation-session-message/".concat(b.id,"/messages/").concat(m),{method:"PUT",body:JSON.stringify({recaptchaV3Token:B,...e?{recaptchaV2Token:e,recaptchaV3Token:void 0}:{},forceLowRecaptchaScore:!0===c||void 0})});if(!(v=await T()).ok){let{error:e}=await t$(v);if(e&&[e9.EV,e9.aq].includes(e)){let t=await n();if(!(v=await T(t)).ok){let{error:t}=await t$(v);t===e9.EV&&(null==k?void 0:k.emailProvider)==null&&e===e9.EV&&r("low-recaptcha-score-modal")}}}if(!v.ok){if(v.status===e6.TOO_MANY_REQUESTS){let e=tK(v.headers),t=tX(v.headers);if(null!=e)r("image-modality-rate-limit-modal"),w(e);else if(null!=t)j(t),d.z.capture({action:"modality_rate_limit_hit",params:{user_id:N,modality:b.modality,mode:b.mode,evaluation_session_id:b.id,context:"chat_retry"}});else{let e=await (null==v?void 0:v.clone().json()),t=null==e?void 0:e.modelId,a=t0(v.headers);null!=t&&null!=a&&E({id:t,rateLimitedUntil:new Date(new Date().getTime()+a).toISOString()})}}else{let{error:e}=await t$(v);null!=e&&e===e9.f$&&f.oR.error(e9.f$)}b.updateMessage({id:_.id,content:_.content,reasoning:_.reasoning,status:_.status,experimental_attachments:_.experimental_attachments}),o&&y.updateStatus(b.id,"error");return}d.z.capture({action:"chat_retry_success",params:{mode:b.mode,user_id:N,modality:b.modality,evaluation_session_id:b.id,message_status:_.status}});let I="",S=[],R=[],M=[],D=null==(g=v.body)?void 0:g.getReader();if(!D){o&&y.updateStatus(b.id,"error");return}return e5(D,{onTextChunk:(e,t)=>{let a=S.at(-1);(null==a?void 0:a.type)==="text"?a.text+=t:S=[...S,{type:"text",text:t}],b.updateMessage({id:m,content:S})},onReasoningChunk:(e,t)=>{I+=t,b.updateMessage({id:m,reasoning:I,content:S})},onSourceChunk:(e,t)=>{R=Array.isArray(t)?t:tq(R,t),b.updateMessage({id:m,sources:R})},onRoutedModelChunk:(e,t)=>{var a;b.updateMessage({id:m,metadata:{...null!=(a=_.metadata)?a:{},routedModelOrganization:t.organization}})},onImageChunk:(e,t)=>{var a;M.push({url:t.image,contentType:null!=(a=t.mimeType)?a:"image/png"}),b.updateMessage({id:m,experimental_attachments:M})},onVideoChunk:(e,t)=>{var a;M.push({url:t.url,contentType:null!=(a=t.mimeType)?a:"video/mp4",thumbnailUrl:t.thumbnailUrl}),b.updateMessage({id:m,experimental_attachments:M})},onWebDevChunk:(e,t)=>{"init"===t.type&&u(_.id,t.files)},onToolCallChunk:(e,t)=>{let a=S.findIndex(e=>"tool-call"===e.type&&e.toolCallId===t.toolCallId);-1!==a?(S=[...S])[a]={...t,type:"tool-call"}:S=[...S,{...t,type:"tool-call"}],b.updateMessage({id:m,content:S})},onToolResultChunk:(e,t,a)=>{let i=e7.VM.safeParse({toolCallId:a.toolCallId,toolName:a.toolName,args:a.args,result:t.result});i.success&&p(m,i.data);let s=S.find(e=>"tool-call"===e.type&&e.toolCallId===t.toolCallId);s&&(S=[...S,{...t,type:"tool-result",toolName:s.toolName}]),b.updateMessage({id:m,content:S})},onFinish:()=>{b.updateMessage({id:m,status:s.nH.SUCCESS}),d.z.capture({action:"chat_response_success",params:{response_type:"retry",mode:b.mode,user_id:N,modality:b.modality,evaluation_session_id:b.id,model_id:_.modelId,has_attachments:M.length>0,attachments_count:M.length,attachment_type:tT(M),file_count:tI(M),response_length:S.length}}),d.z.capture({action:"chat_responses_success",params:{response_type:"retry",mode:b.mode,user_id:N,modality:b.modality}}),b.modality===s.Jg.WEBDEV&&h(m),o&&y.updateStatus(b.id,"success")},onError:(e,t)=>{b.updateMessage({id:m,status:s.nH.FAILED,failureReason:null!=t?t:null}),o&&y.updateStatus(b.id,"error")}})},[e,c,t,a,r,n,l,u,p,h,x,i,o])}}let tJ=tR()(e=>Array.isArray(e.content)?e.content.filter(e=>"text"===e.type).map(e=>e.text||"").join(""):e.content);function tq(e,t){var a,i;let s=e.findIndex(e=>e.id===t.id);if(-1===s)return[...e,t];let r=e[s];if(!r)return[...e,t];let n={...r,...t,charLocation:[...null!=(a=r.charLocation)?a:[],...null!=(i=t.charLocation)?i:[]].filter((e,t,a)=>a.indexOf(e)===t).sort((e,t)=>e-t)};return[...e.slice(0,s),n,...e.slice(s+1)]}function tQ(e,t){if(e.get("Ratelimit-Modality")!==t)return null;let a=e.get("RateLimit-Reset");if(null!=a){let e=Number(a);if(!Number.isNaN(e))return new Date(1e3*e)}let i=e.get("Retry-After");if(null!=i){let e=Number(i);if(!Number.isNaN(e))return new Date(Date.now()+1e3*e)}let s=Number(e.get("ratelimit-remaining"));return null==s||Number.isNaN(s)?null:new Date(Date.now()+1e3*s)}function tK(e){return tQ(e,s.Jg.IMAGE)}function tX(e){return tQ(e,s.Jg.VIDEO)}let tZ=tM.Ik({error:tM.Yj()});async function t$(e){try{let t=await e.clone().json();return tZ.parse(t)}catch(e){return{error:null}}}function t0(e){let t=e.get("RateLimit-Reset");if(null!=t){let e=Number(t);if(!Number.isNaN(e))return Math.max(0,1e3*e-Date.now())}let a=e.get("Retry-After");if(null!=a){let e=Number(a);if(!Number.isNaN(e))return Math.max(0,1e3*e)}return null}function t1(e,t,a,i){switch(e){case s.lY.BATTLE:return 2;case s.lY.DIRECT:case s.lY.SIDE_BY_SIDE:case s.lY.DIRECT_BATTLE:return Math.min(...(e===s.lY.SIDE_BY_SIDE?[t,a]:[t]).map(e=>{var t,a,s;return null==(s=i.find(t=>t.id===e))||null==(a=s.metadata)||null==(t=a.fileUploadLimits)?void 0:t.maxFileCount}).filter(e=>void 0!==e),10);default:return 10}}function t2(){let[e]=(0,h.fp)(Y.A);return e.length>=10}function t4(e){let{message:t}=e,[a,s]=(0,h.fp)(Y.A),[n,o]=(0,g.useState)(!1),c=t2(),u=(0,m.kH)(e=>e.userId),{mode:p,modality:x}=(0,N.g)((0,k.k)(e=>({mode:e.mode,modality:e.modality}))),[v,b,y]=(0,L.g)((0,k.k)(e=>[e.modelAId,e.modelBId,e.models])),w=(0,g.useMemo)(()=>H(p,v,b,y,x),[p,v,b,y,x]);(0,g.useEffect)(()=>{var e,i;if(!n)return;let s=null==(i=t.experimental_attachments)||null==(e=i[0])?void 0:e.url;a.some(e=>(e.uploadedUrl||e.preview)===s)||o(!1)},[a,n,t.experimental_attachments]);let j=(0,g.useCallback)(()=>{var e,i;if(!n&&(null==(e=t.experimental_attachments)?void 0:e.length)&&!c){d.z.capture({action:"edit_image_button_clicked",params:{user_id:u,message_id:t.id,current_attachments_count:a.length}});try{let e=t.experimental_attachments[0];if(!e)throw Error("Invalid attachment: missing attachment");let a=new Blob([],{type:e.contentType}),r=new File([a],null!=(i=e.name)?i:"",{type:e.contentType});s(t=>[...t,{file:r,preview:e.url,isAlreadyUploaded:!0,uploadedUrl:e.url}]),o(!0)}catch(e){f.oR.error("Failed to add image to chat")}}},[t,s,n,c,u,a.length]);return n?(0,i.jsxs)(l.Button,{variant:"outline",size:"sm",className:"border-interactive-positive h-6 cursor-not-allowed gap-1 bg-green-500/10 px-1.5 py-0",disabled:!0,children:[(0,i.jsx)(r.Check,{size:12,className:"text-interactive-positive"}),(0,i.jsx)("span",{className:"text-interactive-positive text-xs font-medium leading-none",children:"Added"})]}):!w||c?(0,i.jsxs)(l.Button,{variant:"outline",size:"sm",className:"h-6 cursor-not-allowed gap-1 px-1.5 py-0 opacity-50",disabled:!0,children:[(0,i.jsx)(r.Pencil,{size:12}),(0,i.jsx)("span",{className:"text-xs font-medium leading-none",children:"Edit"})]}):(0,i.jsxs)(l.Button,{variant:"outline",size:"sm",className:"h-6 gap-1 px-1.5 py-0",onClick:j,children:[(0,i.jsx)(r.Pencil,{size:12}),(0,i.jsx)("span",{className:"text-interactive-normal text-xs font-medium leading-none",children:"Edit"})]})}var t5=a(38670);let t3={en:{"A is better":"A is better","B is better":"B is better","Left is Better":"Left is Better","Right is Better":"Right is Better","It's a tie":"It's a tie","Both are bad":"Both are bad","Both are good":"Both are good","Option A":"Option A","Option B":"Option B","Assistant A":"Assistant A","Assistant B":"Assistant B","Response A":"Response A","Response B":"Response B"},es:{"A is better":"A es mejor","B is better":"B es mejor","Left is Better":"A es mejor","Right is Better":"B es mejor","It's a tie":"Es un empate","Both are bad":"Ambos son malos","Both are good":"Ambos son buenos","Option A":"Opci\xf3n A","Option B":"Opci\xf3n B","Assistant A":"Asistente A","Assistant B":"Asistente B","Response A":"Respuesta A","Response B":"Respuesta B"},fr:{"A is better":"A est meilleur","B is better":"B est meilleur","Left is Better":"A est meilleur","Right is Better":"B est meilleur","It's a tie":"\xc9galit\xe9","Both are bad":"Tous mauvais","Both are good":"Tous bons","Option A":"Option A","Option B":"Option B","Assistant A":"Assistant A","Assistant B":"Assistant B","Response A":"R\xe9ponse A","Response B":"R\xe9ponse B"},de:{"A is better":"A ist besser","B is better":"B ist besser","Left is Better":"A ist besser","Right is Better":"B ist besser","It's a tie":"Unentschieden","Both are bad":"Beide schlecht","Both are good":"Beide gut","Option A":"Option A","Option B":"Option B","Assistant A":"Assistent A","Assistant B":"Assistent B","Response A":"Antwort A","Response B":"Antwort B"},zh:{"A is better":"A ","B is better":"B ","Left is Better":"","Right is Better":"","It's a tie":"","Both are bad":"","Both are good":"","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},ja:{"A is better":"A","B is better":"B","Left is Better":"","Right is Better":"","It's a tie":"","Both are bad":"","Both are good":"","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},ru:{"A is better":"A ","B is better":"B ","Left is Better":" ","Right is Better":" ","It's a tie":"","Both are bad":" ","Both are good":" ","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},pl:{"A is better":"A jest lepsze","B is better":"B jest lepsze","Left is Better":"Lewe jest lepsze","Right is Better":"Prawe jest lepsze","It's a tie":"Remis","Both are bad":"Oba s ze","Both are good":"Oba s dobre","Option A":"Opcja A","Option B":"Opcja B","Assistant A":"Asystent A","Assistant B":"Asystent B","Response A":"Odpowied A","Response B":"Odpowied B"},ko:{"A is better":"A  ","B is better":"B  ","Left is Better":"  ","Right is Better":"  ","It's a tie":"","Both are bad":"  ","Both are good":"  ","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},pt:{"A is better":"A \xe9 melhor","B is better":"B \xe9 melhor","Left is Better":"Esquerda \xe9 melhor","Right is Better":"Direita \xe9 melhor","It's a tie":"\xc9 um empate","Both are bad":"Ambos s\xe3o ruins","Both are good":"Ambos s\xe3o bons","Option A":"Op\xe7\xe3o A","Option B":"Op\xe7\xe3o B","Assistant A":"Assistente A","Assistant B":"Assistente B","Response A":"Resposta A","Response B":"Resposta B"},id:{"A is better":"A lebih baik","B is better":"B lebih baik","Left is Better":"Kiri lebih baik","Right is Better":"Kanan lebih baik","It's a tie":"Seri","Both are bad":"Keduanya buruk","Both are good":"Keduanya bagus","Option A":"Opsi A","Option B":"Opsi B","Assistant A":"Asisten A","Assistant B":"Asisten B","Response A":"Respons A","Response B":"Respons B"},tr:{"A is better":"A daha iyi","B is better":"B daha iyi","Left is Better":"Sol daha iyi","Right is Better":"Sa daha iyi","It's a tie":"Berabere","Both are bad":"kisi de k\xf6t\xfc","Both are good":"kisi de iyi","Option A":"Se\xe7enek A","Option B":"Se\xe7enek B","Assistant A":"Asistan A","Assistant B":"Asistan B","Response A":"Yant A","Response B":"Yant B"},it:{"A is better":"A \xe8 migliore","B is better":"B \xe8 migliore","Left is Better":"A \xe8 migliore","Right is Better":"B \xe8 migliore","It's a tie":"\xc8 un pareggio","Both are bad":"Entrambi cattivi","Both are good":"Entrambi buoni","Option A":"Opzione A","Option B":"Opzione B","Assistant A":"Assistente A","Assistant B":"Assistente B","Response A":"Risposta A","Response B":"Risposta B"},ar:{"A is better":" ","B is better":" ","Left is Better":" ","Right is Better":" ","It's a tie":"","Both are bad":" ","Both are good":" ","Option A":" ","Option B":" ","Assistant A":" ","Assistant B":" ","Response A":" ","Response B":" "},fa:{"A is better":"  ","B is better":"  ","Left is Better":"  ","Right is Better":"  ","It's a tie":" ","Both are bad":"   ","Both are good":"   ","Option A":" ","Option B":" ","Assistant A":" ","Assistant B":" ","Response A":" ","Response B":" "},vi:{"A is better":"A tt hn","B is better":"B tt hn","Left is Better":"B\xean tr\xe1i tt hn","Right is Better":"B\xean phi tt hn","It's a tie":"H\xf2a","Both are bad":"C hai u t","Both are good":"C hai u tt","Option A":"La chn A","Option B":"La chn B","Assistant A":"Tr l\xfd A","Assistant B":"Tr l\xfd B","Response A":"Phn hi A","Response B":"Phn hi B"},nl:{"A is better":"A is beter","B is better":"B is beter","Left is Better":"Links is beter","Right is Better":"Rechts is beter","It's a tie":"Het is gelijkspel","Both are bad":"Beide zijn slecht","Both are good":"Beide zijn goed","Option A":"Optie A","Option B":"Optie B","Assistant A":"Assistent A","Assistant B":"Assistent B","Response A":"Antwoord A","Response B":"Antwoord B"},sv:{"A is better":"A \xe4r b\xe4ttre","B is better":"B \xe4r b\xe4ttre","Left is Better":"V\xe4nster \xe4r b\xe4ttre","Right is Better":"H\xf6ger \xe4r b\xe4ttre","It's a tie":"Det \xe4r oavgjort","Both are bad":"B\xe5da \xe4r d\xe5liga","Both are good":"B\xe5da \xe4r bra","Option A":"Alternativ A","Option B":"Alternativ B","Assistant A":"Assistent A","Assistant B":"Assistent B","Response A":"Svar A","Response B":"Svar B"},cs:{"A is better":"A je lep\xed","B is better":"B je lep\xed","Left is Better":"Vlevo je lep\xed","Right is Better":"Vpravo je lep\xed","It's a tie":"Je to rem\xedza","Both are bad":"Oba jsou patn\xe9","Both are good":"Oba jsou dobr\xe9","Option A":"Monos A","Option B":"Monos B","Assistant A":"Asistent A","Assistant B":"Asistent B","Response A":"Odpov A","Response B":"Odpov B"},uk:{"A is better":"A ","B is better":"B ","Left is Better":" ","Right is Better":" ","It's a tie":"","Both are bad":" ","Both are good":" ","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},ro:{"A is better":"A este mai bun","B is better":"B este mai bun","Left is Better":"St\xe2nga este mai bun","Right is Better":"Dreapta este mai bun","It's a tie":"Este egalitate","Both are bad":"Ambele sunt rele","Both are good":"Ambele sunt bune","Option A":"Opiunea A","Option B":"Opiunea B","Assistant A":"Asistent A","Assistant B":"Asistent B","Response A":"Rspuns A","Response B":"Rspuns B"},hu:{"A is better":"Az A jobb","B is better":"A B jobb","Left is Better":"A bal jobb","Right is Better":"A jobb jobb","It's a tie":"D\xf6ntetlen","Both are bad":"Mindkett rossz","Both are good":"Mindkett j\xf3","Option A":"Lehets\xe9g A","Option B":"Lehets\xe9g B","Assistant A":"Asszisztens A","Assistant B":"Asszisztens B","Response A":"V\xe1lasz A","Response B":"V\xe1lasz B"},th:{"A is better":"A ","B is better":"B ","Left is Better":"","Right is Better":"","It's a tie":"","Both are bad":"","Both are good":"","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},el:{"A is better":" A  ","B is better":" B  ","Left is Better":" A  ","Right is Better":" B  ","It's a tie":"","Both are bad":"   ","Both are good":"   ","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},sk:{"A is better":"A je lepie","B is better":"B je lepie","Left is Better":"Vavo je lepie","Right is Better":"Vpravo je lepie","It's a tie":"Je to rem\xedza","Both are bad":"Obe s\xfa zl\xe9","Both are good":"Obe s\xfa dobr\xe9","Option A":"Monos A","Option B":"Monos B","Assistant A":"Asistent A","Assistant B":"Asistent B","Response A":"Odpove A","Response B":"Odpove B"},he:{"A is better":"A  ","B is better":"B  ","Left is Better":"  ","Right is Better":"  ","It's a tie":" ","Both are bad":" ","Both are good":" ","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},hi:{"A is better":"A  ","B is better":"B  ","Left is Better":"  ","Right is Better":"  ","It's a tie":"  ","Both are bad":"  ","Both are good":"  ","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},da:{"A is better":"A er bedre","B is better":"B er bedre","Left is Better":"Venstre er bedre","Right is Better":"H\xf8jre er bedre","It's a tie":"Det er uafgjort","Both are bad":"Begge er d\xe5rlige","Both are good":"Begge er gode","Option A":"Mulighed A","Option B":"Mulighed B","Assistant A":"Assistent A","Assistant B":"Assistent B","Response A":"Svar A","Response B":"Svar B"},fi:{"A is better":"A on parempi","B is better":"B on parempi","Left is Better":"A on parempi","Right is Better":"B on parempi","It's a tie":"Tasapeli","Both are bad":"Huonot","Both are good":"Hyv\xe4t","Option A":"Vaihtoehto A","Option B":"Vaihtoehto B","Assistant A":"Avustaja A","Assistant B":"Avustaja B","Response A":"Vastaus A","Response B":"Vastaus B"},sr:{"A is better":"A  ","B is better":"B  ","Left is Better":"  ","Right is Better":"  ","It's a tie":"","Both are bad":"  ","Both are good":"  ","Option A":" A","Option B":" B","Assistant A":" A","Assistant B":" B","Response A":" A","Response B":" B"},ca:{"A is better":"A \xe9s millor","B is better":"B \xe9s millor","Left is Better":"A \xe9s millor","Right is Better":"B \xe9s millor","It's a tie":"\xc9s un empat","Both are bad":"Tots dolents","Both are good":"Tots bons","Option A":"Opci\xf3 A","Option B":"Opci\xf3 B","Assistant A":"Assistent A","Assistant B":"Assistent B","Response A":"Resposta A","Response B":"Resposta B"},nb:{"A is better":"A er bedre","B is better":"B er bedre","Left is Better":"Venstre er bedre","Right is Better":"H\xf8yre er bedre","It's a tie":"Det er uavgjort","Both are bad":"Begge er d\xe5rlige","Both are good":"Begge er gode","Option A":"Alternativ A","Option B":"Alternativ B","Assistant A":"Assistent A","Assistant B":"Assistent B","Response A":"Svar A","Response B":"Svar B"},bs:{"A is better":"A je bolje","B is better":"B je bolje","Left is Better":"Lijevo je bolje","Right is Better":"Desno je bolje","It's a tie":"Nerijeeno","Both are bad":"Oba su loa","Both are good":"Oba su dobra","Option A":"Opcija A","Option B":"Opcija B","Assistant A":"Asistent A","Assistant B":"Asistent B","Response A":"Odgovor A","Response B":"Odgovor B"},lt:{"A is better":"A yra geresnis","B is better":"B yra geresnis","Left is Better":"Kair yra geresn","Right is Better":"Dein yra geresn","It's a tie":"Lygiosios","Both are bad":"Abu blogi","Both are good":"Abu geri","Option A":"Variantas A","Option B":"Variantas B","Assistant A":"Asistentas A","Assistant B":"Asistentas B","Response A":"Atsakymas A","Response B":"Atsakymas B"}};function t6(){let e=(0,A._P)("vote-translations-enabled"),t=(0,t5.Ym)(),a="treatment-1"===e;return(0,g.useCallback)(e=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return a&&(t3[t.split("-")[0]]||t3.en)[e]||e})(e,t,a),[t,a])}function t9(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Assistant",i=t6();return(0,g.useMemo)(()=>{if(null==e)return i(a);if("user"===e.role)return"User";if("assistant"===e.role){var s;let r=t.find(t=>t.id===e.modelId);return null==r?i("".concat(a," ").concat(e.participantPosition.toUpperCase())):null!=(s=r.displayName)?s:r.publicName}return e.role},[e,t,a,i])}function t8(){let e=Math.floor(5*Math.random())+2;return Array.from({length:e},(t,a)=>({id:a,className:"h-8 ".concat(a===e-1?"w-1/2":"w-full")}))}function t7(e){return(0,g.useMemo)(()=>{var t;return t=e,[s.nH.FAILED,s.nH.FLAGGED].includes(t.status)},[e])}function ae(e){var t;let a=t7(e),i=(0,g.useMemo)(()=>{var t,a,i;return""!==(t=e).content||(null!=(i=null==(a=t.experimental_attachments)?void 0:a.length)?i:0)>0},[e]),s=(0,g.useMemo)(()=>tJ(e),[e]),r=null!=(t=e.reasoning)?t:"";return(0,g.useMemo)(()=>({hasError:a,hasContent:i,contentString:s,reasoningText:r,shouldShowErrorOnly:a&&!i}),[a,i,s,r])}var at=a(96884);let aa=(0,at.createServerReference)("6055ff3489db5ffded22fa07b0f73444a88b9320f9",at.callServer,void 0,at.findSourceMapURL,"createPointwiseFeedback"),ai=(0,g.memo)(function(e){let{children:t,className:a,duration:s=2,spread:r=2}=e,n=(0,g.useMemo)(()=>t.length*r,[t,r]);return(0,i.jsx)("p",{className:(0,_.cn)("relative inline-block bg-[length:250%_100%,auto] bg-clip-text","text-transparent [--base-color:#a1a1aa] [--base-gradient-color:#000]","[--bg:linear-gradient(90deg,#0000_calc(50%-var(--spread)),var(--base-gradient-color),#0000_calc(50%+var(--spread)))] [background-repeat:no-repeat,padding-box]","dark:[--base-color:#71717a] dark:[--base-gradient-color:#ffffff] dark:[--bg:linear-gradient(90deg,#0000_calc(50%-var(--spread)),var(--base-gradient-color),#0000_calc(50%+var(--spread)))]",a),style:{"--spread":"".concat(n,"px"),backgroundImage:"var(--bg), linear-gradient(var(--base-color), var(--base-color))",animation:"shimmer ".concat(s,"s linear infinite")},children:t})});var as=a(30911);let ar=(0,g.createContext)(null);function an(e){let{children:t,messageLayoutMode:a}=e,s=(0,g.useMemo)(()=>({messageLayoutMode:a}),[a]);return(0,i.jsx)(ar.Provider,{value:s,children:t})}function al(){let e=(0,g.useContext)(ar);if(!e)throw Error("The MessageContext was not set. If using message components outside of <AssistantMessage /> please use <MessageContextProvider /> ");return e}function ao(e){let{imageUrl:t,imageName:a,onClose:s}=e;return(0,g.useEffect)(()=>{let e=e=>{"Escape"===e.key&&s()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s]),(0,i.jsx)(o.lG,{open:!0,onOpenChange:e=>!e&&s(),children:(0,i.jsxs)(o.Cf,{"aria-describedby":void 0,showCloseButton:!1,className:"max-h-[90vh] max-w-fit border-none bg-transparent p-0 shadow-none",onClick:s,children:[(0,i.jsx)(o.L3,{className:"sr-only",children:"Image Lightbox"}),(0,i.jsx)("button",{onClick:s,className:"absolute right-4 top-4 z-10 flex h-8 w-8 items-center justify-center rounded-full bg-black/50 p-2 text-white hover:bg-black/70 md:hidden","aria-label":"Close image",children:(0,i.jsx)(r.X,{className:"h-4 w-4"})}),(0,i.jsx)("div",{className:"relative",children:(0,i.jsx)("img",{src:t,alt:a,className:"h-auto max-h-[90vh] w-auto max-w-[90vw] rounded-lg object-contain shadow-lg",onClick:e=>e.stopPropagation()})})]})})}var ac=a(68838);function ad(e,t){try{let a=new URL(e);return a.searchParams.set("retry",t.toString()),a.toString()}catch(t){return e}}async function au(e,t,a,i){if(t>3)return void i();if(!function(e){try{return new URL(e).hostname.endsWith("cloudflarestorage.com")}catch(t){return e.endsWith("cloudflarestorage.com")}}(e))return void a(ad(e,t));try{let t=await (0,ac.w)(e);if(t.success)a(t.data);else throw Error("Failed to fetch image through proxy")}catch(s){console.error("Retry failed for Cloudflare image:",s,"Attempt:",t),t>=3?i():a(ad(e,t))}}var am=a(75183),ap=a(29495);function ah(e){let{url:t,name:a,className:s,target:r="_blank",rel:l="noopener noreferrer",contentType:o}=e,{icon:c,label:d}="application/pdf"===o?{icon:ap.A,label:"PDF"}:{icon:ec.A,label:null},u="text-interactive-link";return(0,i.jsx)("div",{className:(0,_.cn)("border-interactive-link/[0.24] bg-interactive-link/[0.12] h-12 w-[240px] rounded-lg border p-3",s),children:(0,i.jsxs)(n.Link,{href:null!=t?t:"#",target:t?r:void 0,rel:t?l:void 0,disableLinkColor:!0,onClick:t?void 0:e=>e.preventDefault(),className:"flex min-w-0 items-center gap-2 text-xs font-medium leading-[120%]",children:[(0,i.jsx)(c,{className:"".concat(u," size-5 flex-shrink-0")}),(0,i.jsx)("span",{className:(0,_.cn)("min-w-0 truncate",u),children:null!=a?a:"File"}),d&&(0,i.jsx)("span",{className:(0,_.cn)("text-interactive-on-cta bg-interactive-link flex items-center justify-center gap-2 rounded-[2px] px-1.5 py-1 text-xs font-medium leading-[120%]"),children:d})]})})}function ag(e){let{src:t,alt:a,className:s,fallback:r,onLoad:n,onError:l,onRetry:o,showLoadingState:c=!0,...d}=e,[u,m]=(0,g.useState)("loading"),p=(0,g.useRef)(0),h=(0,g.useRef)(null);(0,g.useEffect)(()=>{t&&(m("loading"),p.current=0)},[t]),(0,g.useEffect)(()=>{let e=h.current;e&&e.complete&&e.naturalWidth>0&&m("loaded")},[t]);let f=(0,g.useCallback)(e=>{m("loaded"),p.current=0,null==n||n(e)},[n]),x=(0,g.useCallback)(e=>{m("error"),p.current+=1,null==o||o(p.current),null==l||l(e)},[l,o]);return"error"===u&&r?(0,i.jsx)(i.Fragment,{children:r}):"error"!==u||r?(0,i.jsxs)("div",{className:"relative",children:["loading"===u&&c&&(0,i.jsx)(af,{}),(0,i.jsx)("img",{ref:h,src:t,alt:a,className:(0,_.cn)("transition-opacity duration-500","loading"===u&&c?"opacity-0":"opacity-100",s),onLoad:f,onError:x,...d})]}):(0,i.jsx)(ax,{className:s})}function af(){return(0,i.jsx)("div",{className:"bg-surface-secondary absolute inset-0 flex items-center justify-center overflow-hidden rounded-md",children:(0,i.jsx)(r.Loader,{className:"text-text-primary size-4 animate-spin"})})}function ax(e){let{className:t}=e;return(0,i.jsx)("div",{className:(0,_.cn)("bg-surface-secondary flex flex-col items-center justify-center overflow-hidden rounded-lg",t),children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 p-3",children:[(0,i.jsx)(r.AlertTriangle,{size:24,className:"text-interactive-negative"}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"text-text-primary text-sm font-medium",children:"Image unavailable"}),(0,i.jsx)("div",{className:"text-text-secondary mt-1 text-xs",children:"Failed to load"})]})]})})}let av=(0,am.default)(()=>Promise.all([a.e(47197),a.e(27104),a.e(65835)]).then(a.bind(a,65835)).then(e=>({default:e.VideoPlayer})),{loadableGenerated:{webpack:()=>[65835]},ssr:!1});function ab(e){var t,a,r;let{attachment:l,role:o,onOpenLightbox:c,messageId:d}=e,u=t_(null==l?void 0:l.contentType),m="video"===u,p="image"===u,h=m?tB(l):void 0,f=m&&null!=h?h:l.url,x=(0,S.d)("md"),v=(0,g.useRef)(0),[b,y]=(0,g.useState)(f),w=(0,N.g)(e=>e.markVideoAsViewed);(0,g.useEffect)(()=>{y(f),v.current=0},[f]);let j=(0,g.useCallback)(()=>{f&&(v.current+=1,au(f,v.current,e=>y(e),()=>{}))},[f]),k=(0,g.useCallback)(()=>{o===s.PG.ASSISTANT&&d&&w(d)},[w,d,o]);if(m)return o===s.PG.USER?!function(e){if(!tB(e))return!1;let t=null==e?void 0:e.url;return"string"==typeof t&&t.trim().length>0}(l)?(0,i.jsx)(ah,{url:l.url,name:l.name,contentType:l.contentType}):(0,i.jsx)("div",{className:"w-fit",children:(0,i.jsx)(n.Link,{href:l.url,target:"_blank",rel:"noopener noreferrer",disableLinkColor:!0,className:"block",children:(0,i.jsx)(ag,{src:b,alt:null!=(t=l.name)?t:"",className:"aspect-square w-32 cursor-pointer overflow-hidden rounded-lg object-cover object-center opacity-100 transition-opacity duration-300",onError:j,onRetry:e=>{v.current=e},showLoadingState:!0})})}):(0,i.jsx)(av,{videoUrl:l.url,onPlay:k,videoSizeClass:"w-auto h-auto",poster:h,messageId:d});return o===s.PG.USER&&"pdf"===u?(0,i.jsx)(ah,{url:l.url,name:l.name,contentType:l.contentType}):o===s.PG.USER&&p?(0,i.jsx)("div",{className:"w-fit",children:(0,i.jsx)(ag,{src:b,alt:null!=(a=l.name)?a:"",className:"aspect-square w-32 cursor-pointer overflow-hidden rounded-lg object-cover object-center opacity-100 transition-opacity duration-300",onClick:c,onError:j,onRetry:e=>{v.current=e},showLoadingState:!0})}):o!==s.PG.USER&&p?(0,i.jsx)("div",{className:x?"h-[50vh] flex justify-center items-center":"w-fit",children:(0,i.jsx)(ag,{src:b,alt:null!=(r=l.name)?r:"",className:x?"max-h-[50vh] cursor-pointer overflow-hidden rounded-lg":"aspect-square h-[50vh] w-[50vh] max-w-full cursor-pointer overflow-hidden rounded-lg object-cover object-center",loading:"lazy",onClick:c,onError:j,onRetry:e=>{v.current=e},showLoadingState:!0})}):"file"===u?(0,i.jsx)(n.Link,{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"break-all",children:l.name}):null}function ay(e){let{message:t}=e,{messageLayoutMode:a}=al(),{experimental_attachments:r=[],role:n,status:l}=t,o=(0,N.g)(e=>e.modality),c=(0,N.g)(e=>e.isFastModeInProgress),[d,u]=(0,g.useState)(null);if(n===s.PG.ASSISTANT&&(null==r?void 0:r.length)===0&&o===s.Jg.IMAGE&&l===s.nH.PENDING)return(0,i.jsx)("div",{className:(0,_.cn)("flex w-full flex-row items-center justify-start"),children:(0,i.jsx)(ai,{children:c?"Using faster models...":"Generating image..."})});if(n===s.PG.ASSISTANT&&(null==r?void 0:r.length)===0&&o===s.Jg.VIDEO&&l===s.nH.PENDING)return(0,i.jsx)("div",{className:(0,_.cn)("flex w-full flex-row items-center justify-start"),children:(0,i.jsx)(ai,{children:"Generating video..."})});if((null==r?void 0:r.length)===0)return null;let m=n===s.PG.USER;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,_.cn)("flex w-full flex-row items-center gap-2",m&&"ml-auto max-w-2xl flex-wrap",m?"justify-end":"page"===a?"justify-start":"justify-center"),children:r.map(e=>(0,i.jsx)(ab,{attachment:e,role:n,messageId:t.id,onOpenLightbox:()=>u(e)},e.url))}),d&&(0,i.jsx)(ao,{imageUrl:d.url,imageName:d.name,onClose:()=>u(null)})]})}var aw=a(50220),aj=a.n(aw),aN=a(24064),ak=a(714);function aE(e){let{className:t}=e,{resolvedTheme:a}=(0,ak.D)(),{RiveComponent:s}=(0,aN.useRive)({src:"dark"===a?"/rive/searching-lg-dark.riv":"/rive/searching-lg-light.riv",autoplay:!0});return(0,i.jsx)(s,{className:t},a)}var aA=a(94429);let aC=new Set;function a_(e){var t;let{source:a,tabIndex:s}=e,l=(0,g.useRef)(null),[o,c]=(0,g.useState)(()=>!!a.favicon&&aC.has(a.favicon)),[d,u]=(0,g.useState)(()=>!!a.thumbnail&&aC.has(a.thumbnail));return(0,i.jsxs)(n.Link,{ref:l,href:a.url,className:"hover:bg-surface-secondary focus-visible:ring-ring group flex min-h-[80px] w-full items-center justify-start gap-2 self-stretch overflow-hidden rounded-xl p-2 no-underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-inset sm:min-h-[96px] sm:gap-4 [&::after]:content-none",tabIndex:s,children:[(0,i.jsx)("div",{className:"flex min-w-0 flex-1 flex-col items-start justify-center gap-2 overflow-hidden",children:(0,i.jsxs)("div",{className:"flex w-full min-w-0 items-center justify-start gap-2",children:[a.favicon&&!o?(0,i.jsx)("div",{className:"border-border-faint/30 relative h-8 w-8 flex-shrink-0 overflow-hidden rounded-lg border",children:(0,i.jsx)(aA.default,{src:a.favicon,alt:"favicon",width:32,height:32,className:"object-cover",referrerPolicy:"no-referrer",onError:()=>{a.favicon&&aC.add(a.favicon),c(!0)}})}):(0,i.jsx)("div",{className:"bg-surface-secondary border-border-faint/30 relative flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-lg border",children:(0,i.jsx)(r.Globe,{className:"text-interactive-normal h-4 w-4"})}),(0,i.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start justify-start gap-0.5",children:[(0,i.jsxs)("div",{className:"flex w-full min-w-0 items-start justify-start gap-1",children:[(0,i.jsx)("div",{className:"bg-surface-raised mt-0.5 inline-flex w-4 flex-shrink-0 items-center justify-center rounded p-0.5",children:(0,i.jsx)("p",{className:"text-interactive-link text-center text-[10px] leading-3",children:a.id})}),(0,i.jsx)("p",{className:"text-text-primary min-w-0 flex-1 truncate text-sm font-medium leading-tight",children:null!=(t=a.title)?t:"Untitled"})]}),(0,i.jsx)("p",{className:"text-interactive-link w-full truncate text-xs leading-normal",children:a.url||""})]})]})}),a.thumbnail&&!d&&(0,i.jsx)("div",{className:"bg-surface-secondary relative hidden aspect-video w-1/4 max-w-[220px] overflow-hidden rounded-lg min-[425px]:block",children:(0,i.jsx)(aA.default,{src:a.thumbnail,alt:"preview",fill:!0,sizes:"(max-width: 425px) 0vw, (max-width: 768px) 25vw, 220px",className:"object-cover",quality:85,onError:()=>{a.thumbnail&&aC.add(a.thumbnail),u(!0)}})})]})}function aB(e){let{sources:t,isComplete:a}=e,s=(0,N.g)(e=>e.isFastModeInProgress),[n,l]=(0,g.useState)(!1),[o,c]=(0,g.useState)(0),d=(0,g.useRef)(null),[u,m]=(0,g.useState)(!1);(0,g.useEffect)(()=>{let e=d.current;if(!e)return;let t=()=>{c(n?e.scrollHeight:0)};if(t(),n){let a=new ResizeObserver(t);return a.observe(e),()=>a.disconnect()}},[n,t]),(0,g.useEffect)(()=>{if(a){let e=setTimeout(()=>m(!0),10);return()=>clearTimeout(e)}m(!1),l(!1)},[a]);let p=(null==t?void 0:t.length)&&t.every(e=>e&&e.url&&e.title&&e.favicon);return u&&(!t||0===t.length)?(0,i.jsx)("div",{className:"border-border-faint flex w-full flex-col rounded-md border p-3",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(r.Globe,{className:"text-interactive-normal h-4 w-4"}),(0,i.jsx)("div",{className:"text-interactive-normal text-sm",children:"No Sources"})]})}):a&&p?(0,i.jsxs)("div",{className:(0,_.cn)("border-border-faint flex w-full flex-col border",n?"rounded-xl":"rounded-md"),children:[(0,i.jsxs)("button",{onClick:e=>{var t;e.preventDefault();let a=null==(t=d.current)?void 0:t.closest(".overflow-y-auto");if(a){let e=a.scrollTop,t=()=>{a.scrollTop=e};a.addEventListener("scroll",t),setTimeout(()=>a.removeEventListener("scroll",t),250)}l(!n)},className:"focus-visible:ring-ring focus-visible:ring-offset-surface-primary group relative z-10 flex w-full items-center justify-between rounded-md p-3 text-left hover:no-underline focus-visible:rounded-md focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2","aria-expanded":n,children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(r.Globe,{className:"text-interactive-link h-4 w-4"}),(0,i.jsx)("div",{className:"text-interactive-active text-sm leading-none",children:"Sources"})]}),(0,i.jsx)(r.ChevronDown,{className:(0,_.cn)("text-interactive-normal h-5 w-5 shrink-0 transition-transform duration-200",n&&"rotate-180")})]}),(0,i.jsx)("div",{className:"relative z-0 w-full overflow-hidden transition-all duration-200 ease-out",style:{height:"".concat(o,"px"),opacity:+!!n},children:(0,i.jsx)("div",{ref:d,children:(0,i.jsx)("div",{className:"relative z-0 flex flex-col px-3 pb-3",children:null==t?void 0:t.map(e=>(0,i.jsx)(a_,{source:e,tabIndex:n?0:-1},e.id))})})})]}):(0,i.jsx)("div",{className:"border-border-faint flex w-full flex-col rounded-md border p-3",children:(0,i.jsxs)("div",{className:"jsx-d200430162549f6e flex items-center gap-2",children:[(0,i.jsx)(aE,{className:"h-4 w-4"}),(0,i.jsx)(ai,{className:"text-sm",duration:2,children:s?"Using faster models...":"Searching..."}),(0,i.jsx)(aj(),{id:"d200430162549f6e",children:".light [data-shimmer].jsx-d200430162549f6e{--base-gradient-color:rgba(0, 0, 0, 0.15)}.dark [data-shimmer].jsx-d200430162549f6e{--base-gradient-color:rgba(255, 255, 255, 0.3)}"})]})})}var aT=a(32914);function aI(e,t){var a;return null!=(a=e[t])?a:{claims:new Map,status:"loading",extractionComplete:!1}}let aS=(0,a(76584).v)()(e=>({verifications:{},startVerification:t=>{e(e=>({verifications:{...e.verifications,[t]:{claims:new Map,status:"loading",extractionComplete:!1}}}))},addClaim:(t,a)=>{e(e=>{let i=aI(e.verifications,t),s=new Map(i.claims);return s.set(a.index,a),{verifications:{...e.verifications,[t]:{...i,claims:s}}}})},updateSummary:(t,a,i)=>{e(e=>{let s=aI(e.verifications,t),r=s.claims.get(a);if(!r)return e;let n=new Map(s.claims);return n.set(a,{...r,summary:i}),{verifications:{...e.verifications,[t]:{...s,claims:n}}}})},updateVerification:t=>{let{messageId:a,claimIndex:i,verifierIndex:s,verification:r,currentPrediction:n,currentProbability:l}=t;e(e=>{let t=aI(e.verifications,a),o=t.claims.get(i);if(!o)return e;let c=new Map(o.verifications);c.set(s,r);let d=new Map(t.claims);return d.set(i,{...o,verifications:c,currentPrediction:n,currentProbability:l}),{verifications:{...e.verifications,[a]:{...t,claims:d}}}})},updateAggregation:t=>{let{messageId:a,claimIndex:i,prediction:s,probability:r}=t;e(e=>{let t=aI(e.verifications,a),n=t.claims.get(i);if(!n)return e;let l=new Map(t.claims);return l.set(i,{...n,currentPrediction:s,currentProbability:r}),{verifications:{...e.verifications,[a]:{...t,claims:l}}}})},setExtractionComplete:t=>{e(e=>{let a=aI(e.verifications,t);return{verifications:{...e.verifications,[t]:{...a,extractionComplete:!0}}}})},setStatus:(t,a)=>{e(e=>{let i=aI(e.verifications,t);return{verifications:{...e.verifications,[t]:{...i,status:a}}}})},setError:(t,a)=>{e(e=>{let i=aI(e.verifications,t);return{verifications:{...e.verifications,[t]:{...i,status:"error",error:a}}}})},clearVerification:t=>{e(e=>{let{[t]:a,...i}=e.verifications;return{verifications:i}})}}));var aR=a(98574),aM=a(19730),aD=a(93315),aO=a(93534);a(24568);var aP=a(97022);let az=aP.bL,aL=aP.l9,aU=g.forwardRef((e,t)=>{let{className:a,align:s="center",sideOffset:r=4,...n}=e;return(0,i.jsx)(aP.UC,{ref:t,align:s,sideOffset:r,className:(0,_.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-64 origin-[--radix-hover-card-content-transform-origin] rounded-md border p-4 shadow-md outline-none",a),...n})});aU.displayName=aP.UC.displayName;let aF=new Set;function aG(e){var t;let{citation:a,children:s}=e,[n,l]=(0,g.useState)(!1),[o,c]=(0,g.useState)(()=>!!a.favicon&&aF.has(a.favicon)),[d,u]=(0,g.useState)(()=>!!a.thumbnail&&aF.has(a.thumbnail)),m=()=>{n&&l(!1)},p=(0,i.jsxs)("div",{className:"bg-surface-primary outline-border-faint/30 inline-flex w-[14rem] flex-col items-start justify-center gap-2 rounded-lg p-2 shadow-[2px_4px_24px_0px_rgba(0,0,0,0.12)] outline outline-1 outline-offset-[-1px]",children:[a.thumbnail&&!d&&(0,i.jsx)("div",{className:"border-border-faint/10 relative h-28 self-stretch overflow-hidden rounded border",children:(0,i.jsx)(aA.default,{src:a.thumbnail,alt:"preview",fill:!0,className:"object-cover",quality:65,loading:"eager",priority:!0,sizes:"224px",onError:()=>{a.thumbnail&&aF.add(a.thumbnail),u(!0)}})}),(0,i.jsxs)("div",{className:"flex flex-col items-start justify-center gap-1.5 self-stretch",children:[(0,i.jsx)("div",{className:"w-full",children:(0,i.jsx)("div",{className:"text-text-primary line-clamp-2 font-['Inter'] text-sm font-medium leading-tight",children:null!=(t=a.title)?t:"Untitled"})}),(0,i.jsxs)("div",{className:"flex w-full min-w-0 items-center gap-1",children:[a.favicon&&!o?(0,i.jsx)("div",{className:"border-border-faint/30 h-5 w-5 flex-shrink-0 overflow-hidden rounded-sm border",children:(0,i.jsx)(aA.default,{src:a.favicon,alt:"favicon",width:20,height:20,className:"object-cover",loading:"eager",priority:!0,onError:()=>{a.favicon&&aF.add(a.favicon),c(!0)}})}):(0,i.jsx)("div",{className:"bg-surface-secondary border-border-faint/30 flex h-5 w-5 flex-shrink-0 items-center justify-center rounded-sm border",children:(0,i.jsx)(r.Globe,{className:"text-interactive-normal h-3 w-3"})}),(0,i.jsx)("a",{className:"text-interactive-normal hover:text-interactive-link min-w-0 flex-1 truncate font-['Inter'] text-xs font-normal leading-normal no-underline transition-colors",target:"_blank",href:a.url,rel:"noopener noreferrer",children:(e=>{try{let t=new URL(e);return t.hostname.replace(/^www\./,"")+t.pathname+t.search+t.hash}catch(t){return e}})(a.url)})]})]})]});return(0,i.jsxs)(az,{openDelay:150,children:[(0,i.jsx)(aL,{asChild:!0,children:(0,i.jsx)("span",{className:"inline-flex p-0.5",onClick:()=>{l(!0)},onMouseEnter:m,onKeyDown:m,children:s})}),!n&&(0,i.jsx)(aU,{className:"not-prose z-50 border-none bg-transparent p-0 shadow-none",side:"top",align:"center",sideOffset:8,avoidCollisions:!0,collisionPadding:10,children:p})]})}function aH(e){let{citation:t,isComplete:a=!0}=e,s=(0,i.jsx)("span",{className:(0,_.cn)("bg-surface-raised inline-flex h-4 w-4 items-center justify-center rounded-sm p-0.5",a?"cursor-pointer":"cursor-default"),children:(0,i.jsx)("span",{className:(0,_.cn)("text-center font-['Inter'] text-[10px] font-normal leading-3",a?"text-interactive-link":"text-interactive-normal"),children:t.id})});return a?(0,i.jsx)(aG,{citation:t,children:(0,i.jsx)(n.Link,{href:t.url,className:"focus-visible:ring-ring inline-flex rounded-sm no-underline focus-visible:outline-none focus-visible:ring-2",disableLinkColor:!0,children:s})}):(0,i.jsx)("span",{className:"inline-flex cursor-default rounded-sm p-0.5",children:s})}var aV=a(315);let aW="\x3c!--citation:";function aY(){return e=>{let t=(e,a,i)=>{var s;let r="html"===e.type,n="text"===e.type&&(null==(s=e.value)?void 0:s.includes(aW));if((r||n)&&e.value){let t,s=RegExp("".concat(aW,"([^-]+?)").concat("--\x3e"),"g"),r=[],n=0;for(;null!==(t=s.exec(e.value));){if(t.index>n){let a=e.value.slice(n,t.index);a&&r.push({type:e.type,value:a})}r.push({type:"inlineCode",value:"citation:".concat(t[1]),data:{hProperties:{className:"citation-marker"}}}),n=t.index+t[0].length}if(n<e.value.length&&r.push({type:e.type,value:e.value.slice(n)}),r.length>0&&i&&null!==a)return i.children.splice(a,1,...r),a+r.length-1}if(e.children){let a=0;for(;a<e.children.length;){let i=t(e.children[a],a,e);a="number"==typeof i?i+1:a+1}}};t(e,null,null)}}let aJ=(0,g.createContext)(new Map),aq=(0,g.memo)(e=>{let{content:t,sources:a,className:s,isComplete:r}=e,n=(0,g.useMemo)(()=>new Map((null==a?void 0:a.map(e=>[e.id,e]))||[]),[a]),l=(0,g.useMemo)(()=>(function(e,t){if(!e||!t.length)return e||"";let a=new Map;t.forEach(e=>{var t;null==(t=e.charLocation)||t.forEach(t=>{var i;let s=null!=(i=a.get(t))?i:[];s.push(e.id),a.set(t,s)})});let i=e;return Array.from(a.keys()).sort((e,t)=>t-e).forEach(e=>{var t;let s=(null!=(t=a.get(e))?t:[]).map(e=>"".concat(aW).concat(e).concat("--\x3e")).join("");e<=i.length&&(i=i.slice(0,e)+s+i.slice(e))}),i})(t||"",a||[]),[t,a]);return l?(0,i.jsx)(aJ.Provider,{value:n,children:(0,i.jsx)("div",{className:(0,_.cn)("prose prose-sm prose-pre:bg-transparent prose-pre:p-0 text-wrap break-words",s),children:(0,i.jsx)(aR.oz,{remarkPlugins:[aD.A,[aO.A,{singleDollarTextMath:!0}],aY],rehypePlugins:[[aM.A,{displayMode:!0,throwOnError:!1,errorColor:"#cc0000"}]],components:{code(e){let{children:t,className:a,...s}=e;if("citation-marker"===a&&"string"==typeof t){let e=t.replace("citation:",""),a=n.get(e);return a?(0,i.jsx)(aH,{citation:a,isComplete:r}):null}return(0,i.jsx)(aV.Hd,{className:a,...s,children:t})}},children:l})})}):null},(e,t)=>e.content===t.content&&e.id===t.id&&JSON.stringify(e.sources)===JSON.stringify(t.sources)&&e.className===t.className&&e.isComplete===t.isComplete);aq.displayName="CitationAwareMarkdown";var aQ=a(1090),aK=a(40909),aX=a(8929);let aZ=(0,g.memo)(e=>{let{className:t,...a}=e;return(0,i.jsx)(aX.jH,{className:(0,_.cn)("size-full [&>*:first-child]:mt-0 [&>*:last-child]:mb-0",t),...a})});aZ.displayName="Response";let a$=(0,g.createContext)(null),a0=(0,g.memo)(e=>{let{className:t,isStreaming:a=!1,isReasoningComplete:s=!1,open:r,defaultOpen:n=!0,onOpenChange:l,duration:o,reasoningText:c,children:d,...u}=e,[m,p]=(0,aQ.i)({prop:r,defaultProp:n,onChange:l}),h=!c||a||o?0:Math.max(1,Math.ceil(c.length/500)),[f,x]=(0,aQ.i)({prop:o,defaultProp:h}),[v,b]=(0,g.useState)(!1),[y,w]=(0,g.useState)(null),[j,N]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{a&&!j?(w(Date.now()),N(!0)):j&&s&&null!==y&&(x(Math.ceil((Date.now()-y)/1e3)),w(null))},[a,s,y,j,x]),(0,g.useEffect)(()=>{if(n&&s&&m&&!v&&f>0){let e=setTimeout(()=>{p(!1),b(!0)},1500);return()=>clearTimeout(e)}},[s,m,n,p,v,f]),(0,i.jsx)(a$.Provider,{value:{isStreaming:a,isOpen:m,setIsOpen:p,duration:f},children:(0,i.jsx)(aK.Nt,{className:(0,_.cn)("not-prose mb-4",t),onOpenChange:e=>{p(e)},open:m,...u,children:d})})}),a1=(0,g.memo)(e=>{let{className:t,children:a,...s}=e,{isStreaming:n,isOpen:l,duration:o}=(()=>{let e=(0,g.useContext)(a$);if(!e)throw Error("Reasoning components must be used within Reasoning");return e})();return(0,i.jsx)(aK.R6,{className:(0,_.cn)("text-text-secondary hover:text-text-tertiary flex w-full items-center gap-1.5 text-sm transition-colors",t),...s,children:null!=a?a:(0,i.jsxs)(i.Fragment,{children:[((e,t)=>e?(0,i.jsx)(ai,{className:"text-sm",children:"Thinking..."}):void 0===t||0===t?(0,i.jsx)("p",{children:"Thought for a few seconds"}):(0,i.jsxs)("p",{className:"leading-[normal]",children:["Thought for ",(e=>{if(e<60)return"".concat(e," second").concat(1===e?"":"s");let t=Math.floor(e/60),a=e%60;return 0===a?"".concat(t," minute").concat(1===t?"":"s"):"".concat(t," minute").concat(1===t?"":"s"," and ").concat(a," second").concat(1===a?"":"s")})(t)]}))(n,o),(0,i.jsx)(r.ChevronDownIcon,{className:(0,_.cn)("size-4 transition-transform",l?"rotate-180":"rotate-0")})]})})}),a2=e=>{let{className:t,children:a,...s}=e;return(0,i.jsx)(aK.Ke,{className:(0,_.cn)("mt-4 text-sm","data-[state=closed]:fade-out-0 data-[state=closed]:slide-out-to-top-2 data-[state=open]:slide-in-from-top-2","data-[state=closed]:animate-out data-[state=open]:animate-in","data-[state=closed]:duration-150 data-[state=open]:duration-150","text-text-secondary outline-none",t),...s,children:(0,i.jsxs)("div",{className:"relative pl-6 pr-2",children:[(0,i.jsx)("div",{className:"bg-sidebar-border absolute bottom-0 left-1 top-0 w-px"}),(0,i.jsx)(aZ,{className:"font-mono text-xs leading-relaxed",children:a})]})})};function a4(e){let{errorMessage:t}=e;return(0,i.jsx)("p",{className:"text-interactive-negative text-sm font-normal",children:null!=t?t:"Something went wrong with this response, please try again."})}a0.displayName="Reasoning",a1.displayName="ReasoningTrigger",a2.displayName="ReasoningContent";var a5=a(65959),a3=a(9024),a6=a(7014),a9=a(16468);function a8(e){var t,a;let{verification:s}=e,n=null==(t=s.output)?void 0:t.toString().trim().toLowerCase(),l="true"===n?"agree":"false"===n?"disagree":"unknown",o=function(e){if(!e)return;let t=e.toLowerCase();return t.includes("google")||t.includes("gemini")?"google":t.includes("anthropic")||t.includes("claude")?"anthropic":t.includes("openai")||t.includes("gpt")?"openai":void 0}(s.verifierName);return(0,i.jsxs)("div",{className:"flex flex-col gap-[6px]",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,i.jsx)(el.D,{organization:o,className:"size-4"}),(0,i.jsx)("span",{className:"text-text-tertiary text-sm leading-4",children:(null==(a=s.verifierName)?void 0:a.includes("/"))?s.verifierName.split("/").slice(1).join("/"):s.verifierName}),(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsxs)("span",{className:(0,_.cn)("bg-surface-tertiary flex items-center gap-1 rounded-md px-2 py-1 font-mono text-xs leading-4",{"text-interactive-positive":"agree"===l,"text-interactive-negative":"disagree"===l,"text-text-tertiary":"unknown"===l}),children:["agree"===l?"AGREE":"disagree"===l?"DISAGREE":"UNKNOWN","disagree"===l&&(0,i.jsx)(r.WhiteFlag,{className:"text-text-muted size-3"})]})]}),s.reason&&(0,i.jsx)(aT.A,{id:"verification-".concat(s.verifierName),content:s.reason,className:"text-text-primary prose-ul:list-outside prose-ol:list-outside prose-ul:pl-4 prose-ol:pl-4 text-sm leading-5"}),s.sources&&s.sources.length>0&&(0,i.jsxs)("div",{className:"flex flex-col gap-[6px]",children:[(0,i.jsx)("span",{className:"text-text-tertiary font-mono text-xs leading-4",children:"SOURCES"}),s.sources.map((e,t)=>{var a,s;return(0,i.jsx)("a",{href:null!=(a=e.url)?a:void 0,target:"_blank",rel:"noopener noreferrer",className:"bg-surface-tertiary font-heading text-interactive-link block truncate rounded-md p-1 text-sm font-light leading-4 underline",children:null!=(s=e.title)?s:e.url},t)})]})]})}function a7(e){var t;let{analysisSidebar:a,onClose:s}=e,n=null!==a,l=(0,g.useRef)(a);a&&(l.current=a);let o=null!=a?a:l.current,c=aS(e=>{var t,a,i;return o?(t=o.messageId,a=o.claimIndex,null==(i=e.verifications[t])?void 0:i.claims.get(a)):void 0}),d=o?o.claimIndex+1:0,u=(null==c?void 0:c.currentProbability)!==void 0?Math.round(100*c.currentProbability):null,m=(null==c?void 0:c.currentPrediction)===!0,p=(null==c?void 0:c.currentPrediction)===void 0;return(0,i.jsx)(a9.cj,{open:n,onOpenChange:e=>!e&&s(),children:(0,i.jsx)(a9.yd,{children:(0,i.jsxs)(a6.UC,{className:"bg-surface-secondary ease-spring data-[state=closed]:animate-out data-[state=open]:animate-in data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right absolute bottom-0 right-0 top-[var(--app-banner-height,0px)] z-50 w-[400px] shadow-lg transition data-[state=closed]:duration-500 data-[state=open]:duration-500","aria-label":"Claim Analysis",children:[(0,i.jsx)(a6.hE,{className:"sr-only",children:"Claim Analysis"}),c&&(0,i.jsxs)("div",{className:"flex h-full flex-col gap-4 overflow-y-auto p-3",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(r.PageSearch,{className:"text-text-secondary size-5 shrink-0"}),(0,i.jsxs)("span",{className:"text-text-tertiary ml-1.5 font-mono text-sm leading-4",children:["CLAIM ",d]}),(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)("button",{onClick:()=>s(),"aria-label":"Close",className:"bg-surface-tertiary shrink-0 rounded-md p-1",children:(0,i.jsx)(r.XIcon,{className:"text-text-secondary size-4"})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"text-text-tertiary font-mono text-xs leading-4",children:"SUMMARY OF CLAIM"}),(0,i.jsx)("p",{className:"text-primary mt-[6px] text-sm leading-4",children:null!=(t=c.summary)?t:c.text})]}),(0,i.jsxs)("div",{className:"bg-surface-tertiary flex items-center gap-1 rounded-md p-2",children:[m?(0,i.jsx)(r.CheckCircle,{className:"text-interactive-positive size-4"}):(0,i.jsx)(r.XCircle,{className:"text-interactive-negative size-4"}),!p&&null!==u&&(0,i.jsxs)("span",{className:(0,_.cn)("text-xs leading-4",{"text-interactive-positive":m,"text-interactive-negative":!m}),children:[u,"% Likely ",m?"True":"False"]}),(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsxs)("div",{className:"bg-surface-secondary inline-flex items-center gap-1 rounded-3xl p-1",children:[(0,i.jsx)(el.D,{organization:"google",className:"size-3"}),(0,i.jsx)(el.D,{organization:"anthropic",className:"size-3"}),(0,i.jsx)(el.D,{organization:"openai",className:"size-3"})]})]}),Array.from(c.verifications.entries()).map(e=>{let[t,a]=e;return(0,i.jsx)(a8,{verification:a},t)})]})]})})})}function ie(e){var t;let{claim:a,claimIndex:s,clickPos:n,onClose:o,onOpenAnalysis:c}=e,d=(0,g.useRef)({getBoundingClientRect:()=>DOMRect.fromRect({x:n.x,y:n.y,width:0,height:0})}),u=void 0!==a.currentProbability?Math.round(100*a.currentProbability):null,m=!0===a.currentPrediction,p=void 0===a.currentPrediction;return(0,i.jsxs)(eU.AM,{open:!0,onOpenChange:e=>!e&&o(),children:[(0,i.jsx)(eU.dT,{virtualRef:d}),(0,i.jsxs)(eU.hl,{side:"top",sideOffset:28,collisionPadding:8,className:"border-border-faint bg-surface-secondary flex flex-col gap-3 rounded-lg border p-3 shadow-lg",style:{width:300,animationDuration:"0s"},children:[(0,i.jsxs)("div",{className:"bg-surface-tertiary flex items-center gap-1 rounded-md p-2",children:[m?(0,i.jsx)(r.CheckCircle,{className:"text-interactive-positive size-4"}):(0,i.jsx)(r.XCircle,{className:"text-interactive-negative size-4"}),!p&&null!==u&&(0,i.jsxs)("span",{className:(0,_.cn)("text-xs leading-4",{"text-interactive-positive":m,"text-interactive-negative":!m}),children:[u,"% Likely ",m?"True":"False"]}),(0,i.jsx)("div",{className:"flex-1"}),(0,i.jsx)(it,{})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,i.jsx)("span",{className:"text-text-tertiary text-xs leading-4",children:"SUMMARY OF CLAIM"}),(0,i.jsx)("p",{className:"text-text-primary text-base leading-5",children:null!=(t=a.summary)?t:a.text})]}),(0,i.jsxs)(l.Button,{variant:"primary",className:"mt-1 w-full gap-2",onClick:()=>{c(s),o()},children:[(0,i.jsx)(r.PageSearch,{className:"size-4"}),(0,i.jsx)("p",{className:"text-sm leading-4",children:"See analysis"})]})]})]})}function it(){return(0,i.jsxs)("div",{className:"bg-surface-secondary inline-flex items-center gap-1 rounded-3xl p-1",children:[(0,i.jsx)(el.D,{organization:"google",className:"size-3"}),(0,i.jsx)(el.D,{organization:"anthropic",className:"size-3"}),(0,i.jsx)(el.D,{organization:"openai",className:"size-3"})]})}let ia=new Set(["code","pre","script","style"]);function ii(e){let{ownership:t}=e;return e=>{0!==t.length&&function e(a){if("element"===a.type&&ia.has(a.tagName))return;let i=[],s=!1;for(let c of a.children)if("text"===c.type){var r,n,l,o;let e=null==(n=c.position)||null==(r=n.start)?void 0:r.offset,a=null==(o=c.position)||null==(l=o.end)?void 0:l.offset;if(void 0===e||void 0===a){i.push(c);continue}let d=!1;for(let i=e;i<a&&i<t.length;i++)if(-1!==t[i]){d=!0;break}if(!d){i.push(c);continue}i.push(...function(e){var t,a;let{node:i,ownership:s,startOff:r,endOff:n}=e,l=[],o=0,c=r<s.length&&null!=(t=s[r])?t:-1;for(let e=r;e<=n;e++){let t=e-r,d=e<n?e<s.length&&null!=(a=s[e])?a:-1:-2;if(d!==c){let e=i.value.slice(o,t);e&&(-1===c?l.push({type:"text",value:e}):l.push({type:"element",tagName:"span",properties:{dataClaimIdx:String(c)},children:[{type:"text",value:e}]})),o=t,c=d}}return l}({node:c,ownership:t,startOff:e,endOff:a})),s=!0}else c.children&&e(c),i.push(c);s&&(a.children=i)}(e)}}let is=(0,g.memo)(e=>{var t;let{content:a,messageId:s,className:r}=e,n=aS(e=>{var t;return null==(t=e.verifications[s])?void 0:t.claims}),l=aS(e=>{var t;return null==(t=e.verifications[s])?void 0:t.status}),[o,c]=(0,g.useState)(null),[d,u]=(0,g.useState)(null),m=(0,g.useRef)(null),p=(0,g.useRef)({x:0,y:0}),h=(0,g.useMemo)(()=>n&&0!==n.size?Array.from(n.values()).sort((e,t)=>e.index-t.index):[],[n]),f=(0,g.useMemo)(()=>0===h.length?new Int16Array(0):function(e,t){let a=new Int16Array(e).fill(-1);for(let i of[...t].sort((e,t)=>t.charEnd-t.charStart-(e.charEnd-e.charStart))){let t=Math.max(0,Math.min(i.charStart,e)),s=Math.max(t,Math.min(i.charEnd,e));for(let e=t;e<s;e++)a[e]=i.index}return a}(a.length,h),[a,h]),x=(0,g.useMemo)(()=>{let e=[[aM.A,{displayMode:!0,throwOnError:!1,errorColor:"#cc0000"}]];return f.length>0&&e.push([ii,{ownership:f}]),e},[f]),v=(0,g.useCallback)((e,t)=>{p.current={x:t.clientX,y:t.clientY},c(t=>t===e?null:e)},[]),b=(0,g.useCallback)(e=>{let t=e.target.closest("[data-claim-idx]");t&&m.current&&m.current.querySelectorAll('[data-claim-idx="'.concat(t.dataset.claimIdx,'"]')).forEach(e=>e.classList.add("claim-hovered"))},[]),y=(0,g.useCallback)(e=>{let t=e.target.closest("[data-claim-idx]");t&&m.current&&m.current.querySelectorAll('[data-claim-idx="'.concat(t.dataset.claimIdx,'"]')).forEach(e=>e.classList.remove("claim-hovered"))},[]),w=null!==o&&null!=(t=null==n?void 0:n.get(o))?t:null;return(0,i.jsxs)("div",{ref:m,onMouseOver:b,onMouseOut:y,className:(0,_.cn)("prose prose-sm prose-pre:bg-transparent prose-pre:p-0 prose-ol:list-inside prose-ul:list-inside relative text-wrap break-words",r),children:[(0,i.jsx)("style",{children:'\n[data-claim-status="true"].claim-hovered { background-color: rgba(158,209,160,0.9); }\n[data-claim-status="false"].claim-hovered { background-color: rgba(233,164,160,0.9); }\n[data-claim-status="pending"].claim-hovered { background-color: rgba(161,161,170,0.4); }\n'}),(0,i.jsx)(aR.oz,{remarkPlugins:[a5.A,aD.A,[aO.A,{singleDollarTextMath:!0}]],rehypePlugins:x,components:{code:aV.Hd,table:a3.Or,th:a3.zH,td:a3.UQ,span:e=>{let{children:t,node:a,...s}=e,r=s["data-claim-idx"];if(void 0!==r){let e=Number(r),a=null==n?void 0:n.get(e),s="complete"===l,c=s&&a?function(e){return void 0===e.currentPrediction?"pending":e.currentPrediction?"true":"false"}(a):"pending",d=o===e;return(0,i.jsx)(ir,{status:c,isActive:d,isComplete:s,claimIndex:e,onClick:t=>v(e,t),children:t})}return(0,i.jsx)("span",{...s,children:t})}},children:a}),w&&null!==o&&(0,i.jsx)(ie,{claim:w,claimIndex:o,clickPos:p.current,onClose:()=>c(null),onOpenAnalysis:e=>{u({messageId:s,claimIndex:e})}}),(0,i.jsx)(a7,{analysisSidebar:d,onClose:()=>u(null)})]})});function ir(e){let{status:t,isActive:a,isComplete:s,claimIndex:r,onClick:n,children:l}=e,o="pending"===t,c=s&&!o;return(0,i.jsx)("span",{"data-claim-idx":r,"data-claim-status":t,role:c?"button":void 0,tabIndex:c?0:void 0,onClick:c?n:void 0,onKeyDown:c?e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),n(e))}:void 0,className:(0,_.cn)("rounded-sm px-0.5 py-px",c?"cursor-pointer":"cursor-default",{"bg-[rgba(158,209,160,0.7)]":"true"===t&&!a,"bg-[rgba(158,209,160,0.9)] ring-1 ring-[rgba(158,209,160,1)]":"true"===t&&a,"bg-[rgba(233,164,160,0.7)]":"false"===t&&!a,"bg-[rgba(233,164,160,0.9)] ring-1 ring-[rgba(233,164,160,1)]":"false"===t&&a,"bg-[rgba(161,161,170,0.28)]":o}),children:l})}function il(e){let{status:t}=e;switch(t){case"completed":return(0,i.jsx)(r.CheckCircle,{className:"h-3.5 w-3.5 shrink-0 text-green-500"});case"in_progress":return(0,i.jsx)("div",{className:"h-3.5 w-3.5 shrink-0 animate-spin rounded-full border-2 border-blue-500 border-t-transparent"});default:return(0,i.jsx)("div",{className:"h-3.5 w-3.5 shrink-0 rounded-full border-2 border-gray-300"})}}is.displayName="FactualityMarkdown";let io=(0,g.memo)(function(e){let{plan:t,isStreamComplete:a=!1,className:s}=e,n=function(e,t){let a=(0,g.useRef)([]),[i,s]=(0,g.useState)(()=>e.map(e=>e.status));return(0,g.useEffect)(()=>{let i=a.current,r=e.map(e=>e.status);if(t)for(let e=0;e<r.length;e++)"completed"!==r[e]&&(r[e]="completed");let n=[];for(let e=0;e<r.length;e++)"completed"===r[e]&&"completed"!==i[e]&&n.push(e);if(n.length<2){s(r),a.current=r;return}let l=[...r];for(let e of n){var o;l[e]=null!=(o=i[e])?o:"pending"}s(l);let c=[];return n.forEach((e,t)=>{let a=setTimeout(()=>{s(t=>{let a=[...t];return a[e]="completed",a})},(t+1)*200);c.push(a)}),a.current=r,()=>c.forEach(clearTimeout)},[e,t]),i}(t,a);return 0===t.length?null:(0,i.jsxs)("div",{className:(0,_.cn)("border-border-faint overflow-hidden rounded-md border",s),children:[(0,i.jsxs)("div",{className:"border-border-faint flex items-center gap-2 border-b px-3 py-2",children:[(0,i.jsx)(r.ClipboardList,{className:"text-text-secondary h-4 w-4"}),(0,i.jsx)("span",{className:"text-text-secondary text-sm font-medium",children:"Plan"})]}),(0,i.jsx)("div",{className:"p-2",children:t.map((e,t)=>{var a;return(0,i.jsxs)("div",{className:"flex items-center gap-2 rounded px-1 py-1",children:[(0,i.jsx)(il,{status:null!=(a=n[t])?a:e.status}),(0,i.jsx)("span",{className:"text-text-secondary text-sm",children:e.step})]},t)})})]})}),ic=(0,g.memo)(function(e){let{toolCallInfo:t,className:a}=e;return(0,i.jsxs)("div",{className:(0,_.cn)("flex w-full items-center gap-2 py-1",a),children:[(0,i.jsx)("div",{children:(()=>{let e=t.toolName,a="h-4 w-4 text-text-secondary";switch(e){case"create_file":return(0,i.jsx)(r.FilePlus,{className:a});case"edit_file":case"apply_patch":return(0,i.jsx)(r.Pencil,{className:a});case"read_file":return(0,i.jsx)(r.Eye,{className:a});case"list_files":return(0,i.jsx)(r.List,{className:a});case"delete_file":return(0,i.jsx)(r.Trash,{className:a});case"install_npm_packages":case"deploy_project":return(0,i.jsx)(r.Package,{className:a});case"build_project":return(0,i.jsx)(r.Hammer,{className:a});case"shell_command":return(0,i.jsx)(r.Terminal,{className:a});case"update_plan":return(0,i.jsx)(r.ClipboardList,{className:a});default:return(0,i.jsx)(r.ChevronRight,{className:a})}})()}),(0,i.jsx)(ai,{duration:1,spread:2,className:"text-sm",children:(()=>{var e,a,i,s,r;switch(t.toolName){case"create_file":return"Creating ".concat(null!=(e=t.args.path)?e:"file");case"edit_file":return"Editing ".concat(null!=(a=t.args.path)?a:"file");case"read_file":return"Reading ".concat(null!=(i=t.args.path)?i:"file");case"list_files":return"Listing files";case"delete_file":return"Deleting ".concat(null!=(s=t.args.path)?s:"file");case"install_npm_packages":return"Installing npm packages: ".concat(null!=(r=t.args.packages)?r:"packages");case"build_project":return"Building project";case"deploy_project":return"Deploying project";case"apply_patch":{let e=t.args.input.split("\n"),a="file";for(let t of e){if(t.startsWith("+++ ")){a=t.substring(4).replace(/^b\//,"").trim();break}if(t.startsWith("*** Update File: ")||t.startsWith("*** Add File: ")){let e=t.startsWith("*** Update File: ")?"*** Update File: ":"*** Add File: ";a=t.substring(e.length).trim();break}if(t.startsWith("--- ")&&!t.includes("/dev/null")){a=t.substring(4).replace(/^a\//,"").trim();break}}return"Applying patch to ".concat(a)}case"shell_command":return"Running command";case"update_plan":return"Updating plan";default:return"Executing tool call"}})()}),(0,i.jsx)(r.Loader2,{className:"text-text-secondary h-3 w-3 animate-spin"})]})});function id(e){return null!==e&&"object"==typeof e&&"type"in e&&"text"===e.type}function iu(e){return null!==e&&"object"==typeof e&&"type"in e&&"tool-call"===e.type}function im(e){return null!==e&&"object"==typeof e&&"type"in e&&"tool-result"===e.type}function ip(e){let t=[],a=[],i=[];return e.forEach(e=>{"string"==typeof e?i.push(e):iu(e)?t.push(e):im(e)?a.push(e):id(e)&&i.push(e.text||"")}),{toolCalls:t,toolResults:a,textContent:i}}var ih=a(10744),ig=a.n(ih),ix=a(96137);function iv(e){let{code:t,language:a,operation:i}=e,[s,r]=(0,g.useState)(""),[n,l]=(0,g.useState)(!1),{resolvedTheme:o}=(0,ak.D)();return(0,g.useEffect)(()=>{let e=!1;return async function(){if(!t)return r("");l(!0);try{let s=await (0,ix.pY)(t,a,"dark"===o?"github-dark":"github-light",i);e||r(s)}catch(a){if(console.error("Error highlighting diff code:",a),!e){let e=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),a="create"===i?"add":"delete"===i?"remove":"add",s=e.split("\n").map(e=>'<span class="line diff '.concat(a,'">').concat(e,"</span>")).join("\n");r('<pre class="shiki-code-block has-diff"><code>'.concat(s,"</code></pre>"))}}finally{e||l(!1)}}(),()=>{e=!0}},[t,a,i,o]),{highlightedHtml:s,isHighlighting:n}}var ib=a(53392);let iy=(0,g.memo)(function(e){let{oldCode:t,newCode:a,language:s,className:r}=e,{highlightedHtml:n,isHighlighting:l}=iv({code:[...t.length>0?t.split("\n").map(e=>"-".concat(e)):[],...a.length>0?a.split("\n").map(e=>"+".concat(e)):[]].join("\n"),language:s,operation:"update"});return l?(0,i.jsx)("div",{className:(0,_.cn)("max-h-96 overflow-y-auto font-mono text-[11px]",r),children:(0,i.jsx)("div",{className:"text-muted-foreground flex items-center justify-center p-4",children:"Loading..."})}):n?(0,i.jsx)("div",{className:(0,_.cn)(ig().container,"max-h-96 overflow-y-auto font-mono text-[11px]",r),dangerouslySetInnerHTML:{__html:n}}):(0,i.jsx)("div",{className:(0,_.cn)("max-h-96 overflow-y-auto font-mono text-[11px]",r),children:(0,i.jsx)("div",{className:"text-muted-foreground flex items-center justify-center p-4",children:"No content available"})})});var iw=a(32722);let ij={js:"vscode-icons:file-type-js",mjs:"vscode-icons:file-type-js",cjs:"vscode-icons:file-type-js",jsx:"vscode-icons:file-type-reactjs",ts:"vscode-icons:file-type-typescript",mts:"vscode-icons:file-type-typescript",cts:"vscode-icons:file-type-typescript",tsx:"vscode-icons:file-type-reactts",html:"vscode-icons:file-type-html",css:"vscode-icons:file-type-css",scss:"vscode-icons:file-type-scss",sass:"vscode-icons:file-type-sass",less:"vscode-icons:file-type-less",json:"vscode-icons:file-type-json",yaml:"vscode-icons:file-type-yaml",yml:"vscode-icons:file-type-yaml",toml:"vscode-icons:file-type-toml",xml:"vscode-icons:file-type-xml",md:"vscode-icons:file-type-markdown",mdx:"vscode-icons:file-type-mdx",txt:"vscode-icons:file-type-text",svg:"vscode-icons:file-type-svg",png:"vscode-icons:file-type-image",jpg:"vscode-icons:file-type-image",jpeg:"vscode-icons:file-type-image",gif:"vscode-icons:file-type-image",webp:"vscode-icons:file-type-image",ico:"vscode-icons:file-type-image",avif:"vscode-icons:file-type-image",env:"vscode-icons:file-type-dotenv",gitignore:"vscode-icons:file-type-git",lock:"vscode-icons:file-type-lock",sh:"vscode-icons:file-type-shell",bash:"vscode-icons:file-type-shell",zsh:"vscode-icons:file-type-shell"},iN={"package.json":"vscode-icons:file-type-npm","package-lock.json":"vscode-icons:file-type-npm","pnpm-lock.yaml":"vscode-icons:file-type-pnpm","yarn.lock":"vscode-icons:file-type-yarn","tsconfig.json":"vscode-icons:file-type-tsconfig","jsconfig.json":"vscode-icons:file-type-jsconfig","vite.config.ts":"vscode-icons:file-type-vite","vite.config.js":"vscode-icons:file-type-vite","vite.config.mts":"vscode-icons:file-type-vite","tailwind.config.js":"vscode-icons:file-type-tailwind","tailwind.config.ts":"vscode-icons:file-type-tailwind","postcss.config.js":"vscode-icons:file-type-postcss","postcss.config.mjs":"vscode-icons:file-type-postcss",".gitignore":"vscode-icons:file-type-git",".env":"vscode-icons:file-type-dotenv",".env.local":"vscode-icons:file-type-dotenv",".env.development":"vscode-icons:file-type-dotenv",".env.production":"vscode-icons:file-type-dotenv",".eslintrc":"vscode-icons:file-type-eslint",".eslintrc.js":"vscode-icons:file-type-eslint",".eslintrc.json":"vscode-icons:file-type-eslint","eslint.config.js":"vscode-icons:file-type-eslint","eslint.config.mjs":"vscode-icons:file-type-eslint",".prettierrc":"vscode-icons:file-type-prettier",".prettierrc.js":"vscode-icons:file-type-prettier",".prettierrc.json":"vscode-icons:file-type-prettier","prettier.config.js":"vscode-icons:file-type-prettier","prettier.config.mjs":"vscode-icons:file-type-prettier",Dockerfile:"vscode-icons:file-type-docker","docker-compose.yml":"vscode-icons:file-type-docker","docker-compose.yaml":"vscode-icons:file-type-docker","README.md":"vscode-icons:file-type-readme","readme.md":"vscode-icons:file-type-readme",LICENSE:"vscode-icons:file-type-license","LICENSE.md":"vscode-icons:file-type-license"},ik=e=>e.map(e=>({...e,children:ik(e.children)})).sort((e,t)=>e.isDirectory&&!t.isDirectory?-1:!e.isDirectory&&t.isDirectory?1:e.name.localeCompare(t.name));function iE(e,t){var a,s,r;let n=iN[e];if(n)return(0,i.jsx)(iw.In,{icon:n,className:(0,_.cn)("size-4 shrink-0",t)});let l=null!=(r=ij[null!=(s=null==(a=e.split(".").pop())?void 0:a.toLowerCase())?s:""])?r:"vscode-icons:default-file";return(0,i.jsx)(iw.In,{icon:l,className:(0,_.cn)("size-4 shrink-0",t)})}function iA(e,t){return e?(0,i.jsx)(r.FolderOpen,{className:(0,_.cn)("text-foreground size-4 shrink-0",t)}):(0,i.jsx)(r.Folder,{className:(0,_.cn)("text-foreground size-4 shrink-0",t)})}var iC=a(5476);let i_=Error("Message failed to build");function iB(e){var t;let{data:a,error:i}=(0,iC.useQuery)({...tw(null!=(t=null==e?void 0:e.id)?t:""),retry:!1,enabled:(null==e?void 0:e.status)===s.nH.SUCCESS});return(null==e?void 0:e.status)===s.nH.FAILED?{data:void 0,error:i_}:{data:a,error:i}}function iT(e){var t;let{data:a=!1}=(0,iC.useQuery)({...tw(null!=(t=null==e?void 0:e.id)?t:""),select:e=>{switch(e.status){case"success":case"pending":return!1;case"build-error":return!0}},retry:!1,enabled:(null==e?void 0:e.status)===s.nH.SUCCESS});return a||(null==e?void 0:e.status)===s.nH.FAILED}function iI(e){let{result:t}=e;return(0,i.jsx)("div",{className:"rounded-md border p-3",children:(0,i.jsx)("div",{className:"text-sm text-red-600",children:"string"==typeof t?t:JSON.stringify(t)})})}function iS(e){let{toolCallInfo:t}=e;if("edit_file"!==t.toolName&&"create_file"!==t.toolName)return null;let a="edit_file"===t.toolName?t.args.replacement:t.args.content,s="edit_file"===t.toolName?t.args.context:"";return(0,i.jsx)("div",{className:"border-border-faint overflow-hidden rounded-md border",children:(0,i.jsx)(iy,{newCode:a,oldCode:s,language:(0,ib.sQ)(t.args.path)})})}function iR(e){let{toolCallInfo:t}=e;if("install_npm_packages"!==t.toolName)return null;let{packages:a}=t.args;return(0,i.jsx)("div",{className:"border-border-faint overflow-hidden rounded-md border",children:(0,i.jsx)("div",{className:"no-scrollbar max-h-64 overflow-y-auto p-2",children:a.map(e=>(0,i.jsxs)("div",{className:"flex items-center gap-2 rounded px-1 py-1 hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[(0,i.jsx)(r.Package,{className:"h-4 w-4 text-red-500"}),(0,i.jsx)("span",{className:"text-text-secondary select-none text-sm",children:e})]},e))})})}let iM=(0,g.memo)(function e(t){let{node:a,depth:s=0}=t,[n,l]=(0,g.useState)(s<1),o=a.path.replace(/[^a-zA-Z0-9]/g,"-").replace(/-+/g,"-").slice(0,32),c="file-tree-".concat(o,"-").concat((0,_.YZ)(a.path)),d=(0,_.cn)("flex items-center gap-2 rounded px-1 py-1 hover:bg-surface-secondary"),u={paddingLeft:"".concat(16*s+4,"px")};return(0,i.jsxs)("div",{children:[a.isDirectory?(0,i.jsxs)("button",{type:"button",className:(0,_.cn)(d,"w-full cursor-pointer text-left focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-1"),style:u,onClick:()=>{a.isDirectory&&l(!n)},"aria-expanded":n,"aria-controls":c,children:[(0,i.jsx)(r.ChevronRight,{className:(0,_.cn)("h-3 w-3 text-gray-400 transition-transform",n&&"rotate-90")}),a.isDirectory?iA(n):iE(a.name),(0,i.jsx)("span",{className:"text-text-secondary select-none text-sm",children:a.name})]}):(0,i.jsxs)("div",{className:d,style:u,children:[(0,i.jsx)("span",{className:"w-3"}),a.isDirectory?iA(n):iE(a.name),(0,i.jsx)("span",{className:"text-text-secondary select-none text-sm",children:a.name})]}),a.isDirectory&&(0,i.jsx)("div",{id:c,role:"group",hidden:!n,children:n&&a.children.map(t=>(0,i.jsx)(e,{node:t,depth:s+1},t.path))})]})});function iD(e){var t,a;let{toolCallInfo:s}=e;if("list_files"!==s.toolName||(null==(t=s.result)?void 0:t.status)!=="success")return null;let r=null!=(a=s.result.files)?a:[],n=function(e){let t=[];for(let i of e){let e=i.path.split("/").filter(e=>!!e),s=t;for(let t=0;t<e.length;t++){var a;let i=null!=(a=e[t])?a:"",r=t===e.length-1,n=e.slice(0,t+1).join("/"),l=s.find(e=>e.name===i);l||(l={name:i,path:n,isDirectory:!r,children:[]},s.push(l)),r||(l.isDirectory=!0,s=l.children)}}return ik(t)}(r);return 0===r.length?(0,i.jsx)("div",{className:"rounded-md border p-3",children:(0,i.jsx)("div",{className:"text-text-secondary text-sm",children:"No files in project"})}):(0,i.jsx)("div",{className:"border-border-faint overflow-hidden rounded-md border",children:(0,i.jsx)("div",{className:"no-scrollbar overflow-y-auto p-2",children:n.map(e=>(0,i.jsx)(iM,{node:e},e.path))})})}function iO(e){let{toolCallInfo:t}=e;if("apply_patch"!==t.toolName)return null;let a=t.args.input.split("\n"),s=t.args.input.trimStart().startsWith("*** Begin Patch"),r="",n=[];for(let e of a){if(s){if(e.startsWith("*** Begin Patch")||e.startsWith("*** End Patch")||e.startsWith("*** Update File:")||e.startsWith("*** Add File:")||e.startsWith("*** Delete File:")||e.startsWith("*** Move to:")||e.startsWith("*** End of File")||e.startsWith("@@")){if(!r&&(e.startsWith("*** Update File: ")||e.startsWith("*** Add File: "))){let t=e.startsWith("*** Update File: ")?"*** Update File: ":"*** Add File: ";r=e.substring(t.length).trim()}continue}}else{if(e.startsWith("+++ ")){r=e.substring(4).replace(/^b\//,"").trim();continue}if(e.startsWith("--- ")||e.startsWith("@@"))continue}(e.startsWith("+")||e.startsWith("-")||e.startsWith(" "))&&n.push(e)}let l=n.join("\n"),o=r?(0,ib.sQ)(r):"plaintext";return(0,i.jsx)(iP,{code:l,language:o})}function iP(e){let{code:t,language:a}=e,{highlightedHtml:s,isHighlighting:r}=iv({code:t,language:a,operation:"update"});return r?(0,i.jsx)("div",{className:"border-border-faint overflow-hidden rounded-md border",children:(0,i.jsx)("div",{className:"max-h-96 overflow-y-auto font-mono text-[11px]",children:(0,i.jsx)("div",{className:"text-muted-foreground flex items-center justify-center p-4",children:"Loading..."})})}):s?(0,i.jsx)("div",{className:"border-border-faint overflow-hidden rounded-md border",children:(0,i.jsx)("div",{className:(0,_.cn)(ig().container,"max-h-96 overflow-y-auto font-mono text-[11px]"),dangerouslySetInnerHTML:{__html:s}})}):(0,i.jsx)("div",{className:"border-border-faint overflow-hidden rounded-md border",children:(0,i.jsx)("div",{className:"max-h-96 overflow-y-auto font-mono text-[11px]",children:(0,i.jsx)("div",{className:"text-muted-foreground flex items-center justify-center p-4",children:"No content available"})})})}function iz(e){let{toolCallInfo:t}=e;if("shell_command"!==t.toolName)return null;let a=t.result,s=(null==a?void 0:a.status)==="success"||(null==a?void 0:a.status)==="error"?a.stdout:void 0,r=(null==a?void 0:a.status)==="success"||(null==a?void 0:a.status)==="error"?a.stderr:void 0;return(0,i.jsx)("div",{className:"border-border-faint overflow-hidden rounded-md border",children:(0,i.jsxs)("div",{className:"no-scrollbar max-h-64 overflow-y-auto p-3 font-mono text-xs",children:[(0,i.jsxs)("div",{className:"text-text-tertiary mb-1",children:["$ ",t.args.command]}),s&&(0,i.jsx)("pre",{className:"text-text-secondary whitespace-pre-wrap",children:s}),r&&(0,i.jsx)("pre",{className:"whitespace-pre-wrap text-red-500",children:r})]})})}let iL=(0,g.memo)(function(e){var t,a,s,n;let{toolCallInfo:l,className:o,message:c}=e,[d,u]=(0,g.useState)(!1),[,m]=tn(),[,p]=tr(),[,h]=tc(),f=(0,S.d)("md"),x=(null==(t=l.result)?void 0:t.status)==="error",{data:v}=iB(null!=c?c:null),b=null!=(s=null==v?void 0:v.files)?s:[],y=e=>{if(e.stopPropagation(),c){let e=c.parentMessageIds[0];p(c.participantPosition,"message",e),f&&h(!0)}(()=>{var e,t,a;if("edit_file"===l.toolName&&(null==(e=l.result)?void 0:e.status)==="success"){let e=l.args.replacement,t=b.find(e=>e.path===l.args.path),i=null!=(a=null==t?void 0:t.content)?a:"",s=i.indexOf(e);if(-1!==s){let t=i.substring(0,s).split("\n").length,a=t+e.split("\n").length-1;m({mode:"code",path:l.args.path,highlightStart:t,highlightEnd:a},"message")}else m({mode:"code",path:l.args.path},"message")}else if((null==(t=l.result)?void 0:t.status)==="success")switch(l.toolName){case"create_file":case"read_file":case"delete_file":m({mode:"code",path:l.args.path},"message");break;case"edit_file":case"list_files":case"install_npm_packages":case"build_project":case"deploy_project":case"shell_command":case"update_plan":m({mode:"code"},"message");break;case"apply_patch":{let e;for(let t of l.args.input.split("\n")){if(t.startsWith("+++ ")){e=t.substring(4).replace(/^b\//,"").trim();break}if(t.startsWith("*** Update File: ")||t.startsWith("*** Add File: ")){let a=t.startsWith("*** Update File: ")?"*** Update File: ":"*** Add File: ";e=t.substring(a.length).trim();break}}e?m({mode:"code",path:e},"message"):m({mode:"code"},"message")}}else m({mode:"code"},"message")})()},w=(()=>{var e,t,a,i;if(x)return!1;if("edit_file"===l.toolName)return l.args.replacement.length+l.args.context.length>0;if("create_file"===l.toolName)return l.args.content.length>0;if("install_npm_packages"===l.toolName)return l.args.packages.length>0;if("list_files"===l.toolName)return(null==(e=l.result)?void 0:e.status)==="success"&&(null!=(a=null==(t=l.result.files)?void 0:t.length)?a:0)>0;if("apply_patch"===l.toolName)return l.args.input.length>0;if("shell_command"===l.toolName){let e=l.result;return(null==e?void 0:e.status)==="success"&&!!(null!=(i=e.stdout)?i:e.stderr)}return!1})(),j={success:{icon:(0,i.jsx)(r.CheckCircle,{className:"h-3 w-3"}),color:"text-green-500",label:"Success"},error:{icon:(0,i.jsx)(r.XCircle,{className:"h-3 w-3"}),color:"text-red-500",label:"Error"}},N=x?j.error:j.success,k=(()=>{var e;if((null==(e=l.result)?void 0:e.status)!=="success")return null;if("edit_file"===l.toolName){let e=l.args.context,t=l.args.replacement,a=e.split("\n").length;return{added:t.split("\n").length,removed:a}}if("apply_patch"===l.toolName){let e=0,t=0;for(let a of l.args.input.split("\n"))!(a.startsWith("+++")||a.startsWith("---")||a.startsWith("*** ")||a.startsWith("@@"))&&(a.startsWith("+")?e++:a.startsWith("-")&&t++);if(e>0||t>0)return{added:e,removed:t}}return null})(),E=()=>{let e="h-4 w-4 text-text-secondary group-hover:text-text-primary transition-colors duration-200";switch(l.toolName){case"create_file":return(0,i.jsx)(r.FilePlus,{className:e});case"edit_file":case"apply_patch":return(0,i.jsx)(r.Pencil,{className:e});case"read_file":return(0,i.jsx)(r.Eye,{className:e});case"list_files":return(0,i.jsx)(r.List,{className:e});case"delete_file":return(0,i.jsx)(r.Trash,{className:e});case"install_npm_packages":case"deploy_project":return(0,i.jsx)(r.Package,{className:e});case"build_project":return(0,i.jsx)(r.Hammer,{className:e});case"shell_command":return(0,i.jsx)(r.Terminal,{className:e});case"update_plan":return(0,i.jsx)(r.ClipboardList,{className:e});default:return(0,i.jsx)(r.ChevronRight,{className:e})}},A=()=>{var e,t,a,s;if((null==(e=l.result)?void 0:e.status)==="error")switch(l.toolName){case"create_file":return"Creating ".concat(l.args.path," failed");case"edit_file":return"Editing ".concat(l.args.path," failed");case"read_file":return"Reading ".concat(l.args.path," failed");case"list_files":return"Listing files failed";case"delete_file":return"Deleting ".concat(l.args.path," failed");case"install_npm_packages":return"Installing npm packages failed";case"build_project":return"Building the project failed";case"deploy_project":return"Deploying the project failed";case"apply_patch":return"Applying patch failed";case"shell_command":{let e=l.args.command,t=e.length>50?"".concat(e.slice(0,50),""):e;return"Running ".concat(t," failed")}case"update_plan":return"Updating plan failed";default:return"Tool call failed"}switch(l.toolName){case"create_file":return"Created ".concat(l.args.path);case"edit_file":return"Edited ".concat(l.args.path);case"read_file":return"Read ".concat(l.args.path);case"list_files":return"Listed ".concat(null!=(s=null==(a=l.result)||null==(t=a.files)?void 0:t.length)?s:""," files");case"delete_file":return"Deleted ".concat(l.args.path);case"install_npm_packages":{let e=l.args.packages.length;return"Installed ".concat(e," ").concat(1===e?"package":"packages")}case"build_project":return"Built the project";case"deploy_project":return"Deployed the project";case"apply_patch":{let e=l.args.input.split("\n"),t="file";for(let a of e){if(a.startsWith("+++ ")){t=a.substring(4).replace(/^b\//,"").trim();break}if(a.startsWith("*** Update File: ")||a.startsWith("*** Add File: ")){let e=a.startsWith("*** Update File: ")?"*** Update File: ":"*** Add File: ";t=a.substring(e.length).trim();break}}return"Applied patch to ".concat(t)}case"shell_command":{let e=l.args.command,t=e.length>50?"".concat(e.slice(0,50),""):e;return(0,i.jsxs)(i.Fragment,{children:["Ran ",(0,i.jsx)("code",{className:"font-mono text-xs",children:t})]})}case"update_plan":return"Updated plan";default:return"Executed tool call"}};return w?(0,i.jsxs)(aK.Nt,{open:d,onOpenChange:e=>{u(e)},className:(0,_.cn)("leading-[1]",o),children:[(0,i.jsx)(aK.R6,{asChild:!0,children:(0,i.jsx)("button",{className:"group h-auto w-full justify-start px-0",children:(0,i.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{className:(0,_.cn)("transition-opacity duration-200",d?"hidden":"group-hover:hidden"),children:E()}),(0,i.jsx)("div",{className:(0,_.cn)("transition-opacity duration-200",d?"block":"hidden group-hover:block"),children:(0,i.jsx)(r.ChevronRight,{className:(0,_.cn)("text-text-secondary group-hover:text-text-primary h-4 w-4 transition-transform duration-200",d?"rotate-90":"rotate-0")})}),(0,i.jsx)("span",{className:(0,_.cn)("text-text-secondary text-sm transition-colors duration-200","group-hover:text-text-primary cursor-pointer"),onClick:x?void 0:e=>{e.stopPropagation(),u(!d)},children:A()}),(0,i.jsxs)("div",{className:(0,_.cn)("flex items-center gap-1 text-xs transition-colors",N.color),onClick:x?void 0:y,children:[!x&&(0,i.jsx)(r.ExternalLink,{className:"text-text-primary hidden h-3 w-3 group-hover:block"}),(0,i.jsx)("span",{className:(0,_.cn)(!x&&"group-hover:hidden"),children:N.icon})]}),k&&(0,i.jsxs)("div",{className:"text-text-tertiary ml-0.5 flex items-center gap-1 font-mono text-xs",children:[(0,i.jsxs)("span",{className:"text-green-600",children:["+",k.added]}),(0,i.jsxs)("span",{className:"text-red-600",children:["-",k.removed]})]})]}),(0,i.jsx)("div",{className:"flex-1"})]})})}),(0,i.jsx)(aK.Ke,{children:(0,i.jsx)("div",{className:"mt-2 space-y-3",children:(null==(a=l.result)?void 0:a.status)==="error"?(0,i.jsx)(iI,{result:l.result.message}):"list_files"===l.toolName?(0,i.jsx)(iD,{toolCallInfo:l}):"apply_patch"===l.toolName?(0,i.jsx)(iO,{toolCallInfo:l}):"shell_command"===l.toolName?(0,i.jsx)(iz,{toolCallInfo:l}):(n=l.toolName)&&["create_file","edit_file","read_file","list_files","delete_file","apply_patch"].includes(n)?(0,i.jsx)(iS,{toolCallInfo:l}):"install_npm_packages"===l.toolName?(0,i.jsx)(iR,{toolCallInfo:l}):null})})]}):(0,i.jsx)("div",{className:(0,_.cn)("leading-[1]",o),children:(0,i.jsx)("div",{className:"flex w-full items-center gap-2",children:(0,i.jsxs)("div",{className:(0,_.cn)("group flex items-center gap-2",!x&&"cursor-pointer"),onClick:x?void 0:y,children:[E(),(0,i.jsx)("span",{className:(0,_.cn)("text-text-secondary text-sm transition-colors duration-200",!x&&"group-hover:text-text-primary cursor-pointer group-hover:underline"),children:A()}),(0,i.jsxs)("div",{className:(0,_.cn)("flex items-center gap-1 text-xs transition-colors",N.color),children:[!x&&(0,i.jsx)(r.ExternalLink,{className:"text-text-primary hidden h-3 w-3 group-hover:block"}),(0,i.jsx)("span",{className:(0,_.cn)(!x&&"group-hover:hidden"),children:N.icon})]}),k&&(0,i.jsxs)("div",{className:"text-text-tertiary ml-0.5 flex items-center gap-1 font-mono text-xs",children:[(0,i.jsxs)("span",{className:"text-green-600",children:["+",k.added]}),(0,i.jsxs)("span",{className:"text-red-600",children:["-",k.removed]})]})]})})})});function iU(e){var t,a;let{message:r,isCollapsed:n=!1,contentHeight:l=null}=e,{hasError:o,contentString:c,reasoningText:d,shouldShowErrorOnly:u}=ae(r),m=r.role===s.PG.USER,p=(0,N.g)(e=>e.modality),h=null!=(t=null==r?void 0:r.sources)?t:[],g=(0,tg.KL)((0,A._P)("factuality-demo")),f=aS(e=>g?e.verifications[r.id]:void 0),x=Array.isArray(r.content)&&ip(r.content).toolCalls.length>0,v=c.length>0||x,b=r.status===s.nH.PENDING&&!v;if(u){let e=p===s.Jg.WEBDEV&&r.failureReason===as.Bt?as.Bt:void 0;return(0,i.jsx)(a4,{errorMessage:e})}if(p===s.Jg.SEARCH&&!m)return(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,i.jsx)(aB,{sources:h,isComplete:r.status!==s.nH.PENDING}),(0,i.jsx)(aq,{id:r.id,content:c,sources:h,isComplete:r.status!==s.nH.PENDING}),(0,i.jsx)(ay,{message:r}),o&&(0,i.jsx)(a4,{})]});if(p===s.Jg.WEBDEV&&Array.isArray(r.content)&&!m){let{toolResults:e}=ip(r.content),t=new Map;e.forEach(e=>{t.set(e.toolCallId,e)});let c=new Set,u=[],m=r.content,p=null,h=new Set;for(let e of m)if(iu(e)&&"update_plan"===e.toolName){h.add(e.toolCallId);let i=e7.VM.safeParse({toolName:e.toolName,toolCallId:e.toolCallId,args:e.args,result:null==(a=t.get(e.toolCallId))?void 0:a.result});i.success&&"update_plan"===i.data.toolName&&(p=i.data.args.plan)}else im(e)&&h.has(e.toolCallId);let g=m.findIndex(e=>im(e)||iu(e)&&t.has(e.toolCallId)),f=(e,t,a)=>(0,i.jsx)("div",{className:(0,_.cn)("overflow-hidden transition-all duration-300 ease-in-out"),style:a?{maxHeight:"0px",marginTop:"-0.75rem"}:{maxHeight:l?"".concat(l+800,"px"):"9999px"},children:t},e);return m.forEach((e,a)=>{var s;let l=iu(e)||im(e)?e.toolCallId:"string"==typeof e?"string-".concat(a):id(e)?"text-".concat(a):"unknown-".concat(a),d=n&&-1!==g&&a>g;if(iu(e)&&h.has(e.toolCallId))return void c.add(e.toolCallId);if(!(im(e)&&h.has(e.toolCallId))){if("string"==typeof e&&e.trim())u.push(f(l,(0,i.jsx)(aT.A,{id:"".concat(r.id,"-").concat(l),content:e}),d));else if(id(e)&&(null==(s=e.text)?void 0:s.trim()))u.push(f(l,(0,i.jsx)(aT.A,{id:"".concat(r.id,"-").concat(l),content:e.text}),d));else if(iu(e)){let a=t.get(e.toolCallId);if(c.add(e.toolCallId),a){let t=e7.VM.safeParse({toolName:e.toolName,toolCallId:e.toolCallId,args:e.args,result:a.result});t.success?u.push(f(l,(0,i.jsx)(iL,{toolCallInfo:t.data,message:r}),d)):u.push((0,i.jsx)(a4,{errorMessage:'Failed to parse tool call info for "'.concat(e.toolName,'"')},l))}else if(!o){let t=e7.VM.safeParse({toolCallId:e.toolCallId,toolName:e.toolName,args:e.args});t.success?u.push(f(l,(0,i.jsx)(ic,{toolCallInfo:t.data}),d)):u.push((0,i.jsx)(a4,{errorMessage:'Failed to parse tool call info for "'.concat(e.toolName,'"')},l))}}}}),(0,i.jsxs)("div",{className:(0,_.cn)("flex flex-col","gap-3"),children:[d&&(0,i.jsxs)(a0,{isStreaming:b,defaultOpen:r.status===s.nH.PENDING,isReasoningComplete:v,reasoningText:d,children:[(0,i.jsx)(a1,{}),(0,i.jsx)(a2,{children:d})]}),p&&(0,i.jsx)(io,{plan:p,isStreamComplete:r.status!==s.nH.PENDING}),u,(0,i.jsx)(ay,{message:r}),o&&(0,i.jsx)(a4,{errorMessage:r.failureReason===as.Bt?as.Bt:void 0})]})}return(0,i.jsxs)(i.Fragment,{children:[!m&&d&&(0,i.jsxs)(a0,{isStreaming:b,defaultOpen:r.status===s.nH.PENDING,isReasoningComplete:v,reasoningText:d,children:[(0,i.jsx)(a1,{}),(0,i.jsx)(a2,{children:d})]}),null!=f?(0,i.jsx)(is,{messageId:r.id,content:c}):(0,i.jsx)(aT.A,{id:r.id,content:c}),(0,i.jsx)(ay,{message:r}),o&&!m&&(0,i.jsx)(a4,{})]})}function iF(e){let{message:t,messageLayoutMode:a,shouldShowGeneratingText:n,messageRef:o,contentRef:c,isScrollable:d,checkOverflow:u,hasOverflow:m,scrollToBottom:p}=e,h=(0,S.d)("md"),g=(0,N.g)(e=>e.isPredictingModality),f=(0,N.g)(e=>e.modality),x=(0,N.g)(e=>e.isFastModeInProgress),v=f===s.Jg.VIDEO?"max-h-[1240px] overflow-y-auto":"max-h-[max(50svh,350px)] overflow-y-auto";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,_.cn)("no-scrollbar relative flex w-full flex-1 flex-col overflow-x-auto transition-[max-height] duration-300",{[v]:d,"border-border-faint border-t":"container"===a}),ref:o,onScroll:u,children:(0,i.jsx)("div",{className:(0,_.cn)("min-w-0",{"p-3":"container"===a}),ref:c,children:g?(0,i.jsx)(ai,{className:"text-sm",children:"Thinking..."}):n?(0,i.jsx)(ai,{className:"text-sm",children:x?"Using faster models...":"Generating..."}):(0,i.jsx)(iU,{message:t})})}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:h?"from-surface-primary via-surface-primary/90 pointer-events-none absolute bottom-0 left-0 h-20 w-full rounded-b-2xl bg-gradient-to-t to-transparent":"from-surface-primary via-surface-primary/80 pointer-events-none absolute bottom-0 left-0 h-16 w-full rounded-b-2xl bg-gradient-to-t to-transparent"}),(0,i.jsx)("div",{className:"pointer-events-none absolute bottom-3 left-0 flex w-full justify-center",children:(0,i.jsx)(l.Button,{className:h?"pointer-events-auto size-8 transition-all duration-200 hover:scale-105":"bg-surface-secondary/90 hover:bg-surface-secondary border-border-faint/50 pointer-events-auto size-8 rounded-lg border shadow-lg backdrop-blur-sm transition-all duration-200 hover:scale-105 hover:shadow-xl",size:"icon",variant:"ghost",onClick:p,children:(0,i.jsx)(r.ArrowDown,{size:h?18:16})})})]})]})}function iG(e){let t=(0,N.g)(e=>e.messages);return(0,g.useMemo)(()=>{let a="a"===e.participantPosition?"b":"a";return t.some(t=>t.role===s.PG.ASSISTANT&&t.participantPosition===a&&t.parentMessageIds[0]===e.parentMessageIds[0])},[e.participantPosition,e.parentMessageIds,t])}var iH=a(39587),iV=a(45809),iW=a(73566),iY=a(19919);function iJ(){return"undefined"!=typeof navigator&&"share"in navigator&&"canShare"in navigator}async function iq(e,t,a,i,s,r){let n,l="data:".concat(r,"/");try{let m=function(e,t,a,i,s){var r,n,l;let o=(i?tJ(i):"").substring(0,20).replace(/\s+/g,"_"),c=null!=(l=null==(n=e.contentType)||null==(r=n.split("/")[1])?void 0:r.split(";")[0])?l:iQ(s),d=t.participantPosition,u="".concat(d,"_").concat(o,".").concat(c);return a&&(u="".concat(a,"_").concat(u)),u}(e,t,a,i,r);if(n=e.url.startsWith(l)?"base64":"url",iY.un&&iJ()){var o;let t="".concat(r,"/").concat(iQ(r)),a=await iX(e.url,m,null!=(o=e.contentType)?o:t,r);await i$(a,e.url)}else{var c=await iZ(e.url,r),u=m;let t=document.createElement("a");t.href=c,t.download=u,document.body.appendChild(t),t.click(),document.body.removeChild(t)}"image"===r&&d.z.capture({action:"image_download",params:{message_id:t.id,user_id:s,status:"success",image_type:n}}),d.z.capture({action:"media_download",params:{message_id:t.id,user_id:s,status:"success",media_type:r,source_type:n}})}catch(a){if(iY.un&&a instanceof Error&&"AbortError"===a.name)return void console.info("User cancelled share sheet - no action taken");console.error("Error downloading ".concat(r,":"),a),window.open(e.url,"_blank"),"image"===r&&d.z.capture({action:"image_download",params:{status:"error",image_type:n,message_id:t.id,user_id:s}}),d.z.capture({action:"media_download",params:{status:"error",media_type:r,source_type:n,message_id:t.id,user_id:s}})}}function iQ(e){switch(e){case"video":return"mp4";case"audio":return"mp3";default:return"png"}}function iK(e){return"/nextjs-api/proxy/media?url=".concat(encodeURIComponent(e))}async function iX(e,t,a,i){var s,r,n;let l="data:".concat(i,"/");if(("video"===i||"audio"===i)&&!e.startsWith(l)){let i=iK(e),s=await fetch(i);if(!s.ok)throw Error("Failed to fetch media for sharing");return new File([await s.blob()],t,{type:null!=(r=s.headers.get("content-type"))?r:a,lastModified:Date.now()})}let[o,c=""]=(await iZ(e,i)).split(","),d=null!=(n=null==o||null==(s=o.match(/:(.*?);/))?void 0:s[1])?n:a,u=atob(c),m=new Uint8Array(u.length);for(let e=0;e<u.length;e++)m[e]=u.charCodeAt(e);return new File([new Blob([m],{type:d})],t,{type:d,lastModified:Date.now()})}async function iZ(e,t){if(e.startsWith("data:".concat(t,"/")))return e;if("image"===t){let{getProxyImage:t}=await a.e(79111).then(a.bind(a,79111)),i=await t(e);if(!i.success)throw Error("Failed to fetch image through proxy");return i.data}return"video"===t||"audio"===t?iK(e):e}async function i$(e,t){navigator.canShare&&navigator.canShare({files:[e]})?await navigator.share({files:[e]}):await navigator.share({url:t})}var i0=a(1447),i1=a(52283);function i2(e){return e.findIndex(e=>e.file.type.startsWith("video/"))}function i4(e){let{message:t}=e,[a,s]=(0,h.fp)(Y.A),n=t2(),o=(0,m.kH)(e=>e.userId),{mode:c,modality:u}=(0,N.g)((0,k.k)(e=>({mode:e.mode,modality:e.modality}))),p=(0,g.useMemo)(()=>{var e;return null==(e=t.experimental_attachments)?void 0:e.find(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("video/")})},[t.experimental_attachments]),x=(0,g.useMemo)(()=>!!(null==p?void 0:p.url)&&a.some(e=>e.uploadedUrl===p.url),[a,null==p?void 0:p.url]),v=(0,g.useMemo)(()=>i2(a),[a]),b=n&&-1===v,y=(0,g.useCallback)(()=>{if(!x&&p&&!b){d.z.capture({action:"edit_video_button_clicked",params:{user_id:o,message_id:t.id,current_attachments_count:a.length}});try{var e,i;let t=null!=(e=p.contentType)?e:"video/mp4",a=new Blob([],{type:t}),r=new File([a],null!=(i=p.name)?i:"video.mp4",{type:t}),n=tB(p),l={file:r,preview:n,isAlreadyUploaded:!0,uploadedUrl:p.url};s(e=>(function(e,t){let a=i2(e);return -1===a?[...e,t]:e.map((e,i)=>i===a?t:e)})(e,l))}catch(e){f.oR.error("Failed to add video to chat")}}},[x,p,b,o,t.id,a.length,s]);return x?(0,i.jsxs)(l.Button,{variant:"outline",size:"sm",className:"border-interactive-positive h-6 cursor-not-allowed gap-1 bg-green-500/10 px-1.5 py-0",disabled:!0,children:[(0,i.jsx)(r.Check,{size:12,className:"text-interactive-positive"}),(0,i.jsx)("span",{className:"text-interactive-positive text-xs font-medium leading-none",children:"Added"})]}):!p||b||u!==i1.EEvaluationModality.VIDEO||c!==i1.EChatMode.BATTLE?(0,i.jsxs)(l.Button,{variant:"outline",size:"sm",className:"h-6 cursor-not-allowed gap-1 px-1.5 py-0 opacity-50",disabled:!0,children:[(0,i.jsx)(r.Pencil,{size:12}),(0,i.jsx)("span",{className:"text-xs font-medium leading-none",children:"Edit"})]}):(0,i.jsxs)(l.Button,{variant:"outline",size:"sm",className:"h-6 gap-1 px-1.5 py-0",onClick:y,children:[(0,i.jsx)(r.Pencil,{size:12}),(0,i.jsx)("span",{className:"text-interactive-normal text-xs font-medium leading-none",children:"Edit"})]})}function i5(e){let{messageId:t,messageContent:a}=e,{checkFactuality:s}=function(){let{startVerification:e,addClaim:t,updateSummary:a,updateVerification:i,updateAggregation:s,setExtractionComplete:r,setStatus:n,setError:l}=aS();return{checkFactuality:(0,g.useCallback)(async(o,c)=>{e(o);try{let e=await fetch("/nextjs-api/factuality/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:c})});if(!e.ok||!e.body)return void l(o,"HTTP error ".concat(e.status));let u=e.body.getReader(),m=new TextDecoder,p="",h=null;for(;;){var d;let{done:e,value:c}=await u.read();if(e)break;let g=(p+=m.decode(c,{stream:!0})).split("\n");for(let e of(p=null!=(d=g.pop())?d:"",g))if(e.startsWith("event: "))h=e.slice(7).trim();else if(e.startsWith("data: ")&&h){let c=JSON.parse(e.slice(6));switch(h){case"claim_extracted":void 0!==c.char_start&&void 0!==c.char_end&&t(o,{index:c.claim_index,text:c.claim,charStart:c.char_start,charEnd:c.char_end,verifications:new Map});break;case"verification_complete":i({messageId:o,claimIndex:c.claim_index,verifierIndex:c.verifier_index,verification:{output:c.output,reason:c.reason,verifierName:c.verifier_name,sources:c.sources},currentPrediction:c.current_prediction,currentProbability:c.current_probability});break;case"aggregation_complete":s({messageId:o,claimIndex:c.claim_index,prediction:c.prediction,probability:c.probability});break;case"extraction_complete":if(r(o),0===c.total_claims)return void l(o,"No verifiable claims found");break;case"summarize_complete":a(o,c.claim_index,c.summary);break;case"complete":n(o,"complete");break;case"error":console.warn("[factuality] error: ".concat(c.error_type," claim=#").concat(c.claim_index," verifier=#").concat(c.verifier_index))}h=null}}let g=aS.getState().verifications[o];(null==g?void 0:g.status)==="loading"&&n(o,"complete")}catch(e){l(o,e instanceof Error?e.message:"An error occurred")}},[e,t,a,i,s,r,n,l])}}(),n=aS(e=>{var a;return null==(a=e.verifications[t])?void 0:a.status}),o=aS(e=>{var a;return null==(a=e.verifications[t])?void 0:a.error}),c="loading"===n,d="error"===n;return(0,i.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>void s(t,a),disabled:c||"complete"===n||d,className:(0,_.cn)("relative overflow-hidden","bg-surface-tertiary border-border-medium h-7 gap-1.5 rounded-md border px-2",d?"text-interactive-negative":"text-interactive-active","hover:bg-surface-raised-alt transition-colors duration-150"),children:[c&&(0,i.jsx)("span",{className:"pointer-events-none absolute inset-0 -translate-x-full",style:{background:"linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.08) 40%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.08) 60%, transparent 100%)",animation:"verify-shimmer 1.5s ease-in-out infinite"}}),(0,i.jsx)("style",{children:"\n        @keyframes verify-shimmer {\n          0% { transform: translateX(-100%); }\n          100% { transform: translateX(100%); }\n        }\n      "}),(0,i.jsx)(r.PageSearch,{className:(0,_.cn)("size-3.5",d?"text-interactive-negative":"text-interactive-active")}),(0,i.jsx)("span",{className:"text-xs leading-4",children:d?null!=o?o:"Verification failed":c?"Verifying...":"Verify claims"})]})}var i3=a(98103);let i6=(0,at.createServerReference)("60d8b20c62901136abdb6e1d98b4142299acd92a61",at.callServer,void 0,at.findSourceMapURL,"createPairwiseFeedback");var i9=a(50282);function i8(){let e=(0,N.g)((0,k.k)(e=>({id:e.id,mode:e.mode,modality:e.modality,messages:e.messages,setIsVoteSubmitting:e.setIsVoteSubmitting,addPairwiseFeedback:e.addPairwiseFeedback,deletePairwiseFeedback:e.deletePairwiseFeedback,updatePairwiseFeedbackModels:e.updatePairwiseFeedbackModels,resetViewedWebDevPreviews:e.resetViewedWebDevPreviews,resetViewedVideos:e.resetViewedVideos}))),{modelAId:t,modelBId:a}=(0,L.g)(e=>e),i=(0,m.kH)(e=>e.userId),r=(0,i9.yF)((e,t,a)=>{var i;return null!=(i=e(Y.I)[a])?i:0}),n=(0,A._P)("disable-turnstile-voting"),l=(0,tg.KL)(n);return{handlePairwiseFeedbackSubmit:(0,g.useCallback)(async(n,o,c,u,m)=>{if(null!=c&&null!=u)try{var p,h,g,x,v;e.setIsVoteSubmitting(!0);let b={evaluationSessionId:e.id,messageAId:c,messageBId:u,modelAId:null!=t?t:void 0,modelBId:null!=a?a:void 0,value:n,didInspectBothMobileHorizontalResponses:m},y=e.messages.find(e=>e.id===c),w=e.messages.find(e=>e.id===u),j=y?e.messages.find(e=>e.id===y.parentMessageIds[0]):void 0,N=w?e.messages.find(e=>e.id===w.parentMessageIds[0]):void 0,k=(null==j?void 0:j.id)===(null==N?void 0:N.id)?null!=(p=null==j?void 0:j.experimental_attachments)?p:[]:[...null!=(h=null==j?void 0:j.experimental_attachments)?h:[],...null!=(g=null==N?void 0:N.experimental_attachments)?g:[]],E=k.map(e=>t_(e.contentType)),A=tI(k);if(e.modality===s.Jg.VIDEO){let t=r(c),a=r(u);d.z.capture({action:"video_chat_vote",params:{mode:e.mode,user_id:i,modality:e.modality,video_loop_count_a:t,video_loop_count_b:a,attachment_type:E.length>0?E:void 0,file_count:A}})}d.z.capture({action:"chat_vote",params:{mode:e.mode,user_id:i,modality:e.modality,attachment_type:E.length>0?E:void 0,file_count:A}}),e.mode===s.lY.BATTLE&&(null==(v=window)||null==(x=v.gtag)||x.call(v,"event","conversion_event_default"));let{id:C}=e.addPairwiseFeedback(b),_=null;if(!l)try{_=await o.challenge(),null==_&&console.error("Failed to get turnstile token")}catch(e){console.error("Turnstile challenge failed")}let B=null;try{B=await (0,tG.ic)("pairwise_feedback")}catch(e){console.error("Failed to get recaptcha v3 token")}d.z.capture({action:"chat_vote_turnstile_success",params:{mode:e.mode,user_id:i,modality:e.modality}});let T=await i6({...b,turnstileToken:_,recaptchaV3Token:B});if(!T.success)throw e.deletePairwiseFeedback(C),f.oR.error("Failed to submit feedback"),Error("Failed to submit pairwise feedback");e.updatePairwiseFeedbackModels({pairwiseFeedbackId:C,modelAId:T.data.modelAId,modelBId:T.data.modelBId}),d.z.capture({action:"chat_vote_success",params:{mode:e.mode,user_id:i,modality:e.modality,arenaId:T.data.arenaId}})}finally{e.resetViewedWebDevPreviews(),e.resetViewedVideos(),e.setIsVoteSubmitting(!1)}},[e,i,t,a,r,l])}}function i7(){let{handlePairwiseFeedbackSubmit:e}=i8(),t=(0,N.g)(e=>e.setLeftVoteHoverState),a=(0,N.g)(e=>e.setRightVoteHoverState),i=(0,i3.bj)(e=>e),[s,r]=(0,N.g)(e=>e.lastMessageIds),n=()=>{t(null),a(null)};return{handleVote:t=>{e(t,i,s,r),n()},createIndividualVoteHandlers:e=>({handleMouseEnter:()=>{e===th.BQ.a?t("win"):a("win")},handleMouseLeave:n}),createTieVoteHandlers:()=>{let e="bothbad";return{handleTieMouseEnter:()=>{t("tie"),a("tie")},handleBothBadMouseEnter:()=>{t(e),a(e)},handleMouseLeave:n}}}}var se=a(25634);function st(e){var t,a;let{message:s}=e,[n,o]=(0,g.useState)(!1),[c,u]=(0,g.useState)(0),m=(0,g.useRef)(null),p=(0,A._P)("p2l-release"),h=(0,se.D)(p),f=(0,g.useMemo)(()=>{var e;return(null==s||null==(e=s.metadata)?void 0:e.routedModelOrganization)?s.metadata.routedModelOrganization:null},[null==s||null==(a=s.metadata)?void 0:a.routedModelOrganization]);return(0,g.useEffect)(()=>{m.current&&u(n?m.current.scrollHeight:0)},[n]),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsxs)(l.Button,{variant:"ghost",onClick:()=>{!1===n&&d.z.capture({action:"smart_router_reveal_toggled",params:{evaluation_session_id:s.evaluationSessionId,organization:null!=f?f:"",smart_router_name:h}}),o(!n)},className:"xs:max-w-full flex h-auto min-w-0 max-w-[250px] items-center justify-start gap-1 p-0 font-mono text-sm font-normal hover:bg-transparent",children:[(0,i.jsx)(el.D,{variant:"colored",className:"mr-2 size-4 flex-shrink-0",organization:"boss-bandit"}),(0,i.jsx)("span",{className:"truncate",children:"Max"}),(0,i.jsx)(r.ChevronDown,{className:(0,_.cn)("size-3 flex-shrink-0 transition-transform duration-200",n&&"rotate-180")})]}),(0,i.jsx)("div",{className:"overflow-hidden transition-all duration-200 ease-out",style:{height:c,opacity:+!!n},children:(0,i.jsxs)("div",{ref:m,className:"flex items-center gap-1 pt-2",children:[(0,i.jsx)("p",{className:"text-tertiary line-clamp-1 text-xs leading-4",children:"Response provided by"}),f&&(0,i.jsx)(el.D,{organization:f,className:"size-3",variant:"colored"}),(0,i.jsx)("p",{className:"line-clamp-1 text-xs leading-4",children:f?null!=(t=el.B[f])?t:f:"Unknown"})]})})]})}function sa(e,t){let a=t.find(t=>t.id===e.pairwiseFeedbackId);return null==a?null:a.value===s.sb.TIE?"tie":a.value===s.sb.BOTH_BAD?"bothbad":e.participantPosition===th.BQ.a?a.value===s.sb.MODEL_A?"win":"lose":a.value===s.sb.MODEL_B?"win":"lose"}function si(e){return(0,N.g)(t=>(0,X.co)(t).includes(e.id)?e.participantPosition===th.BQ.a?t.leftVoteHoverState:t.rightVoteHoverState:null)}function ss(e){let{message:t}=e,a=sa(t,(0,N.g)(e=>e.pairwiseFeedbacks)),s=si(t);return null!=a?null:(0,i.jsxs)("div",{className:"pointer-events-none absolute right-2 top-2 flex size-6 items-center justify-center",children:[(0,i.jsx)(r.Handshake,{size:16,className:(0,_.cn)("absolute opacity-0 transition-opacity duration-300",{"opacity-100":"tie"===s})}),(0,i.jsx)(r.Trophy,{size:16,className:(0,_.cn)("absolute opacity-0 transition-opacity duration-300",{"opacity-100":"win"===s})}),(0,i.jsx)(r.ThumbsDown,{size:16,className:(0,_.cn)("absolute opacity-0 transition-opacity duration-300",{"opacity-100":"bothbad"===s})})]})}function sr(){let e=(0,N.g)(e=>e.lastMessageIds),t=(0,N.g)(e=>e.messages),a=(0,g.useMemo)(()=>{let a=[];if(0===e.length)return a;let i=new Map;return e.forEach(e=>{let a=t.find(t=>t.id===e);if(null==a)throw Error("Message not found");i.set(a.participantPosition,a)}),a.push(i),!function e(t,a,i){let s=new Set;a.forEach(e=>{e.parentMessageIds.forEach(e=>{s.add(e)})});let r=new Map;return(t.forEach(e=>{s.has(e.id)&&r.set(e.participantPosition,e)}),0===r.size)?null:(i.push(r),e(t,r,i))}(t,i,a),a},[e,t]),i=(0,g.useMemo)(()=>{var e,t;return Array.from(null!=(t=null==a||null==(e=a[0])?void 0:e.values())?t:[])},[a]),r=(0,g.useMemo)(()=>{var e,t;return Array.from(null!=(t=null==a||null==(e=a.find(e=>{var t,a;return(null==(t=e.get("a"))?void 0:t.role)===s.PG.ASSISTANT||(null==(a=e.get("b"))?void 0:a.role)===s.PG.ASSISTANT}))?void 0:e.values())?t:[])},[a]);return(0,g.useMemo)(()=>({messageThreads:a,latestMessages:i,latestAssistantMessages:r}),[a,i,r])}function sn(){let{messageThreads:e}=sr(),t=e[0],a=null==t?void 0:t.get("a"),i=null==t?void 0:t.get("b"),s=iT(null!=a?a:null),r=iT(null!=i?i:null),[n,l]=(0,N.g)((0,k.k)(e=>[e.isVoteSubmitting,e.viewedWebDevPreviews]));return(0,g.useMemo)(()=>{if(n)return!1;let e=s||(null==a?void 0:a.id)!=null&&l.includes(a.id),t=r||(null==i?void 0:i.id)!=null&&l.includes(i.id);return e&&t},[n,l,null==a?void 0:a.id,null==i?void 0:i.id,s,r])}function sl(e){let[t,a,i,r]=(0,N.g)((0,k.k)(e=>[e.viewedWebDevPreviews,e.pairwiseFeedbacks,e.mode,e.lastMessageIds])),n=iT(e);return(0,g.useMemo)(()=>!(i!==s.lY.BATTLE||n||null==e||e.status!==s.nH.SUCCESS||t.includes(e.id))&&!!r.includes(e.id)&&a.every(t=>t.id!==e.pairwiseFeedbackId),[i,e,t,a,n,r])}function so(e){let[,t]=tr(),[,a]=tn(),[,i]=tc(),s=(0,S.d)("md"),r=e.parentMessageIds[0];return(0,g.useCallback)(()=>{t(e.participantPosition,"message",r),a({mode:"preview"},"message"),s&&i(!0)},[s,e.participantPosition,r,i,t,a])}let sc=(0,g.forwardRef)((e,t)=>{let{message:a,model:r,className:n,setRenderExpandedMessage:l}=e,{messageLayoutMode:o}=al(),c=(0,N.g)(e=>e.isVoteSubmitting),d=(0,N.g)(e=>e.modality),u=(0,N.g)(e=>e.mode),m=(0,L.g)(e=>e.models),p=iG(a),h=t9(a,m,p&&u===s.lY.DIRECT_BATTLE?"Response":"Assistant"),g=null!==si(a),[f,x]=tr(),[,v]=tn(),[,b]=tc(),y=(0,S.d)("md"),w=to(f),j=d===s.Jg.WEBDEV&&(null==w?void 0:w.id)===a.id,k=()=>{if(d!==s.Jg.WEBDEV)return;let e=a.parentMessageIds[0];x(a.participantPosition,"message",e),v({mode:"preview"}),y&&b(!0)},E=d===s.Jg.WEBDEV;return(0,i.jsxs)("div",{ref:t,role:E?"button":void 0,tabIndex:E?0:void 0,onClick:E?k:void 0,onKeyDown:E?e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),k())}:void 0,className:(0,_.cn)("bg-surface-primary sticky top-0 flex w-full flex-none items-center justify-between gap-2",{"min-h-[76px] cursor-grab rounded-t-3xl border pt-8 active:cursor-grabbing md:min-h-[40px] md:rounded-t-xl md:pt-2":"drawer"===o,"min-h-[40px]":"container"===o,"py-2 pl-3 pr-2":"container"===o||"drawer"===o,"bg-surface-raised-alt":E&&j,"border-border border-b":"container"===o&&E,"focus-visible:ring-interactive-normal cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-inset":E},n),children:[(0,i.jsx)(ss,{message:a}),(0,i.jsx)("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:null==a.modelId&&c?(0,i.jsx)(iW.E,{className:"h-5 w-[100px]"}):E?(0,i.jsxs)("span",{className:(0,_.cn)("xs:max-w-full flex min-w-0 max-w-[250px] flex-1 items-center gap-2 text-left font-mono transition-colors","page"===o?"text-sm font-normal":"text-xs font-medium",j&&"opacity-100",!j&&"hover:opacity-80"),children:[a.status===s.nH.PENDING&&(0,i.jsx)(iH.R,{className:"h-5 w-5 flex-shrink-0 animate-spin"}),(0,i.jsxs)("span",{className:"flex min-w-0 items-center gap-1",children:[(null==r?void 0:r.organization)==null?null:(0,i.jsx)(el.D,{variant:"colored",className:(0,_.cn)("mr-2 flex-shrink-0","page"===o?"size-4":"size-3.5"),organization:r.organization}),(0,i.jsx)(sd,{message:a,models:m})]})]}):(0,i.jsxs)(i.Fragment,{children:[a.status===s.nH.PENDING&&(0,i.jsx)(iH.R,{className:"h-5 w-5 flex-shrink-0 animate-spin"}),function(e){var t;return(null==e||null==(t=e.metadata)?void 0:t.routedModelOrganization)!=null}(a)&&a.status===s.nH.SUCCESS&&!(p&&u===s.lY.DIRECT_BATTLE&&null==a.pairwiseFeedbackId)?(0,i.jsx)(st,{message:a}):(0,i.jsxs)("span",{className:(0,_.cn)("xs:max-w-full flex min-w-0 max-w-[250px] items-center gap-1 font-mono","page"===o?"text-sm font-normal":"text-xs font-medium"),children:[(null==r?void 0:r.organization)==null?null:(0,i.jsx)(el.D,{variant:"colored",className:(0,_.cn)("mr-2 flex-shrink-0","page"===o?"size-4":"size-3.5"),organization:r.organization}),(0,i.jsx)("span",{className:"truncate",children:h})]})]})}),"page"!==o&&(0,i.jsx)("div",{role:"presentation",onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),children:(0,i.jsx)(su,{className:(0,_.cn)({"pointer-events-none opacity-0":g,"opacity-100":!g}),message:a,setRenderExpandedMessage:l})})]})});function sd(e){let{message:t,models:a}=e,r=sl(t),n=t9(t,a,"Option");return t.status===s.nH.PENDING?(0,i.jsx)("span",{className:"truncate",children:n}):r?(0,i.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,i.jsx)("span",{children:n}),(0,i.jsx)("span",{className:"h-2 w-2 rounded-full bg-green-500"})]}):(0,i.jsx)("span",{className:"truncate",children:n})}function su(e){let{className:t,message:a,setRenderExpandedMessage:n}=e,{messageLayoutMode:o}=al(),c=(0,N.g)(e=>e.modality),d=(0,N.g)(e=>e.mode),u=(0,A._P)("video-edit"),p=(0,tg.KL)(u),[,h]=(0,i0.A)(),f=(0,N.g)(e=>e.messages),x=(0,N.g)(e=>e.lastMessageIds),{appendStream:v}=tY(),b=aS(e=>e.clearVerification),y=(0,A._P)("factuality-demo"),w=a.status===s.nH.PENDING,j=a.status===s.nH.FAILED,k=w||j,E=(0,g.useMemo)(()=>Array.isArray(a.content)?a.content.map(e=>"text"===e.type?e.text:"").join(""):a.content,[a.content]),C="drawer"!==o,B="drawer"===o,T=c!==s.Jg.IMAGE&&c!==s.Jg.VIDEO,I=(0,g.useMemo)(()=>{let e=x.some(e=>{let t=f.find(t=>t.id===e);return(null==t?void 0:t.pairwiseFeedbackId)!=null});return x.includes(a.id)&&!e&&!w&&C},[w,x,a.id,f,C]),S=(0,L.g)(e=>e.models),R=(0,g.useMemo)(()=>!a.modelId||S.some(e=>e.id===a.modelId),[S,a.modelId]),M=(0,g.useMemo)(()=>{var e,t;return null!=(t=a.role===s.PG.ASSISTANT&&(null==(e=a.experimental_attachments)?void 0:e.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("image")})))&&t},[a]),D=(0,g.useMemo)(()=>{var e,t;return null!=(t=a.role===s.PG.ASSISTANT&&(null==(e=a.experimental_attachments)?void 0:e.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("video")})))&&t},[a]),O=(0,g.useCallback)(()=>{null!=a.id&&(b(a.id),v(a.id))},[v,b,a.id]),{downloadMedia:P,shouldShowMediaDownloadButton:z}=function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image",i=(0,m.kH)(e=>e.userId),s=(0,N.g)(t=>t.messages.find(t=>t.id===e.parentMessageIds[0])),r=(0,L.g)(t=>t.models.find(t=>t.id===e.modelId)),n=(null==(t=e.experimental_attachments)?void 0:t.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith(a)}))&&(!iY.un||iJ());return{downloadMedia:(0,g.useCallback)(async()=>{e.experimental_attachments&&await Promise.all(e.experimental_attachments.map(async t=>{var n,l;(null==(n=t.contentType)?void 0:n.startsWith(a))&&await iq(t,e,null!=(l=null==r?void 0:r.name)?l:void 0,s,i,a)}))},[e,null==r?void 0:r.name,s,i,a]),shouldShowMediaDownloadButton:n}}(a,M?"image":D?"video":void 0),U=(0,g.useMemo)(()=>{let e=[],t=!M&&!D,o=c===s.Jg.WEBDEV&&[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(d);return I&&!a.pointwiseFeedbackId&&R&&!o&&e.push((0,i.jsx)(eZ.G,{content:"Retry",children:(0,i.jsx)(l.Button,{variant:"ghost",className:"size-3 rounded-md p-3",onClick:O,children:(0,i.jsx)(r.RefreshCw,{size:14})})},"retry")),C&&c===s.Jg.WEBDEV&&![s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(d)&&a.role===s.PG.ASSISTANT&&null!=a.participantPosition&&null==a.pairwiseFeedbackId&&e.push((0,i.jsx)(sm,{message:a},"webdev-vote-button-".concat(a.id))),!k&&c!==s.Jg.WEBDEV&&(z?(e.push((0,i.jsx)(eZ.G,{content:"Download",children:(0,i.jsx)(l.Button,{variant:"ghost",className:"size-3 rounded-md p-3",onClick:()=>void P(),children:(0,i.jsx)(r.Download,{size:14})})},"download")),c!==s.Jg.IMAGE||[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(d)||e.push((0,i.jsx)(t4,{message:a},"edit")),c===s.Jg.VIDEO&&d===s.lY.BATTLE&&p&&e.push((0,i.jsx)(i4,{message:a},"edit-video"))):t&&e.push((0,i.jsx)(eZ.G,{content:"Copy",children:(0,i.jsx)(iV.i,{variant:"ghost",className:"size-3 rounded-md p-3",size:14,onClick:()=>h(E)})},"copy")),(0,tg.KL)(y)&&[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(d)&&c===s.Jg.CHAT&&a.status===s.nH.SUCCESS&&a.role===s.PG.ASSISTANT&&e.push((0,i.jsx)(i5,{messageId:a.id,messageContent:E},"verify-claims")),C&&null!=n&&T&&e.push((0,i.jsx)(eZ.G,{content:"Expand",children:(0,i.jsx)(l.Button,{variant:"ghost",className:"size-3 rounded-md p-3",onClick:()=>n(!0),children:(0,i.jsx)(r.Maximize2,{size:14})})},"expand"))),C&&null!=n&&w&&T&&c!==s.Jg.WEBDEV&&e.push((0,i.jsx)(eZ.G,{content:"Expand",children:(0,i.jsx)(l.Button,{variant:"ghost",className:"size-3 rounded-md p-3",onClick:()=>n(!0),children:(0,i.jsx)(r.Maximize2,{size:14})})},"expand")),B&&null!=n&&e.push((0,i.jsx)(eZ.G,{content:"Close",children:(0,i.jsx)(l.Button,{variant:"ghost",className:"size-3 rounded-md p-3",onClick:()=>n(!1),children:(0,i.jsx)(r.X,{size:14})})},"close")),e},[T,d,h,P,y,M,D,B,w,k,R,a,E,c,C,O,n,z,I,p]);return(0,i.jsx)("div",{className:(0,_.cn)("text-text-primary flex items-center gap-2 transition-opacity duration-300",t),children:U})}function sm(e){let{message:t}=e,a=so(t),{handleVote:r}=i7(),n=sn(),o=t6(),c=t.participantPosition.toUpperCase(),d=o("".concat(c," is better"));return(0,i.jsx)(eZ.G,{content:n?"Vote for Option ".concat(c," and continue"):"View both previews to vote",wrapDisabled:!n,children:(0,i.jsx)(l.Button,{variant:"outline",size:"sm",className:(0,_.cn)("rounded-lg px-3 py-1 text-xs transition-colors","bg-surface-secondary/50","hover:bg-interactive-positive/12 hover:text-interactive-positive hover:border-interactive-positive"),onClick:()=>{r("a"===t.participantPosition?s.sb.MODEL_A:s.sb.MODEL_B),a()},disabled:!n,"aria-label":d,children:d})})}function sp(e){let{renderExpandedMessage:t,setRenderExpandedMessage:a,message:s}=e,r=(0,L.g)(e=>e.models),n=(0,g.useMemo)(()=>r.find(e=>s.modelId===e.id),[r,s.modelId]),l=iG(s),o=t9(s,r,l?"Response":"Assistant");return(0,i.jsxs)(eD._s,{open:t,onClose:()=>a(!1),children:[(0,i.jsxs)(eD.gk,{className:"hidden",children:["Message from ",o]}),(0,i.jsx)(eD.zj,{className:"h-[calc(100%-4rem)] rounded-t-3xl md:absolute md:h-full md:rounded-t-3xl md:p-2 md:pb-0",container:"undefined"==typeof document?void 0:document.getElementById(eQ),hideOverlay:!0,children:(0,i.jsxs)(an,{messageLayoutMode:"drawer",children:[(0,i.jsx)(sc,{message:s,model:n,setRenderExpandedMessage:a,selectedMessage:null}),(0,i.jsx)("div",{className:"bg-surface-primary md:border-border-faint h-full !select-text overflow-y-auto md:border-x",onPointerDownCapture:e=>{e.nativeEvent.stopImmediatePropagation()},children:(0,i.jsx)("div",{className:"grid w-full gap-4 p-2 md:mx-auto md:max-w-[640px]",children:(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsx)(iU,{message:s})})})})]})})]})}sc.displayName="MessageHeader";let sh=e=>{let{initialValue:t=null,onChange:a,className:n}=e,o=t===s.ut.UPVOTE,c=t===s.ut.DOWNVOTE,d=null!==t,u=e=>{d||null==a||a(e)},m="size-3 rounded-md p-3 transition-all";return(0,i.jsxs)(i.Fragment,{children:[!c&&(0,i.jsx)(eZ.G,{content:o?"Liked":"Like",children:(0,i.jsx)(l.Button,{variant:"ghost","aria-label":o?"Liked":"Like this response",className:(0,_.cn)(m,o&&"bg-green-500/10 hover:bg-green-500/10",!d&&"hover:bg-accent",d&&"cursor-default",n),onClick:()=>u(s.ut.UPVOTE),children:(0,i.jsx)(r.ThumbsUp,{size:14,className:(0,_.cn)("transition-colors",o&&"text-interactive-positive")})})}),!o&&(0,i.jsx)(eZ.G,{content:c?"Disliked":"Dislike",children:(0,i.jsx)(l.Button,{variant:"ghost","aria-label":c?"Disliked":"Dislike this response",className:(0,_.cn)(m,c&&"bg-red-500/10 hover:bg-red-500/10",!d&&"hover:bg-accent",d&&"cursor-default",n),onClick:()=>u(s.ut.DOWNVOTE),children:(0,i.jsx)(r.ThumbsDown,{size:14,className:(0,_.cn)("transition-colors",c&&"text-interactive-negative")})})})]})},sg=[0,.1,.2,.3,.4,.5,.6,.7,.8];function sf(e){let{className:t}=e;return(0,i.jsx)("svg",{className:(0,_.cn)("fill-current",t),viewBox:"0 0 ".concat(13," ").concat(13),xmlns:"http://www.w3.org/2000/svg",children:sg.map((e,t)=>{let a=Math.floor(t/3),s=t%3;return(0,i.jsx)("circle",{cx:1.5+5*s,cy:1.5+5*a,r:1.5,opacity:.2,children:(0,i.jsx)("animate",{attributeName:"opacity",values:"0.2;1;0.2",dur:"1.2s",begin:"".concat(e,"s"),repeatCount:"indefinite"})},t)})})}function sx(e){let{isActive:t,className:a,interval:s=100}=e,[r,n]=(0,g.useState)(0),l=(0,g.useRef)(null);(0,g.useEffect)(()=>{if(!t){n(0),l.current=null;return}l.current=Date.now();let e=setInterval(()=>{l.current&&n(Date.now()-l.current)},s);return()=>clearInterval(e)},[t,s]);let o=r/1e3,c=Math.floor(o/60),d=o%60,u=c>0?"".concat(c,"m ").concat(d.toFixed(1),"s"):"".concat(d.toFixed(1),"s");return(0,i.jsxs)("span",{className:(0,_.cn)("text-base font-normal",a),children:["(",u,")"]})}function sv(e){let{message:t,messageLayoutMode:a,shouldShowGeneratingText:n,messageRef:o}=e,[c,d]=(0,g.useState)(!1),u=t.status!==s.nH.PENDING&&o.current?o.current.scrollHeight:null,m=t.status!==s.nH.PENDING&&function(e){let t=Array.isArray(e.content)?ip(e.content):null;return!!t&&t.toolCalls.length>0}(t),p=m&&!c,h=m&&c,f=()=>{d(e=>!e)};return(0,i.jsx)("div",{className:(0,_.cn)("relative flex w-full flex-1 flex-col overflow-x-auto",{"border-border-faint border-t":"container"===a}),ref:o,children:(0,i.jsxs)("div",{className:(0,_.cn)("min-w-0",{"p-3":"container"===a}),children:[n?(0,i.jsx)(ai,{className:"text-sm",children:"Generating..."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(iU,{message:t,isCollapsed:p,contentHeight:u}),p&&(0,i.jsx)("div",{className:"flex justify-start pt-2",children:(0,i.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"text-text-tertiary flex items-center gap-1 p-0 text-sm hover:bg-transparent hover:opacity-100",onClick:f,children:["Show More ",(0,i.jsx)(r.ChevronDown,{size:16,className:"ml-1"})]})}),h&&(0,i.jsx)("div",{className:"flex justify-start pt-2",children:(0,i.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"text-text-tertiary flex items-center gap-1 px-0 py-1 text-sm hover:bg-transparent hover:opacity-100",onClick:f,children:["Show Less ",(0,i.jsx)(r.ChevronUp,{size:16,className:"ml-1"})]})})]}),t.status===s.nH.PENDING&&!n&&(0,i.jsxs)("div",{className:"flex items-center gap-1.5 pt-4",children:[(0,i.jsx)(sf,{className:"text-text-tertiary size-3"}),(0,i.jsx)(ai,{className:"text-xs",duration:1,children:"Building..."}),(0,i.jsx)(sx,{isActive:!0,className:"text-text-muted text-[9px] tabular-nums"})]})]})})}let sb="index.html",sy={PENDING:{statusText:"Building...",actionText:"Preview will be available soon"},ERROR:{statusText:"Something went wrong",actionText:"No preview available"},WINNER:{statusText:"",actionText:"Click to view"},LOSER:{statusText:"",actionText:"Click to view"},DONE:{statusText:"",actionText:"Click to view"}};function sw(e){let{message:t,onClick:a,voteStatus:n}=e,[o]=tr(),c=to(o),{data:d}=iB(null!=c?c:null),u=(null==c?void 0:c.id)===t.id,{RiveComponent:m}=(0,aN.useRive)({src:"/rive/building-loop.riv",autoplay:!0}),p=function(e,t,a){if(e.status===s.nH.PENDING)return{status:"pending",...sy.PENDING,tileClassName:"bg-surface-secondary border-border-faint",iconColor:"text-interactive-normal",icon:r.AppWindow,useRiveAnimation:!0};if(e.status===s.nH.FAILED||e.status===s.nH.FLAGGED)return{status:"error",...sy.ERROR,tileClassName:"bg-surface-secondary border-border-faint",iconColor:"text-interactive-normal",icon:r.Unlink};if(null!==t&&null!=e.pairwiseFeedbackId)return"win"===t||"tie"===t?{status:"winner",statusText:a,actionText:sy.WINNER.actionText,tileClassName:"bg-interactive-positive/10 border-interactive-positive",iconColor:"text-interactive-positive",icon:r.AppWindow}:"bothbad"===t?{status:"bothbad",statusText:a,actionText:sy.LOSER.actionText,tileClassName:"bg-interactive-negative/10 border-interactive-negative",iconColor:"text-interactive-negative",icon:r.AppWindow}:{status:"done",statusText:a,actionText:sy.DONE.actionText,tileClassName:"bg-interactive-link/10 border-interactive-link/30",iconColor:"text-interactive-link",icon:r.AppWindow};return{status:"done",statusText:a,actionText:sy.DONE.actionText,tileClassName:"bg-interactive-link/10 border-interactive-link/30",iconColor:"text-interactive-link",icon:r.AppWindow}}(t,n,(()=>{var e,t,a;let i=null!=(t=null==d?void 0:d.files)?t:[];return 0===i.length?sb:null!=(a=null==(e=i[0])?void 0:e.path)?a:sb})()),h=p.icon,g=t.status===s.nH.FAILED||t.status===s.nH.FLAGGED,f=t.status===s.nH.PENDING;return(0,i.jsx)("div",{className:"mx-3 my-3",children:(0,i.jsx)(l.Button,{variant:"ghost",className:"h-auto w-full p-0 hover:bg-transparent",onClick:()=>{g||null==a||a()},children:(0,i.jsx)("div",{className:(0,_.cn)("w-full rounded-lg border p-3 transition-colors",g?"cursor-not-allowed":"cursor-pointer",p.tileClassName,{"md:ring-text-secondary md:ring-2 md:ring-offset-2":u&&null===n&&f,"md:ring-interactive-link md:ring-2 md:ring-offset-2":u&&null===n&&!f}),children:(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(0,i.jsx)("div",{className:"bg-surface-primary flex h-10 w-10 items-center justify-center rounded-lg",children:p.useRiveAnimation?(0,i.jsx)(m,{className:"h-5 w-5"}):(0,i.jsx)(h,{className:(0,_.cn)("h-5 w-5",p.iconColor)})})}),(0,i.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col items-start justify-center",children:[(0,i.jsx)("div",{className:(0,_.cn)("mb-0 text-sm font-medium","error"===p.status?"text-text-tertiary":"text-text-primary"),children:p.statusText}),(0,i.jsx)("div",{className:"text-text-tertiary text-xs",children:p.actionText})]})]})})})})}function sj(e){let{message:t,selectedMessage:a,messageLayoutMode:n,className:o}=e,[c,u]=(0,g.useState)(!1),p=(0,g.useRef)(null),h=(0,g.useRef)(null),[x,v]=(0,g.useState)(!1),b=(0,L.g)(e=>e.models.find(e=>t.modelId===e.id)),y=(0,L.g)(e=>e.models),w=(0,N.g)(e=>e.modality),j=(0,N.g)(e=>e.mode),k=(0,N.g)(e=>e.pairwiseFeedbacks),E=(0,N.g)(e=>e.lastMessageIds.includes(t.id)),A=(0,N.g)(e=>e.messages),C=(0,N.g)(e=>e.lastMessageIds),{pointwiseFeedbackValue:B,handlePointwiseFeedback:T,showPointwiseFeedback:I}=function(e){let t=(0,N.g)(e=>e.mode),a=(0,N.g)(e=>e.modality),i=(0,N.g)(e=>e.addPointwiseFeedback),r=(0,N.g)(e=>e.deletePointwiseFeedback),n=(0,N.g)(e=>e.getPointwiseFeedbackById),l=(0,m.kH)(e=>e.userId),o=(0,N.g)(e=>e.messages),c=(0,g.useMemo)(()=>{var t,a;return e.pointwiseFeedbackId&&null!=(a=null==(t=n(e.pointwiseFeedbackId))?void 0:t.value)?a:null},[e.pointwiseFeedbackId,n]),u=e.status===s.nH.PENDING||e.status===s.nH.FAILED,p=(0,g.useMemo)(()=>!u&&(t===s.lY.DIRECT||t===s.lY.DIRECT_BATTLE&&1===o.filter(t=>t.parentMessageIds.some(t=>e.parentMessageIds.includes(t))).length&&null==e.pairwiseFeedbackId),[t,u,o,e]);return{pointwiseFeedbackValue:c,handlePointwiseFeedback:(0,g.useCallback)(async s=>{if(null==s||null==e.modelId||e.pointwiseFeedbackId)return;d.z.capture({action:"pointwise_feedback",params:{mode:t,user_id:l,modality:a,value:s,evaluation_session_id:e.evaluationSessionId}});let n=i({messageId:e.id,modelId:e.modelId,value:s}),o=null;try{o=await (0,tG.ic)("pointwise_feedback")}catch(e){}try{let i=await aa({messageId:e.id,value:s,recaptchaV3Token:o});if(!i.success)throw Error("Failed to submit pointwise feedback: ".concat(i.error));d.z.capture({action:"pointwise_feedback_success",params:{mode:t,user_id:l,modality:a,value:s,evaluation_session_id:e.evaluationSessionId}})}catch(e){r(n.id),f.oR.error("Error submitting feedback")}},[e.id,e.modelId,e.pointwiseFeedbackId,e.evaluationSessionId,i,r,t,l,a]),showPointwiseFeedback:p}}(t),{appendStream:R}=tY(),M=t.status===s.nH.PENDING,D=(0,g.useMemo)(()=>!t.modelId||y.some(e=>e.id===t.modelId),[y,t.modelId]),O=(0,g.useMemo)(()=>{let e=C.some(e=>{let t=A.find(t=>t.id===e);return(null==t?void 0:t.pairwiseFeedbackId)!=null});return C.includes(t.id)&&!e&&!M&&!t.pointwiseFeedbackId&&D},[C,t.id,t.pointwiseFeedbackId,A,M,D]),P=(0,g.useCallback)(()=>{null!=t.id&&R(t.id)},[R,t.id]),z=M||t.status===s.nH.FAILED,U=(0,g.useMemo)(()=>{var e,a;return null!=(a=null==(e=t.experimental_attachments)?void 0:e.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("image")}))&&a},[t.experimental_attachments]),F=w===s.Jg.IMAGE&&[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(j)&&U&&!z,G=(0,S.d)("md"),H=so(t),{hasError:V,contentString:W,reasoningText:Y}=ae(t),J=Array.isArray(t.content)&&ip(t.content).toolCalls.length>0,q=!!t.pairwiseFeedbackId,Q=null==a&&w!==s.Jg.IMAGE&&!(j===s.lY.DIRECT_BATTLE&&q),K=Q&&w!==s.Jg.WEBDEV,X=sa(t,k),Z=si(t),$=(w===s.Jg.CHAT||w===s.Jg.WEBDEV)&&""===W&&!V&&!Y&&!J,ee=function(e){let{voteStatus:t,isSelected:a=!1,voteHoverState:i=null,isInDrawer:s=!1}=e;return["win","tie"].includes(null!=t?t:"")?a?"border-border-faint text-interactive-positive":s?"border-transparent text-interactive-positive":"border-interactive-positive text-interactive-positive":"bothbad"===t?s?"border-transparent text-interactive-negative":"border-interactive-negative text-interactive-negative":"win"===i||"tie"===i?"border-interactive-positive text-interactive-positive":"bothbad"===i?"border-interactive-negative text-interactive-negative":"lose"===t?"border-border-faint text-interactive-normal":null===t?"border-border-faint":null}({voteStatus:X,voteHoverState:Z,isSelected:a===t.participantPosition}),et=(0,g.useCallback)(()=>{if(!p.current||!K)return;let{scrollTop:e,scrollHeight:t,clientHeight:a}=p.current;v(e+a<t-1)},[K]);(0,g.useEffect)(()=>{et()},[et]),(0,g.useEffect)(()=>{if(!h.current||!K)return;let e=new ResizeObserver(()=>{et()});return e.observe(h.current),()=>{e.disconnect()}},[et,K]);let{stayScrolled:ea}=function(e){let{initialScroll:t=null,margin:a=0,runScroll:i=e$(e)}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=(0,g.useRef)(null),r=(0,g.useCallback)(()=>{let t;return null!==e.current&&Math.ceil(e.current.scrollTop)>=(t=e.current).scrollHeight-t.clientHeight-a},[e,a]);(0,g.useEffect)(()=>{let t=()=>{s.current=r()},a=e.current;if(null!==a)return a.addEventListener("scroll",t),()=>a.removeEventListener("scroll",t)},[e,r]);let n=(0,g.useCallback)(t=>{let a;null!=e.current&&i(Math.min((a=e.current).scrollHeight-a.clientHeight,t))},[e,i]),l=(0,g.useCallback)(()=>{n(1/0)},[n]),o=(0,g.useCallback)(()=>(s.current&&l(),s.current),[l]);return e0(()=>{null!==t&&n(t),s.current=r()},[]),{scroll:n,stayScrolled:o,scrollBottom:l,isScrolled:r}}(p,{margin:20});(0,g.useLayoutEffect)(()=>{E&&ea()},[ea,t.content.length,E]);let ei=(0,g.useCallback)(()=>{null!=p.current&&p.current.scrollTo({top:p.current.scrollHeight,behavior:"smooth"})},[]);return(0,i.jsxs)(an,{messageLayoutMode:n,children:[(0,i.jsxs)("div",{className:(0,_.cn)("bg-surface-primary relative flex w-full min-w-0 flex-1 flex-col overflow-hidden transition-all duration-300",{"rounded-xl border":"container"===n,"gap-2":"page"===n},ee,o),children:[(0,i.jsx)(sc,{message:t,model:b,setRenderExpandedMessage:u,selectedMessage:a}),w===s.Jg.WEBDEV&&G&&(0,i.jsx)(sw,{message:t,onClick:H,voteStatus:X}),w===s.Jg.WEBDEV?(0,i.jsx)(sv,{message:t,messageLayoutMode:n,shouldShowGeneratingText:$,messageRef:p}):(0,i.jsx)(iF,{message:t,messageLayoutMode:n,shouldShowGeneratingText:$,messageRef:p,contentRef:h,isScrollable:Q,checkOverflow:et,hasOverflow:x,scrollToBottom:ei}),"page"===n&&(0,i.jsxs)("div",{className:"flex items-center gap-2 pb-2",children:[F&&(0,i.jsx)(t4,{message:t}),I&&(0,i.jsx)(sh,{initialValue:B,onChange:e=>void T(e)}),(0,i.jsx)(su,{message:t})]}),"container"===n&&I&&(0,i.jsxs)("div",{className:"flex items-center gap-1 px-3 pb-2",children:[(0,i.jsx)(sh,{initialValue:B,onChange:e=>void T(e)}),w===s.Jg.WEBDEV&&O&&(0,i.jsx)(eZ.G,{content:"Retry",children:(0,i.jsx)(l.Button,{variant:"ghost",className:"size-3 rounded-md p-3",onClick:P,children:(0,i.jsx)(r.RefreshCw,{size:14})})})]})]}),(0,i.jsx)(sp,{renderExpandedMessage:c,setRenderExpandedMessage:u,message:t})]})}function sN(e){let{message:t}=e,[,a]=(0,i0.A)(),{contentString:s}=ae(t),r=t7(t),n=(0,g.useRef)(null),[l,o]=(0,g.useState)(null);(0,g.useEffect)(()=>{let e=n.current;if(!e)return;let t=new ResizeObserver(e=>{for(let t of e)o(t.contentRect.height)});return t.observe(e),()=>{t.disconnect()}},[]);let c=(0,g.useMemo)(()=>{var e,a;return null!=(a=null==(e=t.experimental_attachments)?void 0:e.some(e=>null!=e.contentType&&z.EC.includes(e.contentType)))&&a},[t.experimental_attachments]),d=(0,g.useMemo)(()=>{var e,a;return(null!=(a=null==(e=t.experimental_attachments)?void 0:e.length)?a:0)>0},[t.experimental_attachments]);return(0,i.jsx)(an,{messageLayoutMode:"container",children:(0,i.jsx)("div",{className:"group flex max-w-[min(768px,100%)] flex-col gap-1 self-end",children:(0,i.jsxs)("div",{className:(0,_.cn)("flex flex-col",c?"gap-2":"gap-4"),children:[(0,i.jsx)(ay,{message:t}),(0,i.jsxs)("div",{className:"flex min-w-0 flex-1 items-center justify-end gap-2",children:[(0,i.jsx)(iV.i,{variant:"ghost",size:12,className:"text-text-secondary hover:text-text-primary size-6 flex-shrink-0 rounded-md p-0 opacity-0 transition-opacity duration-200 group-hover:opacity-100",onClick:()=>a(s)}),(0,i.jsx)("div",{ref:n,className:(0,_.cn)("bg-surface-raised w-fit min-w-0 max-w-prose rounded-lg px-3 py-2 transition-[border-radius] duration-150",{"rounded-3xl":(null!=l?l:40)<=40,"flex-1":!d}),children:(0,i.jsx)(aT.A,{id:t.id,content:s,className:(0,_.cn)({"text-interactive-negative":r})})})]})]})})})}var sk=a(74710),sE=a(17617),sA=a(93514),sC=a(32001),s_=a(99736);let sB=g.createContext({scrollLeftOnCarouselId:()=>{},scrollRightOnCarouselId:()=>{},registerCarousel:()=>{}}),sT=e=>{let{children:t}=e,[a,s]=g.useState({}),r=g.useCallback(e=>{var t;a[e]&&(null==(t=a[e])||t.left())},[a]),n=g.useCallback(e=>{var t;a[e]&&(null==(t=a[e])||t.right())},[a]);return(0,i.jsx)(sB.Provider,{value:{scrollLeftOnCarouselId:r,scrollRightOnCarouselId:n,registerCarousel:(e,t,a)=>{s(i=>({...i,[e]:{left:t,right:a}}))}},children:t})},sI=g.createContext(null);function sS(){let e=g.useContext(sI);if(!e)throw Error("useCarousel must be used within a <Carousel />");return e}function sR(){let e=g.useContext(sB);if(!e)throw Error("useCarouselTouchArea must be used within a <CarouselTouchArea />");return e}let sM=e=>{let{className:t,latestMessages:a,...s}=e,r=g.useRef(null),{scrollLeftOnCarouselId:n,scrollRightOnCarouselId:l}=sR(),o=(0,sC.J)(...a.map(e=>e.id)),c=g.useCallback(e=>{let t=e.touches[0];t&&(r.current={x:t.clientX,y:t.clientY})},[]),d=g.useCallback(e=>{if(!r.current)return;let t=e.changedTouches[0];if(!t)return;let a=t.clientX-r.current.x;Math.abs(a)>Math.abs(t.clientY-r.current.y)&&Math.abs(a)>50&&(a>0?n(o):l(o)),r.current=null},[r,n,l]);return(0,i.jsx)("div",{className:(0,_.cn)("h-full min-h-12 w-full flex-grow",t),onTouchStart:c,onTouchEnd:d,...s})},sD=e=>{let{orientation:t="horizontal",opts:a,setApi:s,plugins:r,edgeToEdgePadding:n,className:l,children:o,messageA:c,messageB:d,...u}=e,[m,p]=(0,s_.A)({...a,axis:"horizontal"===t?"x":"y"},r),[h,f]=g.useState(!1),[x,v]=g.useState(!1),[b,y]=g.useState(!1),{registerCarousel:w}=sR(),j=g.useCallback(e=>{f(e.canScrollPrev()),v(e.canScrollNext())},[]),N=g.useCallback(()=>{null==p||p.scrollPrev()},[p]),k=g.useCallback(()=>{null==p||p.scrollNext()},[p]),E=g.useCallback(e=>{"ArrowLeft"===e.key?(e.preventDefault(),N()):"ArrowRight"===e.key&&(e.preventDefault(),k())},[N,k]);return g.useEffect(()=>{w((0,sC.J)(null==c?void 0:c.id,null==d?void 0:d.id),N,k)},[N,k]),g.useEffect(()=>{p&&s&&s(p)},[p,s]),g.useEffect(()=>{if(p)return j(p),p.on("reInit",j),p.on("select",j),()=>{null==p||p.off("select",j)}},[p]),(0,i.jsx)(sI.Provider,{value:{carouselRef:m,api:p,opts:a,orientation:t||((null==a?void 0:a.axis)==="y"?"vertical":"horizontal"),scrollPrev:N,scrollNext:k,canScrollPrev:h,canScrollNext:x,edgeToEdgePadding:n,hasInteracted:b,setHasInteracted:y},children:(0,i.jsx)("div",{onKeyDownCapture:E,className:(0,_.cn)("relative h-full",l,{"-mx-[--e2e-padding]":"horizontal"===t,"-my-[--e2e-padding]":"vertical"===t}),style:{"--e2e-padding":n},role:"region","aria-roledescription":"carousel",...u,children:o})})};sD.displayName="Carousel";let sO=e=>{let{className:t,ref:a,children:s,...r}=e,{carouselRef:n,orientation:l}=sS(),o=1===g.Children.toArray(s).filter(Boolean).length;return(0,i.jsx)("div",{ref:n,className:(0,_.cn)("overflow-hidden",o&&"mx-auto max-w-[800px]",{"px-[--e2e-padding]":"horizontal"===l,"py-[--e2e-padding]":"vertical"===l}),children:(0,i.jsx)("div",{ref:a,className:(0,_.cn)("flex",t),...r,children:s})})},sP=e=>{let{className:t,ref:a,isRenderingAlone:s,...r}=e,{orientation:n}=sS();return(0,i.jsx)("div",{ref:a,role:"group","aria-roledescription":"slide",className:(0,_.cn)("min-w-0 shrink-0 grow-0 basis-full","horizontal"!==n||s?"pt-4":"pl-4",t),...r})},sz=g.forwardRef((e,t)=>{let{className:a,variant:s="outline",size:n="icon",hideOnDisable:o=!1,...c}=e,{orientation:d,scrollPrev:u,canScrollPrev:m}=sS();return(0,i.jsxs)(l.Button,{ref:t,variant:s,size:n,className:(0,_.cn)("absolute h-8 w-8 rounded-full","horizontal"===d?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",{hidden:o&&!m},a),disabled:!m,onClick:u,...c,children:[(0,i.jsx)(r.ArrowLeft,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Previous slide"})]})});sz.displayName="CarouselPrevious";let sL=e=>{let{className:t,variant:a="outline",size:s="icon",hideOnDisable:n=!1,shouldDim:o=!1,ref:c,...d}=e,{orientation:u,scrollNext:m,canScrollNext:p,hasInteracted:h}=sS(),g=o||h;return(0,i.jsxs)(l.Button,{ref:c,variant:g?a:"tertiary",size:s,className:(0,_.cn)("absolute h-8 w-8 rounded-full","horizontal"===u?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",{hidden:n&&!p},t),disabled:!p,onClick:()=>m(),...d,children:[(0,i.jsx)(r.ArrowRight,{className:(0,_.cn)("h-4 w-4",g?"text-interactive":"text-interactive-inverted")}),(0,i.jsx)("span",{className:"sr-only",children:"Next slide"})]})},sU=e=>{let{className:t,messageA:a,messageB:r,ref:n,...l}=e,{api:o,setHasInteracted:c}=sS(),[d,u]=g.useState(0),[m,p]=g.useState(0),[h,f]=g.useState(new Set),x=(e=>{let[t,a]=e;return(0,N.g)((e=>{let[t,a]=e,i="string"==typeof t?t:null==t?void 0:t.id,s="string"==typeof a?a:null==a?void 0:a.id;return(0,tA.Mz)([e=>e.pairwiseFeedbacks],e=>{var t;return null==(t=e.find(e=>e.messageAId===i||e.messageBId===s))?void 0:t.value})})([t,a]))})([a,r]),v=(0,N.g)(e=>e.setDidInspectBothMobileHorizontalResponses),b=null==a?void 0:a.status,y=null==r?void 0:r.status;g.useEffect(()=>{x===s.sb.MODEL_A?null==o||o.scrollTo(0):x===s.sb.MODEL_B&&(null==o||o.scrollTo(1))},[x,o]);let w=g.useCallback(e=>{p(e.scrollSnapList().length),u(e.selectedScrollSnap())},[]);g.useEffect(()=>{if(o)return o.on("reInit",w),o.on("select",w),o.on("slidesChanged",w),()=>{null==o||o.off("reInit",w),null==o||o.off("select",w),null==o||o.off("slidesChanged",w)}},[o]),g.useEffect(()=>{0!==d&&c(!0),(0!==d||b!==s.nH.PENDING)&&(1!==d||y!==s.nH.PENDING)&&f(e=>{let t=new Set(e);return t.add(d),t})},[d,b,y]),g.useEffect(()=>{a&&r&&v(2===h.size,a.id,r.id)},[h,v]);let j=g.useMemo(()=>Array.from({length:m}).map((e,t)=>(0,i.jsx)(sF,{isSelected:t===d,onSelected:()=>null==o?void 0:o.scrollTo(t)},t)),[m,d]);return m<=1?null:(0,i.jsx)("div",{ref:n,className:(0,_.cn)("flex w-full justify-center",t),...l,children:j})};sU.displayName="CarouselControls";let sF=e=>{let{className:t,isSelected:a,onSelected:s,ref:r,...n}=e;return(0,i.jsx)("button",{ref:r,className:(0,_.cn)("cursor-pointer px-1 py-2",t),onClick:s,...n,children:(0,i.jsx)("div",{className:(0,_.cn)("bg-interactive-normal hover:bg-interactive-active h-2 rounded-lg transition-all",a?"w-6":"w-2 opacity-[24%]")})})};sF.displayName="CarouselControlChip";let sG=(0,p.eU)(!1);function sH(){let e=(0,h.Xr)(sG);return{dismiss:(0,g.useCallback)(()=>{e(!0)},[e]),reset:(0,g.useCallback)(()=>{e(!1)},[e])}}let sV={[s.Jg.AUTO]:{title:"Auto",headerText:"Auto",descriptionText:"Automatically Detect Modality",Icon:r.AutoModeIcon},[s.Jg.CHAT]:{title:"Text",headerText:"Text",descriptionText:"Try Language and Vision modes",Icon:r.Type},[s.Jg.IMAGE]:{title:"Image",headerText:"Image",descriptionText:"Generate Images",Icon:r.Image},[s.Jg.AUDIO]:{title:"Audio",headerText:"Audio",descriptionText:"Generate Audio",Icon:r.AudioLines},[s.Jg.WEBDEV]:{title:"Code",headerText:"Code",descriptionText:"Build Apps and Websites",Icon:r.Code},[s.Jg.SEARCH]:{title:"Search",headerText:"Search",descriptionText:"Web Search",Icon:r.Globe},[s.Jg.P2L]:{title:"P2L",headerText:"P2L",descriptionText:"Prompt to Leaderboard",Icon:r.Zap},[s.Jg.VIDEO]:{title:"Video",headerText:"Video",descriptionText:"Generate Videos",Icon:r.Film}},sW=e=>sV[e]||sV[s.Jg.CHAT],sY=(0,at.createServerReference)("70148f200c4c966a37fe9f723d432b5ebfb00fa9a7",at.callServer,void 0,at.findSourceMapURL,"generateUploadUrl"),sJ=(0,at.createServerReference)("60f5797b6e6f15fb7b7fe453ad4fc95011b238dfd9",at.callServer,void 0,at.findSourceMapURL,"getSignedUrl");async function sq(e){try{let t=await sY(e.name,e.type);if(!t.success||null==t.data)throw Error("Failed to generate upload URL");let{uploadUrl:a,key:i}=t.data;if(!(await fetch(a,{method:"PUT",body:e})).ok)throw Error("Failed to upload file");let s=await sJ(i.startsWith("/")?i.slice(1):i);if(!s.success||null==s.data)throw Error("Failed to get signed url");let r=s.data.url;return{key:i,url:r,mimeType:e.type}}catch(e){throw console.error("File upload failed:",e),e}}let sQ={[s.Jg.CHAT]:"Text Chat",[s.Jg.SEARCH]:"Search the Web",[s.Jg.IMAGE]:"Generate Image",[s.Jg.WEBDEV]:"Build Something",[s.Jg.VIDEO]:"Generate Video"},sK=(0,g.memo)(function(){let{dismiss:e}=sH(),{suggestedModalities:t,messages:a,autoModalityMetadata:n,evaluationSessionId:o}=(0,N.g)((0,k.k)(e=>{var t,a;return{suggestedModalities:null!=(a=null==(t=e.autoModalityMetadata)?void 0:t.suggestedModalities)?a:[],messages:e.messages,autoModalityMetadata:e.autoModalityMetadata,evaluationSessionId:e.id}})),{handleAutoModalityRerun:c}=function(){let e=(0,w.rd)(),t=(0,g.useContext)(N.P),a=(0,N.g)((0,k.k)(e=>e.reset)),[,i]=(0,h.fp)(Y.A),{appendMultiStream:s}=tH(),{reset:r}=sH();return{handleAutoModalityRerun:(0,g.useCallback)(async n=>{var l;if(!t)return;a({mode:t.getState().mode,modality:n.modality});let o=t.getState().id;e.replace("/c/".concat(o));let c=(null==(l=n.attachments)?void 0:l.length)?n.attachments.map(e=>{var t,a;let i="string"==typeof e?e:e.url,s="string"==typeof e?"image/png":null!=(t=e.contentType)?t:"image/png",r="string"==typeof e?"":null!=(a=e.name)?a:"";return{file:new File([new Blob([],{type:s})],r,{type:s}),preview:i,isAlreadyUploaded:!0,uploadedUrl:i}}):[];i(c);let d=c.length>0?await Promise.all(c.map(async e=>e.isAlreadyUploaded&&e.uploadedUrl?{key:e.file.name,url:e.uploadedUrl,mimeType:e.file.type}:await sq(e.file))):[];i([]),r();let u={autoModalitySuggestionAcceptance:{previousEvaluationSessionId:n.previousEvaluationSessionId,originalPredictedModality:n.originalAutoModalityMetadata.modality,acceptedSuggestedModality:n.modality,originalConfidence:n.originalAutoModalityMetadata.confidence,userAcceptedSuggestion:!0}};s({content:n.content,experimental_attachments:d.map(e=>({name:e.key,contentType:e.mimeType,url:e.url})),metadata:u})},[t,a,e,i,s,r])}}(),u=(0,g.useCallback)(t=>{if(!n)return;let i=a.filter(e=>e.role===s.PG.USER).pop();i&&(d.z.capture({action:"auto_modality_suggestion_accepted",params:{suggested_modality:t,evaluation_session_id:o}}),c({content:tJ(i),attachments:i.experimental_attachments,modality:t,previousEvaluationSessionId:o,originalAutoModalityMetadata:n}),e())},[a,c,e,o,n]),m=(0,g.useCallback)(()=>{0!==t.length&&(d.z.capture({action:"auto_modality_suggestion_dismissed",params:{suggested_modalities:[...t].sort().join(","),evaluation_session_id:o}}),e())},[t,o,e]);return 0!==t.length&&n?(0,i.jsxs)("div",{className:"mt-4 flex w-full flex-col items-center gap-3 px-4",children:[(0,i.jsx)("p",{className:"text-text-secondary text-sm font-normal",children:"Did you mean to do something else?"}),(0,i.jsxs)("div",{className:"flex flex-wrap items-center justify-center gap-2",children:[t.map(e=>{let t=sW(e).Icon,a=sQ[e];return a?(0,i.jsxs)(l.Button,{variant:"outline",size:"md",onClick:()=>u(e),className:"bg-surface-primary shrink-0",children:[(0,i.jsx)(t,{className:"size-4"}),a]},e):null}),(0,i.jsxs)(l.Button,{variant:"outline",size:"md",onClick:m,"aria-label":"Dismiss",className:"bg-surface-primary shrink-0",children:[(0,i.jsx)(r.EyeOff,{className:"size-4"}),"No, please hide"]})]})]}):null});var sX=a(44794);let sZ="l-mvo",s$=(0,p.eU)(function(){try{let e=localStorage.getItem(sZ);return"true"===e}catch(e){return!1}}());function s0(){let[e,t]=(0,h.fp)(s$);return{hasBeenShown:e,markAsShown:()=>{try{localStorage.setItem(sZ,"true")}catch(e){console.error("Failed to save shown state:",e)}t(!0)}}}function s1(e){let{open:t,onOpenChange:a}=e,{hasBeenShown:s,markAsShown:o}=s0(),c=()=>{o(),null==a||a(!1)};return(0,i.jsx)(eD._s,{open:null!=t?t:!s,onOpenChange:e=>{e||c(),null==a||a(e)},children:(0,i.jsxs)(eD.zj,{children:[(0,i.jsxs)(eD.BE,{className:"flex flex-col items-center gap-3",children:[(0,i.jsx)("div",{className:"h-2"}),(0,i.jsx)(r.Swords,{size:32}),(0,i.jsx)(eD.gk,{className:"text-2xl",children:"How voting works"}),(0,i.jsx)(eD.I6,{children:'We\'ll show you 2 responses from 2 anonymous models. Please vote on the response you think is best. We will reveal the models afterwards. If you like both responses, use "It\'s a tie" button. If you do not like either, please use the "Both are bad" button.'}),(0,i.jsx)("div",{children:(0,i.jsxs)(n.Link,{href:"/how-it-works",className:"flex items-center gap-1",target:"_blank",children:[(0,i.jsx)("span",{className:"text-sm font-normal",children:"Learn more about How it Works"}),(0,i.jsx)(r.ArrowRight,{size:14})]})}),(0,i.jsx)("img",{src:"/images/Mobile_vote_onboarding_final.png",alt:"Mobile Voting Onboarding Experience",className:"mt-3 w-full"})]}),(0,i.jsx)(eD.tb,{children:(0,i.jsx)(eD.cp,{asChild:!0,children:(0,i.jsx)(l.Button,{size:"lg",variant:"primary",onClick:c,children:"Got it"})})})]})})}let s2="form",s4="prompt",s5="attachments";function s3(){return new Promise((e,t)=>{let a=indexedDB.open("arena-pending-form",1);a.onerror=()=>t(a.error),a.onsuccess=()=>e(a.result),a.onupgradeneeded=e=>{e.target.result.createObjectStore(s2)}})}function s6(){s3().then(e=>new Promise((t,a)=>{let i=e.transaction(s2,"readwrite");i.objectStore(s2).delete(s4),i.oncomplete=()=>{e.close(),t()},i.onerror=()=>{e.close(),a(i.error)}}))}function s9(){s3().then(e=>new Promise((t,a)=>{let i=e.transaction(s2,"readwrite");i.objectStore(s2).delete(s5),i.oncomplete=()=>{e.close(),t()},i.onerror=()=>{e.close(),a(i.error)}}))}var s8=a(34119);function s7(e){let{classNameContainer:t,className:a,size:s=60,transition:r,onAnimationComplete:n,style:l}=e;return(0,i.jsx)("div",{className:(0,_.cn)("pointer-events-none absolute inset-[-1px] rounded-[inherit] border border-transparent [mask-clip:padding-box,border-box] [mask-composite:intersect] [mask-image:linear-gradient(transparent,transparent),linear-gradient(#000,#000)]",t),children:(0,i.jsx)(sk.P.div,{className:(0,_.cn)("absolute aspect-square bg-zinc-500",a),style:{width:s,offsetPath:"rect(0 auto auto 0 round ".concat(s,"px)"),...l},animate:{offsetDistance:["0%","100%"]},transition:r||{repeat:1/0,duration:5,ease:"linear"},onAnimationComplete:n})})}var re=a(5398);let rt={hidden:{y:20,opacity:0},visible:{y:0,opacity:1}},ra={duration:.15,ease:"easeOut"};function ri(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sk.P.div,{className:"mb-4 flex items-center",initial:"hidden",animate:"visible",variants:rt,transition:{...ra,delay:.1},children:(0,i.jsx)(c.T,{className:"h-6 w-auto sm:h-7"})}),(0,i.jsxs)(sk.P.h1,{className:"text-text-tertiary mb-0 text-center text-[48px] font-light leading-tight sm:mb-4 sm:text-[60px]",initial:"hidden",animate:"visible",variants:rt,transition:{...ra,delay:.2},children:["Experience",(0,i.jsx)("br",{className:"sm:hidden"}),(0,i.jsx)("span",{className:"hidden sm:inline",children:" "}),"the"," ",(0,i.jsx)("span",{className:"bg-highlight text-text-primary dark:text-highlight-text inline-block px-2 align-baseline italic leading-[1]",children:"frontier"})]})]})}function rs(e){let{className:t}=e;return(0,i.jsx)("div",{className:t,children:(0,i.jsx)("div",{className:"flex flex-col items-center justify-center gap-6 sm:mb-4",children:(0,i.jsx)("div",{className:"flex flex-col items-center gap-4",children:(0,i.jsx)("div",{className:"flex w-full max-w-[800px] flex-col items-center",children:(0,i.jsx)(ri,{})})})})})}var rr=a(63852),rn=a(49414);function rl(e){let{anchorEl:t,isFileUploadEnabled:a=!0}=e,s=(0,S.d)("md"),{shouldShowEducation:r,dismissEducation:n}=(0,rn.f)(null!=t,a),{contentRef:o,position:c}=function(e){let{anchorEl:t,enabled:a=!0,positionAbove:i=!1,anchorEdge:s,fallbackContentWidth:r=0}=e,n=(0,g.useRef)(null),[l,o]=(0,g.useState)(null);return(0,g.useLayoutEffect)(()=>{let e,l;if(!a||!t)return;let c=()=>{var e,a,l,c;let d,u=t.getBoundingClientRect();if(!(u.width>0||u.height>0))return void o(null);let m=window.scrollY,p=window.scrollX,h=window.innerWidth,g=u.left+p+u.width/2,f=null!=(a=null==(e=n.current)?void 0:e.offsetWidth)?a:0,x=f>0?f:r,v=0;if(x>0){let e=g-x/2,t=p+16-e,a=e+x-(p+h-16);t>0?v=t:a>0&&(v=-a)}if(s)d=("top"===s?u.top:u.bottom)+m;else{let e=null!=(c=null==(l=n.current)?void 0:l.offsetHeight)?c:0;d=i?u.top+m-e-12:u.bottom+m}o({top:d,left:g,shift:v})},d=()=>{!e&&"undefined"!=typeof ResizeObserver&&n.current&&(e=new ResizeObserver(c)).observe(n.current)};return d(),requestAnimationFrame(()=>{c(),d()}),window.addEventListener("resize",c),window.addEventListener("scroll",c,!0),"undefined"!=typeof ResizeObserver&&(l=new ResizeObserver(c)).observe(t),()=>{window.removeEventListener("resize",c),window.removeEventListener("scroll",c,!0),null==l||l.disconnect(),null==e||e.disconnect()}},[a,t,i,s,r]),{contentRef:n,position:l}}({anchorEl:t,enabled:r,anchorEdge:s?"top":"bottom",fallbackContentWidth:280});if("undefined"==typeof document||!r||!t||null==c)return null;let d=c.shift,u=100*!s,m=s?"translate(calc(-50% + ".concat(d,"px), calc(-100% - ").concat(12,"px))"):"translate(calc(-50% + ".concat(u,"px + ").concat(d,"px), ").concat(12,"px)"),p=s?"translate(calc(-50% - ".concat(d,"px), -6px) rotate(45deg)"):"translate(calc(-50% - ".concat(u,"px - ").concat(d,"px), 6px) rotate(45deg)");return(0,rr.createPortal)((0,i.jsx)(sk.P.div,{style:{top:c.top,left:c.left},className:"absolute z-10",...!s&&{initial:"hidden",animate:r?"visible":"hidden",variants:rt,transition:{...ra,delay:.4}},children:(0,i.jsxs)("div",{ref:o,className:"border-border-faint bg-background relative w-[280px] rounded-[8px] border p-3 text-left shadow-lg",style:{transform:m},role:"dialog","aria-modal":!1,onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"mb-2 space-y-1",children:[(0,i.jsxs)("p",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-interactive-link text-base font-semibold",children:"NEW"}),(0,i.jsx)("span",{className:"text-header-primary text-base font-medium",children:"File Upload"})]}),(0,i.jsx)("p",{className:"text-text-secondary text-sm leading-5",children:"You can now upload PDF documents and chat with them!"})]}),(0,i.jsx)(l.Button,{variant:"tertiary",className:"h-7.5 w-full justify-center",size:"md",onClick:e=>{e.stopPropagation(),n()},onMouseDown:e=>e.stopPropagation(),children:"Got it"}),(0,i.jsx)("span",{className:(0,_.cn)("border-border-faint bg-background pointer-events-none absolute left-1/2 h-3 w-3",s?"top-full":"bottom-full",s?"":"border border-b-0 border-r-0"),style:{transform:p}})]})}),document.body)}let ro="text-text-primary hover:bg-surface-secondary flex flex-row items-center gap-2 rounded-[4px] px-3 py-2";async function rc(e){let t=document.createElement("video");t.srcObject=e,await t.play(),await new Promise(e=>{t.videoWidth>0&&t.videoHeight>0?e():t.addEventListener("loadeddata",()=>e(),{once:!0})});let a=document.createElement("canvas");a.width=t.videoWidth,a.height=t.videoHeight;let i=a.getContext("2d");if(!i)throw Error("Could not get canvas context");i.drawImage(t,0,0);let s=await new Promise(e=>{a.toBlob(e,"image/png",1)});if(!s)throw Error("Could not create image blob");return s}async function rd(){let e;try{e=await navigator.mediaDevices.getDisplayMedia(function(){let e=function(){let e=window.CaptureController;if(!e)return;let t=new e;return t.setFocusBehavior("no-focus-change"),t}(),t={video:{displaySurface:"browser"},surfaceSwitching:"exclude",selfBrowserSurface:"exclude"};return e&&(t.controller=e),t}());let t=await rc(e),a=new Date().toISOString().replace(/[:.]/g,"-");return new File([t],"screenshot-".concat(a,".png"),{type:"image/png"})}catch(e){if(e instanceof Error&&"NotAllowedError"===e.name)return null;throw console.error("Screenshot capture failed:",e),e}finally{null==e||e.getTracks().forEach(e=>e.stop())}}function ru(e){let{onFileSelect:t,onFilesSelected:a,isImageUploadEnabled:s,isFileUploadEnabled:n,disabled:o,showScreenshotOption:c=!1}=e,[u,m]=(0,g.useState)(!1),[p,x]=(0,g.useState)(null),[v,b]=(0,g.useState)(!1),y=t2(),w=function(){let[e]=(0,h.fp)(Y.A),t=(0,N.g)(e=>e.mode),{modelAId:a,modelBId:i,models:s}=(0,L.g)(e=>e),r=(0,g.useRef)(0),n=(0,g.useMemo)(()=>e.filter(e=>z.EC.includes(e.file.type)),[e]),l=(0,g.useMemo)(()=>t1(t,a,i,s),[t,a,i,s]);return(0,g.useEffect)(()=>{n.length>l&&r.current<=l&&f.oR.warning("Maximum attachments reached",{description:"You have reached the max amount of attachments you can upload."}),r.current=n.length},[n.length,l]),n.length>=l}(),j=o||y||w,{shouldHighlight:E}=(0,rn.f)(null!=p,n),{mode:A,modality:C}=(0,N.g)((0,k.k)(e=>({mode:e.mode,modality:e.modality}))),B=(0,g.useCallback)(e=>{x(e)},[]),T=(0,g.useCallback)(async()=>{if(a){d.z.capture({action:"attachment_menu_click",params:{mode:A,modality:C,button:"screenshot"}}),b(!0),m(!1);try{let e=await rd();e&&(a([e]),f.oR.success("Screenshot captured"))}catch(e){f.oR.error("Failed to capture screenshot")}finally{b(!1)}}},[a,A,C]);if(!s&&!n)return null;let I=n&&s?"Upload Image or PDF":n?"Upload PDF":"Upload Image";return c&&a&&s?(0,i.jsxs)(eU.AM,{open:u,onOpenChange:m,children:[(0,i.jsx)(eZ.G,{content:"Add images",children:(0,i.jsx)(eU.Wv,{asChild:!0,children:(0,i.jsx)(l.Button,{type:"button",variant:"outline",size:"icon","aria-label":"Add files and more",disabled:j||v,className:"relative",children:(0,i.jsx)(ap.A,{className:"size-4"})})})}),(0,i.jsx)(eU.hl,{className:"bg-background border-border-faint w-[220px] rounded-[12px] border p-2",align:"start",children:(0,i.jsxs)("div",{className:"flex flex-col",children:[s&&(0,i.jsxs)("button",{className:ro,type:"button",onClick:()=>{d.z.capture({action:"attachment_menu_click",params:{mode:A,modality:C,button:"upload_image"}}),m(!1),t()},children:[(0,i.jsx)(r.ImagePlus,{className:"size-4"}),(0,i.jsx)("span",{className:"text-sm",children:"Upload image"})]}),(0,i.jsxs)("button",{className:ro,type:"button",onClick:()=>void T(),disabled:v,children:[(0,i.jsx)(re.A,{className:"size-4"}),(0,i.jsx)("span",{className:"text-sm",children:"Take a screenshot"})]})]})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(rl,{anchorEl:p,isFileUploadEnabled:n}),(0,i.jsx)(eZ.G,{content:I,children:(0,i.jsxs)(l.Button,{ref:B,type:"button",variant:"outline",size:"icon","aria-label":"Add files and more",onClick:t,disabled:j,className:(0,_.cn)("touch-hitbox relative",E&&"border-[1.5px] border-indigo-300 dark:border-indigo-300"),children:[E&&(0,i.jsx)(s7,{size:24,transition:{repeat:1/0,duration:3,ease:"linear"},classNameContainer:"border-[1.5px] inset-[-1.5px]",className:(0,_.cn)("bg-gradient-to-r from-indigo-300 via-indigo-500 to-indigo-300 dark:from-indigo-300 dark:via-indigo-400 dark:to-indigo-300")}),(0,i.jsx)(r.Plus,{className:"size-4"})]})})]})}var rm=a(52808);function rp(){let{mode:e,currentModality:t}=(0,N.g)((0,k.k)(e=>({mode:e.mode,currentModality:e.modality})));return(0,g.useMemo)(()=>{let a=[];a.push(s.Jg.SEARCH),a.push(s.Jg.IMAGE),a.push(s.Jg.WEBDEV);let i=e===s.lY.BATTLE,r=t===s.Jg.VIDEO;return(i||r)&&a.push(s.Jg.VIDEO),a},[e,t])}function rh(e){let{icon:t,label:a,selected:s=!1,tooltipContent:n,selectedTooltipContent:o,onClick:c,modality:d,disabled:u=!1}=e,m=(0,i.jsxs)(l.Button,{type:"button",variant:"outline",size:"icon","aria-label":a,disabled:u,onClick:()=>s?null==c?void 0:c(null):null==c?void 0:c(d),"data-modality-button":!0,className:(0,_.cn)("touch-hitbox","group/modality-button hover:text-interactive-active hover:bg-interactive-cta-secondary relative h-8 w-8 rounded-md p-0 transition-colors duration-150 ease-out active:transition-transform active:duration-75",s?["text-interactive-active bg-surface-tertiary border-border-medium hover:bg-surface-raised-alt hover:text-interactive-active px-2",a&&"w-auto gap-1.5"]:"hover:bg-interactive-normal/10 hover:border-interactive-normal/10",u&&"cursor-not-allowed opacity-60"),children:[s?(0,i.jsxs)("div",{className:"relative flex size-4 items-center justify-center",children:[(0,i.jsx)(t,{className:"size-4 group-hover/modality-button:opacity-0"}),(0,i.jsx)(r.X,{className:"group-hover/modality-button:text-interactive-active absolute size-4 opacity-0 group-hover/modality-button:opacity-100"})]}):(0,i.jsx)(t,{className:"size-4"}),s&&a&&(0,i.jsx)("span",{children:a})]});return s&&o?(0,i.jsx)(eZ.G,{content:o,children:m}):n&&(!s||u)?(0,i.jsx)(eZ.G,{content:n,children:m}):m}function rg(e){let{onModalitySelect:t,disabled:a=!1}=e,{currentModality:n,mode:o}=(0,N.g)((0,k.k)(e=>({currentModality:e.modality,mode:e.mode}))),c=rp(),u=(0,A._P)("auto-modality-enabled"),m=o===s.lY.BATTLE,p=n!==s.Jg.AUTO||m?n:s.Jg.CHAT,h=e=>{let a=null!=e?e:s.Jg.CHAT;n===s.Jg.AUTO&&a!==s.Jg.AUTO&&d.z.capture({action:"auto_modality_toggle_off",params:{new_modality:a}}),t(a)};if("treatment-1"===u||"treatment-3"===u){let e=m?[s.Jg.AUTO,...c]:c,t=p!==s.Jg.CHAT&&p!==s.Jg.AUTO&&c.includes(p);return(0,i.jsx)("div",{className:"flex items-center gap-2",children:e.map(e=>{let r=sV[e],n=p===e;return t&&!n?null:(0,i.jsx)(rh,{icon:r.Icon,label:e===s.Jg.AUTO?void 0:r.title,tooltipContent:r.descriptionText,selectedTooltipContent:e===s.Jg.AUTO?"Turn Off Auto Mode":void 0,selected:n,onClick:h,modality:e,disabled:a},e)})})}let g=m?[s.Jg.CHAT,...c,s.Jg.AUTO]:[s.Jg.CHAT,...c],f=p===s.Jg.AUTO,x=sV[p],v=f?r.Settings2:x.Icon,b=f?null:x.title;return(0,i.jsxs)(rm.rI,{children:[(0,i.jsx)(rm.ty,{asChild:!0,children:(0,i.jsxs)(l.Button,{variant:"outline",size:"icon",disabled:a,className:"bg-surface-primary hover:bg-surface-secondary group h-8 w-auto gap-1 px-2",children:[(0,i.jsx)(v,{className:"size-4"}),b&&(0,i.jsx)("span",{className:"text-xs font-medium",children:b}),(0,i.jsx)(r.ChevronDown,{className:"size-3 transition-transform duration-200 group-data-[state=open]:-rotate-180"})]})}),(0,i.jsx)(rm.SQ,{align:"start",side:"top",sideOffset:8,className:"bg-surface-primary border-border-faint z-[10] min-w-[180px] rounded-md p-0 data-[state=closed]:pointer-events-none data-[state=closed]:invisible",onCloseAutoFocus:e=>e.preventDefault(),children:g.map((e,t)=>{let a=sV[e],s=a.Icon,n=p===e,l=t===g.length-1;return(0,i.jsxs)(rm._2,{onClick:()=>h(e),className:(0,_.cn)("cursor-pointer rounded-none px-2 py-2.5",!l&&"border-border-faint border-b",n&&"bg-surface-tertiary"),children:[(0,i.jsx)(s,{className:"size-4"}),(0,i.jsx)("span",{className:"text-sm font-medium",children:a.title}),n&&(0,i.jsx)(r.Check,{className:"h-4 w-4"})]},e)})})]})}var rf=a(36490);let rx=(0,g.forwardRef)((e,t)=>{let{className:a,minRows:s=1,...r}=e;return(0,i.jsx)(rf.A,{ref:t,rows:s,minRows:s,className:(0,_.cn)("bg-surface-primary box-border w-full flex-none resize-none p-2 focus:outline-none active:outline-none",a),...r})});rx.displayName="AutoResizeTextarea";let rv=(0,p.eU)(!1);function rb(){let[e,t]=(0,h.fp)(rv),a=(0,g.useCallback)(()=>{t(!0)},[t]);return{shown:e,show:a,dismiss:(0,g.useCallback)(()=>{t(!1)},[t]),reset:(0,g.useCallback)(()=>{t(!1)},[t])}}var ry=a(46988);function rw(){let e=(0,N.g)(e=>e.modality),t=(0,m.kH)(e=>e.imageModalityRateLimitedUntil),a=(0,m.kH)(e=>e.videoModalityRateLimitedUntil),[i,r]=(0,g.useState)(()=>new Date),n=e===s.Jg.IMAGE?t:e===s.Jg.VIDEO?a:null;if((0,g.useEffect)(()=>{if(!n)return;let e=setInterval(()=>{r(new Date)},1e3);return()=>clearInterval(e)},[n]),!n)return{isRateLimited:!1};let l=(0,ry.FO)(n,i);return l?{isRateLimited:!0,resetTime:n,timeRemaining:l}:{isRateLimited:!1}}let rj=(0,ev.F)("flex items-center gap-3",{variants:{layout:{default:"justify-between",centered:"justify-center"},padding:{compact:"p-2",comfortable:"py-2 px-4"},responsive:{mobile:"w-full border-t border-x border-border-faint rounded-t-xl",desktop:"w-auto mx-0 border border-border-faint shadow-sm"}},defaultVariants:{layout:"default",padding:"comfortable"}});function rN(e){let{children:t,className:a,layout:s="default",padding:r="comfortable"}=e,n="bg-surface-tertiary";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"flex w-full flex-col items-center gap-2 md:hidden",children:(0,i.jsx)("div",{className:(0,_.cn)(rj({layout:s,padding:r,responsive:"mobile"}),n,a),children:t})}),(0,i.jsx)("div",{className:(0,_.cn)("hidden md:absolute md:top-0 md:z-10 md:flex md:-translate-y-full md:justify-center","md:pb-0"),children:(0,i.jsx)("div",{className:(0,_.cn)(rj({layout:s,padding:r,responsive:"desktop"}),n,"rounded-t-lg rounded-b-none","border-b-0 shadow-none",a),children:t})})]})}var rk=a(3680);function rE(){var e;let{appendMultiStream:t}=tH(),a=(0,N.g)(e=>e.deleteMessage),o=(0,N.g)(e=>e.messages),c=(0,w.rd)(),d=(0,m.kH)(m.Q_),{setLocation:u}=(0,eV.G)(),p=(0,N.g)(e=>e.modality),h=(0,N.g)(e=>{if(1!==e.lastMessageIds.length)return null;let t=e.messages.find(t=>t.id===e.lastMessageIds[0]);return t&&t.role===s.PG.USER?t:null}),f=function(){var e,t,a;let{models:i,modelAId:s,modelBId:r}=(0,L.g)(e=>e),n=null==(e=i.find(e=>e.id===s))?void 0:e.rateLimitedUntil,l=null==(t=i.find(e=>e.id===r))?void 0:t.rateLimitedUntil,o=null!=n?n:l,c=n?s:r,d=i.find(e=>e.id===c),[u,m]=(0,g.useState)(()=>new Date);if((0,g.useEffect)(()=>{if(!o)return;let e=setInterval(()=>{m(new Date)},1e3);return()=>clearInterval(e)},[o]),!o)return{isRateLimited:!1,message:null};let p=(0,ry.FO)(o,u);return p?{isRateLimited:!0,message:"You have reached your rate limit for ".concat(null!=(a=null==d?void 0:d.displayName)?a:"this model",". Please try again in ").concat(p,".")}:{isRateLimited:!1,message:null}}(),x=rw(),v=p===s.Jg.IMAGE,b=(null==h?void 0:h.status)===s.nH.FLAGGED,y=(null==h?void 0:h.failureReason)===e9.tZ,j=1===o.length,k=b&&(null==h||null==(e=h.metadata)?void 0:e.flagReason)==="dlp_inspection"||y,E=!(b&&!k)&&!j&&!f.isRateLimited;return x.isRateLimited&&v&&d?(0,i.jsxs)(rN,{className:"space-between flex items-center gap-2",children:[(0,i.jsx)("p",{className:"text-interactive text-center text-xs font-medium sm:text-left sm:text-sm",children:"Please login or create an account to generate more images"}),(0,i.jsx)(l.Button,{variant:"tertiary",size:"md",className:"flex-1 gap-1 sm:flex-initial",onClick:()=>u("image-modality-rate-limit-cta"),children:"Login"})]}):(0,i.jsx)(rN,{children:(0,i.jsxs)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-center sm:gap-4",children:[(0,i.jsx)("p",{className:"text-interactive-negative text-center text-xs font-medium sm:text-left sm:text-sm",children:f.isRateLimited&&f.message?(0,i.jsx)("span",{children:f.message}):k?(0,i.jsx)("span",{children:e9.tZ}):b?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"sm:hidden",children:["Violates"," ",(0,i.jsx)(n.Link,{href:"/terms-of-use",target:"_blank",children:"Terms of Use"})]}),(0,i.jsxs)("span",{className:"hidden sm:inline",children:["This content violates our"," ",(0,i.jsx)(n.Link,{href:"/terms-of-use",target:"_blank",children:"Terms of Use"})]})]}):x.isRateLimited&&v&&!d?(0,i.jsx)("span",{children:"Image generation is rate limited. Please try again later."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"sm:hidden",children:"Something went wrong. Please try again."}),(0,i.jsx)("span",{className:"hidden sm:inline",children:"Something went wrong while generating the response. Please try again."})]})}),(0,i.jsxs)("div",{className:"flex w-full gap-2 sm:w-auto",children:[E&&(0,i.jsxs)(l.Button,{variant:"outline",size:"md",className:"flex-1 gap-1 sm:flex-initial",onClick:()=>{h&&t({content:h.content,experimental_attachments:h.experimental_attachments})},children:[(0,i.jsx)(r.RefreshCw,{size:12}),"Retry"]}),h&&(0,i.jsxs)(l.Button,{variant:"outline",size:"md",className:"flex-1 gap-1 sm:flex-initial",onClick:()=>{h&&(j?c.replace("/"):a(h.id))},children:[(0,i.jsx)(rk.A,{size:16}),"Clear"]})]})]})})}let rA={[s.lY.SIDE_BY_SIDE]:{requiresModelA:!0,requiresModelB:!0},[s.lY.DIRECT]:{requiresModelA:!0,requiresModelB:!1},[s.lY.DIRECT_BATTLE]:{requiresModelA:!0,requiresModelB:!1},[s.lY.BATTLE]:{requiresModelA:!1,requiresModelB:!1}};function rC(e){let{formState:t,latestMessages:a,messageValue:i}=e,[r,n,l]=(0,N.g)((0,k.k)(e=>[e.mode,e.modality,e.isVoteSubmitting])),{modelAId:o,modelBId:c,models:d}=(0,L.g)(e=>e),[u]=(0,h.fp)(Y.A);return(0,g.useMemo)(()=>{let e=rA[r],m=(!e.requiresModelA||null!=o)&&(!e.requiresModelB||null!=c),p=a.some(e=>e.status===s.nH.PENDING),h=n===s.Jg.VIDEO&&r!==s.lY.BATTLE,g=function(e,t,a,i){switch(e){case s.lY.BATTLE:return!1;case s.lY.SIDE_BY_SIDE:return W(t,i)||W(a,i);case s.lY.DIRECT:case s.lY.DIRECT_BATTLE:default:return W(t,i)}}(r,o,c,d),f=a.some(e=>e.role===s.PG.USER&&e.status===s.nH.FAILED),x=u.some(e=>e.file.type.startsWith("image/")),v=g&&!x,b=i.length>0,y=n===s.Jg.VIDEO&&i.length>z.ue;return{canSubmit:t.isValid&&!t.isSubmitting&&m&&!p&&!l&&!v&&!f&&!h&&!y,isTextAreaDisabled:h,disabledReason:h?"Non-battle modes are not currently available for video generation.":void 0,missingRequiredImages:v,shouldShowImageUploadBanner:v&&b,isVideoPromptTooLong:y}},[t.isValid,t.isSubmitting,a,r,n,l,o,c,d,u,i])}function r_(){let{latestAssistantMessages:e}=sr(),t=e[0],a=e[1],{isVoteSubmitting:i,viewedVideos:s}=(0,N.g)((0,k.k)(e=>({isVoteSubmitting:e.isVoteSubmitting,viewedVideos:e.viewedVideos})));return(0,g.useMemo)(()=>{var e,r;if(i)return!1;let n=null==t||null==(e=t.experimental_attachments)?void 0:e.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("video")}),l=null==a||null==(r=a.experimental_attachments)?void 0:r.some(e=>{var t;return null==(t=e.contentType)?void 0:t.startsWith("video")}),o=!n||!!(null==t?void 0:t.id)&&s.includes(t.id),c=!l||!!(null==a?void 0:a.id)&&s.includes(a.id);return o&&c},[i,s,t,a])}let rB={VIEW_VIDEO_TO_VOTE:"Please view both videos to vote"};function rT(){let[e,t,a]=(0,L.g)((0,k.k)(e=>[e.models,e.modelAId,e.modelBId])),i=rw(),{modality:r,messages:n,lastMessageIds:l,mode:o}=(0,N.g)((0,k.k)(e=>({modality:e.modality,messages:e.messages,lastMessageIds:e.lastMessageIds,mode:e.mode})));return(0,g.useMemo)(()=>{let c=l.map(e=>n.find(t=>t.id===e)).filter(e=>null!=e);return!!c&&(!i.isRateLimited||r!==s.Jg.VIDEO)&&(c.some(e=>e.role===s.PG.ASSISTANT)?(()=>{switch(o){case s.lY.DIRECT:case s.lY.DIRECT_BATTLE:return[t].filter(e=>null!=e);case s.lY.SIDE_BY_SIDE:case s.lY.BATTLE:return[t,a].filter(e=>null!=e)}})().some(t=>{var a;return(null==(a=e.find(e=>e.id===t))?void 0:a.rateLimitedUntil)!=null}):!!c.some(e=>e.role===s.PG.USER)&&c.some(e=>[s.nH.FAILED,s.nH.FLAGGED].includes(e.status)))},[i,r,n,l,o,e,t,a])}function rI(){let{loading:e,lastMessageIds:t,modality:a}=(0,N.g)((0,k.k)(e=>({loading:e.loading,lastMessageIds:e.lastMessageIds,modality:e.modality}))),{latestAssistantMessages:i}=sr();return(0,g.useMemo)(()=>!e&&0!==t.length&&a!==s.Jg.WEBDEV&&!!(i.length>=2&&i.some(e=>"a"===e.participantPosition)&&i.some(e=>"b"===e.participantPosition))&&i.every(e=>(null==e?void 0:e.status)===s.nH.SUCCESS&&(null==e?void 0:e.pairwiseFeedbackId)==null),[e,t,a,i])}function rS(){return(0,i.jsx)(rN,{layout:"centered",padding:"comfortable",children:(0,i.jsx)("div",{className:"text-red-600",children:(0,i.jsx)("span",{className:"text-sm font-medium",children:"Model requires image upload"})})})}function rR(){let{dismiss:e}=rb();return(0,i.jsx)(rN,{children:(0,i.jsxs)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-center sm:gap-4",children:[(0,i.jsx)("p",{className:"text-interactive-negative text-center text-sm font-normal leading-none sm:text-left",children:"Uh oh. You have reached the max amount of attachments you can upload."}),(0,i.jsx)(l.Button,{variant:"tertiary",size:"md",className:"w-full flex-shrink-0 sm:w-auto",onClick:e,children:"Got it"})]})})}function rM(e){let{message:t}=e;return(0,i.jsx)(rN,{layout:"centered",padding:"comfortable",children:(0,i.jsx)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-center sm:gap-4",children:(0,i.jsx)("p",{className:"text-text-primary text-center text-xs font-medium sm:text-left sm:text-sm",children:t})})})}function rD(e){let{size:t=24,...a}=e;return(0,i.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:[(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.2197 12.2803C14.5126 12.5732 14.9874 12.5732 15.2803 12.2803L19.2803 8.28033C19.5732 7.98744 19.5732 7.51256 19.2803 7.21967L15.2803 3.21967C14.9874 2.92678 14.5126 2.92678 14.2197 3.21967C13.9268 3.51256 13.9268 3.98744 14.2197 4.28033L16.9393 7H5.75C5.33579 7 5 7.33579 5 7.75C5 8.16421 5.33579 8.5 5.75 8.5H16.9393L14.2197 11.2197C13.9268 11.5126 13.9268 11.9874 14.2197 12.2803Z",fill:"currentColor"}),(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.2803 12.2197C9.98744 11.9268 9.51256 11.9268 9.21967 12.2197L5.21967 16.2197C4.92678 16.5126 4.92678 16.9874 5.21967 17.2803L9.21967 21.2803C9.51256 21.5732 9.98744 21.5732 10.2803 21.2803C10.5732 20.9874 10.5732 20.5126 10.2803 20.2197L7.56066 17.5L18.75 17.5C19.1642 17.5 19.5 17.1642 19.5 16.75C19.5 16.3358 19.1642 16 18.75 16L7.56066 16L10.2803 13.2803C10.5732 12.9874 10.5732 12.5126 10.2803 12.2197Z",fill:"currentColor"})]})}function rO(e){let{size:t=24,...a}=e;return(0,i.jsxs)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:[(0,i.jsx)("path",{d:"M21.25 12C21.25 6.89137 17.1086 2.75 12 2.75C6.89137 2.75 2.75 6.89137 2.75 12C2.75 17.1086 6.89137 21.25 12 21.25C17.1086 21.25 21.25 17.1086 21.25 12ZM22.75 12C22.75 17.9371 17.9371 22.75 12 22.75C6.06294 22.75 1.25 17.9371 1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.9371 1.25 22.75 6.06294 22.75 12Z",fill:"currentColor"}),(0,i.jsx)("path",{d:"M19.5303 5.53027L5.53027 19.5303L4.46973 18.4697L18.4697 4.46973L19.5303 5.53027Z",fill:"currentColor"})]})}function rP(){let e=t6(),t=(0,i3.bj)(e=>e),{isVoteSubmitting:a,messageAId:n,messageBId:o,didInspectBothResponsesMap:c,modality:d,setLeftVoteHoverState:u,setRightVoteHoverState:m}=(0,N.g)((0,k.k)(e=>({isVoteSubmitting:e.isVoteSubmitting,messageAId:e.lastMessageIds[0],messageBId:e.lastMessageIds[1],didInspectBothResponsesMap:e.didInspectBothResponsesByPairwiseFeedbackKey,modality:e.modality,setLeftVoteHoverState:e.setLeftVoteHoverState,setRightVoteHoverState:e.setRightVoteHoverState}))),p=d===s.Jg.WEBDEV,h=d===s.Jg.VIDEO,f=r_(),{handlePairwiseFeedbackSubmit:x}=i8(),v=a||h&&!f,b=(0,g.useCallback)(e=>{x(e,t,n,o,c[(0,sC.J)(n,o)]),u(null),m(null)},[x,n,o,u,m,t,c]),y=(0,g.useCallback)((e,t)=>{u(e),m(t)},[u,m]),w="border border-border-medium",j=(0,_.cn)(w,"hover:text-interactive-positive focus:text-interactive-positive hover:border-interactive-positive focus:border-interactive-positive hover:bg-interactive-positive/10 focus:bg-interactive-positive/10"),E=(0,_.cn)(w,"hover:text-interactive-negative focus:text-interactive-negative hover:border-interactive-negative focus:border-interactive-negative hover:bg-interactive-negative/10 focus:bg-interactive-negative/10"),A=(0,_.cn)("flex-1",!p&&"md:flex-none md:w-[180px]"),C=(0,_.cn)("flex-none",!p&&"md:w-[140px]"),B=[{value:s.sb.MODEL_A,className:(0,_.cn)("min-w-0 md:gap-1 focus-visible:ring-0",j,A),mobileText:e("A is better"),desktopText:e("A is better"),icon:(0,i.jsx)(r.ArrowLeft,{size:12,className:"hidden md:block"}),iconPosition:"left",onHover:()=>y("win",null)},{value:s.sb.TIE,className:(0,_.cn)("min-w-0 md:gap-1 focus-visible:ring-0",j,C),desktopText:p?null:e("Both are good"),icon:(0,i.jsx)(rD,{size:15,className:"md:size-3"}),iconPosition:"left",onHover:()=>y("tie","tie")},{value:s.sb.BOTH_BAD,className:(0,_.cn)("min-w-0 md:gap-1 focus-visible:ring-0",E,C),desktopText:p?"":e("Both are bad"),icon:(0,i.jsx)(rO,{size:15,className:"md:size-3"}),iconPosition:"left",onHover:()=>y("bothbad","bothbad")},{value:s.sb.MODEL_B,className:(0,_.cn)("min-w-0 md:gap-1 focus-visible:ring-0",j,A),mobileText:e("B is better"),desktopText:e("B is better"),icon:(0,i.jsx)(r.ArrowRight,{size:12,className:"hidden md:block"}),iconPosition:"right",onHover:()=>y(null,"win")}];return(0,i.jsx)(rN,{padding:"compact",className:"items-stretch",children:B.map(e=>(0,i.jsxs)(l.Button,{variant:"secondary",className:e.className,onClick:()=>b(e.value),onMouseEnter:e.onHover,onMouseLeave:()=>y(null,null),onFocus:e.onHover,onBlur:()=>y(null,null),disabled:v,children:["left"===e.iconPosition&&e.icon,e.mobileText&&(0,i.jsx)("span",{className:"md:hidden",children:e.mobileText}),e.desktopText&&(0,i.jsx)("span",{className:"hidden md:block",children:e.desktopText}),"right"===e.iconPosition&&e.icon,!e.iconPosition&&e.icon]},e.value))})}function rz(e){let{formState:t,latestMessages:a,messageValue:r}=e,n=rT(),l=rI(),{shouldShowImageUploadBanner:o}=rC({formState:t,latestMessages:a,messageValue:r}),{shown:c}=rb(),{message:d}=function(){let e=(0,N.g)(e=>e.modality),t=r_();return(0,g.useMemo)(()=>{let a;return e!==s.Jg.VIDEO||t||(a=rB.VIEW_VIDEO_TO_VOTE),{message:a}},[e,t])}();return(0,g.useMemo)(()=>n?(0,i.jsx)(rE,{}):o?(0,i.jsx)(rS,{}):l?d?(0,i.jsx)(rM,{message:d}):(0,i.jsx)(rP,{}):c?(0,i.jsx)(rR,{}):null,[n,o,l,c,d])}function rL(e){let{handleModalityChange:t}=e,a=(0,w.rd)(),s=(0,N.g)(e=>e.modality),r=rp();(0,g.useEffect)(()=>{r.forEach(e=>{a.prefetch((0,j.PY)(e))})},[a,r]);let n=s!==i1.EEvaluationModality.CHAT&&r.includes(s);return(0,i.jsx)("div",{className:"flex items-center gap-2",children:r.map(e=>{let a=sW(e),r=s===e;return n&&!r?null:(0,i.jsx)(rh,{icon:a.Icon,label:a.title,tooltipContent:a.descriptionText,selected:r,onClick:t,modality:e},e)})})}var rU=a(46411);function rF(e){let{size:t=rU.U,...a}=e;return(0,i.jsx)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a,children:(0,i.jsx)("path",{d:"M21 12C20.9999 13.9006 20.3981 15.7524 19.2809 17.2899C18.1637 18.8275 16.5885 19.9719 14.7809 20.5592C12.9733 21.1464 11.0262 21.1464 9.21864 20.559C7.41109 19.9717 5.83588 18.8272 4.71876 17.2895C3.60165 15.7519 2.99999 13.9001 3 11.9995C3.00001 10.0989 3.60171 8.24712 4.71884 6.70951C5.83598 5.1719 7.4112 4.02742 9.21877 3.44009C11.0263 2.85276 12.9734 2.85273 14.781 3.44001",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}var rG=a(22927);let rH={"image/png":[".png"],"image/jpeg":[".jpg",".jpeg"],"image/webp":[".webp"]},rV={"application/pdf":[".pdf"]};function rW(e){let{preview:t,alt:a,hasError:s}=e;return(0,i.jsx)("img",{src:t,alt:a,className:(0,_.cn)("bg-surface-floating h-full w-full object-cover",{"opacity-10":s})})}function rY(e){let{fileName:t,fileType:a}=e;return z.EC.includes(a)?(0,i.jsx)(ah,{name:t,contentType:a,className:"pointer-events-none"}):(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-gray-100",children:(0,i.jsx)("span",{className:"text-xxs line-clamp-3 break-words p-1 text-center",children:t})})}function rJ(e){let{attachment:t,index:a,onRemoveAttachment:s}=e,n=t.file.type.startsWith("image/"),o=t.file.type.startsWith("video/"),c=!!t.preview;return(0,i.jsxs)("div",{className:(0,_.cn)("group relative overflow-hidden rounded-lg",(n||o||c)&&"h-16 w-16"),children:[t.preview?(0,i.jsx)(rW,{preview:t.preview,alt:t.file.name,hasError:!!t.error}):(0,i.jsx)(rY,{fileName:t.file.name,fileType:t.file.type}),t.error&&(0,i.jsxs)("div",{className:"bg-interactive-negative/20 border-interactive-negative text-interactive-negative absolute inset-0 flex flex-col items-center justify-center gap-1 rounded-lg border border-dashed",children:[(0,i.jsx)(r.TriangleAlert,{size:14}),(0,i.jsx)("span",{className:"text-[10px] font-normal",children:"Error"})]}),t.uploading&&!t.error&&(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,i.jsx)(rF,{className:"text-interactive-active h-4 w-4 animate-spin"})}),(0,i.jsx)("div",{className:"absolute bottom-0 left-0 right-0 top-0 bg-black opacity-0 transition-opacity group-hover:opacity-50"}),(0,i.jsx)("div",{className:"absolute right-1 top-1",children:(0,i.jsx)(l.Button,{variant:"secondary",onClick:()=>{s(a)},className:(0,_.cn)("border-border-medium bg-surface-floating touch-hitbox rounded-full border p-1 opacity-0 transition-opacity group-hover:opacity-100",{"opacity-100":iY.Fr}),"aria-label":"Remove file",children:(0,i.jsx)(r.X,{size:10,className:"text-interactive-active"})})})]},a)}let rq=!1;async function rQ(e){let t={pageCount:null,isCorrupted:!1};if(0===e.size)return t.isCorrupted=!0,t;try{let i=await a.e(2165).then(a.bind(a,45395));rq||(i.GlobalWorkerOptions.workerSrc="/worker/pdf.worker.min.mjs",rq=!0);let s=await e.arrayBuffer(),r=await i.getDocument({data:s}).promise;return t.pageCount=r.numPages,r.destroy(),t}catch(e){return console.warn("Failed to parse PDF:",e),t.isCorrupted=!0,t}}var rK=a(91954);let rX=(0,p.eU)({});function rZ(e){var t;let[a,i]=(0,h.fp)(rX),s=null!=(t=a[e])&&t;return{seen:s,dismiss:(0,g.useCallback)(()=>{i(t=>({...t,[e]:!0}))},[i,e]),reset:(0,g.useCallback)(()=>{i(t=>({...t,[e]:!1}))},[i,e])}}function r$(){let{modality:e,loading:t,messages:a,mode:i}=(0,N.g)((0,k.k)(e=>({modality:e.modality,loading:e.loading,messages:e.messages,mode:e.mode}))),{seen:r}=rZ(e),{latestMessages:n}=sr(),l=rT();if(r||![s.Jg.IMAGE,s.Jg.VIDEO].includes(e)||t||0===a.length||l)return!1;let o=n.some(e=>null!=e.pairwiseFeedbackId),c=[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(i);return o||c}function r0(){return(0,i.jsx)("div",{className:"bg-surface-tertiary text-text-secondary border-border-faint animate-in fade-in rounded-xl border p-3 opacity-100 shadow-sm transition-all duration-300",children:(0,i.jsxs)("div",{className:"leading- text-sm",children:[(0,i.jsx)("p",{children:"Your conversations and certain other personal information will be disclosed to the relevant AI providers and may otherwise be disclosed publicly to help support our community and advance AI research."}),(0,i.jsx)("p",{className:"mt-3",children:"Do not submit to our Services any personal information or other sensitive information that you would not want to be shared publicly. By continuing to use our Services, you acknowledge and direct us to engage in such sharing."})]})})}var r1=a(22582);let r2=(0,g.forwardRef)((e,t)=>{let{size:a,className:s,disabled:r,onClick:n}=e;return(0,i.jsx)("button",{ref:t,type:"button",disabled:r,onClick:n,className:(0,_.cn)("text-interactive-normal hover:text-interactive-active focus-visible:text-interactive-active flex cursor-pointer select-none items-center justify-center transition-colors duration-200",s),children:(0,i.jsx)(r1.A,{width:a,height:a,strokeWidth:1.5})})});r2.displayName="HandHeartButton";let r4="Your prompts may be shared publicly to support AI research",r5="Your conversations may be shared to support our community, improve our service, and advance the development of reliable AI. This includes posting de-identified conversations publicly online as part of research datasets. Please review our privacy policy for more information.",r3="View FAQ";function r6(){return(0,S.d)("md")?(0,i.jsx)(r9,{}):(0,i.jsx)(r8,{})}function r9(){return(0,i.jsxs)(eD._s,{children:[(0,i.jsx)(eD.zj,{children:(0,i.jsxs)("div",{className:"flex flex-col gap-4 px-2 pb-12 pt-10",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-4 px-3",children:[(0,i.jsx)(eD.gk,{className:"font-heading text-lg font-medium italic",children:r4}),(0,i.jsx)(eD.I6,{className:"text-sm font-normal",children:r5})]}),(0,i.jsx)(eD.tb,{className:"p-0",children:(0,i.jsx)(l.Button,{size:"md",variant:"outline",asChild:!0,children:(0,i.jsx)(n.Link,{href:"/faq",target:"_blank",children:r3})})})]})}),(0,i.jsx)(eD.Uz,{asChild:!0,className:"touch-hitbox",children:(0,i.jsx)(r2,{size:16,className:"rounded-md p-2"})})]})}function r8(){let[e,t]=(0,g.useState)(!1);return(0,i.jsxs)(eU.AM,{open:e,onOpenChange:t,children:[(0,i.jsxs)(eo.m_,{open:!e&&void 0,children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("div",{children:(0,i.jsx)(eU.Wv,{asChild:!0,children:(0,i.jsx)(r2,{size:16,className:"rounded-md p-2"})})})}),(0,i.jsx)(eo.ZI,{className:"max-w-60",children:(0,i.jsxs)("p",{className:"text-interactive-on-cta text-center text-xs",children:[r4," ",(0,i.jsx)("span",{onClick:()=>t(!0),className:"text-interactive-cta-focus dark:text-interactive-cta-hover cursor-pointer",children:"Learn more"})]})})]}),(0,i.jsxs)(eU.hl,{className:"border-medium bg-surface-secondary flex w-64 flex-col gap-2 rounded-xl border p-4",align:"end",side:"top",children:[(0,i.jsx)("h2",{className:"text-header-primary font-heading text-lg font-medium italic",children:r4}),(0,i.jsx)("p",{className:"text-text-secondary text-xs font-normal",children:r5}),(0,i.jsx)(l.Button,{size:"sm",variant:"outline",asChild:!0,className:"mt-2",children:(0,i.jsx)(n.Link,{href:"/faq",target:"_blank",children:r3})})]})]})}let r7=tM.Ik({message:tM.Yj().trim().min(1,"Please enter a message").max(z.Kd,"Message is too long")});function ne(e){let{sendMessage:t,latestMessages:a,isSubmitting:n,textAreaRef:o,fileInputRef:c,fileUploaderProps:d,isImageUploadEnabled:u,isFileUploadEnabled:p,handlePaste:f,handleFilesSelected:x,maxFileSizeInMb:v=15,showScreenshotOption:b=!1,showBanner:y=!0,minRows:w}=e,E=(0,S.d)("md"),C=(0,m.kH)(m.Q_),[B,T]=(0,g.useState)(!1),I=(0,g.useRef)(null),R=(0,g.useRef)(null),M=null!=o?o:R,D=(0,g.useRef)(null),{modality:O,setModality:P,mode:U,setMode:F}=(0,N.g)((0,k.k)(e=>({modality:e.modality,setModality:e.setModality,mode:e.mode,setMode:e.setMode}))),[,G]=$(),[H,V]=(0,h.fp)(Y.A),W=H.length>0,{location:J}=(0,eV.G)(),q=(0,s8.mN)({resolver:(0,sX.u)(r7),defaultValues:{message:""},mode:"onChange"}),{register:K,handleSubmit:X,reset:Z,watch:et,formState:ea}=q,ei=et("message","");(0,g.useEffect)(()=>{C||(s3().then(e=>new Promise((t,a)=>{let i=e.transaction(s2,"readonly").objectStore(s2).get(s4);i.onsuccess=()=>{var a;e.close(),t(null!=(a=i.result)?a:null)},i.onerror=()=>{e.close(),a(i.error)}})).then(e=>!e||Date.now()-e.timestamp>6e5?(s6(),null):e).then(e=>{e&&(q.setValue("message",e.message,{shouldValidate:!0,shouldDirty:!0}),P(e.modality),G(e.modality),F(e.mode),s6())}),s3().then(e=>new Promise((t,a)=>{let i=e.transaction(s2,"readonly").objectStore(s2).get(s5);i.onsuccess=()=>{var a;e.close(),t(null!=(a=i.result)?a:null)},i.onerror=()=>{e.close(),a(i.error)}})).then(e=>!e||Date.now()-e.timestamp>6e5?(s9(),null):e.attachments.map(e=>{let{name:t,type:a,blob:i}=e,s=new File([i],t,{type:a});return{file:s,preview:a.startsWith("image/")?URL.createObjectURL(s):void 0}})).then(e=>{null!=e&&e.length>0&&(V(e),s9())}))},[C,q,P,G,F,V]),(0,g.useEffect)(()=>{if(null!=J&&C){var e,t,a;ei.trim()&&(e={message:ei,modality:O,mode:U,timestamp:Date.now()},s3().then(t=>new Promise((a,i)=>{let s=t.transaction(s2,"readwrite");s.objectStore(s2).put(e,s4),s.oncomplete=()=>{t.close(),a()},s.onerror=()=>{t.close(),i(s.error)}}))).catch(()=>{}),H.length>0&&0!==(t=H).length&&(a=t.map(e=>({name:e.file.name,type:e.file.type,blob:e.file})),s3().then(e=>new Promise((t,i)=>{let s=e.transaction(s2,"readwrite");s.objectStore(s2).put({timestamp:Date.now(),attachments:a},s5),s.oncomplete=()=>{e.close(),t()},s.onerror=()=>{e.close(),i(s.error)}}))).catch(()=>{})}},[J,C,ei,O,U,H]);let es=function(e){let{messageValue:t,formState:a,latestMessages:i}=e,s=(0,S.d)("md"),r=(0,N.g)(e=>e.messages),n=(0,m.kH)(e=>e.user),{hasBeenShown:l}=s0(),o=rI(),c=rT(),{shouldShowImageUploadBanner:d}=rC({formState:a,latestMessages:i,messageValue:t}),u=r$(),{shown:p}=rb();return(0,g.useMemo)(()=>{let e=0===r.length,a=e&&(null==n?void 0:n.touConsentTimestamp)==null&&t.length>=1,i=c||o||d||u||p,m=o&&s&&!l;return{showWelcomeScreen:e,showLegalCopy:a,shouldShowErrorBar:c,shouldShowVoteBar:o,shouldShowImageDisclaimer:u,shouldShowMaxAttachmentsNotification:p,shouldShowMobileVoteFtue:m,hasBarAboveForm:i}},[r.length,null==n?void 0:n.touConsentTimestamp,t.length,c,o,d,u,s,l])}({messageValue:ei,formState:ea,latestMessages:a}),er=rC({formState:ea,latestMessages:a,messageValue:ei}),en=function(e){let{isTextAreaDisabled:t,modality:a,showWelcomeScreen:i,attachments:r=[]}=e;return(0,g.useMemo)(()=>t?"Please vote to continue":a===s.Jg.IMAGE?r.length>0?"Describe how you want to edit this image":"Describe the image you want to generate":a===s.Jg.WEBDEV?i?"Describe the website or app you want to build":"Ask a follow up...":a===s.Jg.VIDEO?r.some(e=>e.file.type.startsWith("video/"))?"Describe how you want to edit this video":"Describe your video":"Ask ".concat(i?"anything":"followup",""),[t,a,i,r])}({isTextAreaDisabled:er.isTextAreaDisabled,modality:O,showWelcomeScreen:es.showWelcomeScreen,attachments:H}),el=(0,A._P)("auto-modality-enabled"),eo=(0,tg.KL)(el),ec=ee(),ed=function(e){let{modality:t,messagesLength:a}=(0,N.g)((0,k.k)(e=>({modality:e.modality,messagesLength:e.messages.length}))),{setModelAId:i,setModelBId:r}=(0,L.g)((0,k.k)(e=>({setModelAId:e.setModelAId,setModelBId:e.setModelBId}))),[,n]=$(),{showModalitySwitchModal:l}=Q();return(0,g.useCallback)(o=>{var c,d;if(o===t&&t!==s.Jg.AUTO)return a>0?void l("/"):(n(s.Jg.AUTO),i(null),r(null),void(null==e||null==(c=e.current)||c.focus()));a>0?l((0,j.PY)(o)):(n(o),null==e||null==(d=e.current)||d.focus())},[t,a,l,n,i,r,e])}(M),eu=X(async e=>{try{await t(e.message)&&Z()}catch(e){console.error("Form submission error:",e)}});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:(0,_.cn)("bg-surface-primary relative flex flex-col rounded-[0.9rem] md:items-center md:gap-2",{"gap-0 md:gap-2":es.shouldShowVoteBar}),onClick:e=>{var t;let a=e.target;a&&(a.closest("button,input,textarea,select,a,[role=button],[role=menu],[role=listbox],[contenteditable=true],[data-prevent-form-autofocus]")||null==(t=M.current)||t.focus())},children:[y&&(0,i.jsx)(rz,{formState:ea,latestMessages:a,messageValue:ei}),(0,i.jsxs)("div",{className:(0,_.cn)("bg-surface-secondary relative mx-auto min-h-0 w-full flex-none rounded-[14px] border md:mx-4",{"rounded-none rounded-b-[14px]":E&&es.hasBarAboveForm,"md:rounded-lg":es.hasBarAboveForm,"border-border-medium":B,"border-border-faint":!B}),style:{borderColor:B?"hsl(var(--border-medium))":"hsl(var(--border-faint))"},children:[(0,i.jsxs)("form",{ref:I,onSubmit:e=>void eu(e),className:(0,_.cn)("flex w-full flex-col items-start justify-center p-2",{"rounded-[calc(1rem-1px)]":E&&!es.hasBarAboveForm,"rounded-none rounded-b-[calc(1rem-1px)]":E&&es.hasBarAboveForm}),children:[(W||u||p)&&d.renderAttachments(),(0,i.jsxs)("div",{className:"flex w-full flex-col justify-between gap-5 md:gap-2",children:[(0,i.jsx)("input",{...d.getInputProps(),ref:e=>{D.current=e,c&&(c.current=e)},className:"hidden",onClick:e=>{e.stopPropagation(),e.target.value=""}}),(0,i.jsx)(rx,{...K("message",{onChange:()=>{q.trigger("message")}}),autoFocus:!E,disabled:er.isTextAreaDisabled,minRows:null!=w?w:2,maxRows:10,ref:e=>{K("message").ref(e),e&&null!==e.offsetParent&&M&&"current"in M&&(M.current=e)},autoComplete:"off",placeholder:en,onPaste:f,className:(0,_.cn)("placeholder:text-text-placeholder bg-surface-secondary max-h-[40vh] p-1 md:p-3",{"text-text-muted placeholder:text-text-muted":er.isTextAreaDisabled}),onKeyDown:e=>{if("Enter"===e.code&&!(iY.Fr||e.shiftKey||e.nativeEvent.isComposing)&&(e.preventDefault(),er.canSubmit)){var t;null==(t=I.current)||t.requestSubmit()}},onFocus:()=>T(!0),onBlur:()=>T(!1)}),(0,i.jsxs)("div",{className:"flex justify-between gap-4",children:[(0,i.jsxs)("div",{className:"mr-1 flex h-8 flex-none gap-2",children:[(0,i.jsx)(ru,{onFileSelect:()=>{var e;return null==(e=D.current)?void 0:e.click()},onFilesSelected:x,isImageUploadEnabled:u,isFileUploadEnabled:p,disabled:er.isTextAreaDisabled,showScreenshotOption:b}),eo?(0,i.jsx)(rg,{onModalitySelect:ed,disabled:n}):(0,i.jsx)(rL,{handleModalityChange:ec})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[O===i1.EEvaluationModality.VIDEO&&(0,i.jsx)("span",{className:(0,_.cn)("text-xs",{"text-interactive-negative":er.isVideoPromptTooLong,"text-text-muted tabular-nums":!er.isVideoPromptTooLong}),children:"".concat(ei.length.toLocaleString()," / ").concat(z.ue.toLocaleString())}),(0,i.jsx)(r6,{}),(0,i.jsx)(l.Button,{size:"icon",type:"submit",className:"touch-hitbox border-border-medium text-interactive-active hover:bg-surface-raised border bg-transparent",disabled:!er.canSubmit||n,children:(0,i.jsx)(r.ArrowRight,{className:"size-4"})})]})]})]}),d.isDragActive&&(0,i.jsx)("div",{className:(0,_.cn)("bg-surface-primary/90 absolute inset-[-1px] flex items-center justify-center backdrop-blur-sm transition-all duration-200",{"rounded-[calc(1rem-1px)]":E&&!es.hasBarAboveForm,"rounded-none rounded-b-[calc(1rem-1px)]":E&&es.hasBarAboveForm,"rounded-[0.6875rem]":!E}),style:{border:"2px dashed hsl(var(--interactive-active) / 0.12)"},children:(0,i.jsxs)("div",{className:"flex flex-col items-center gap-2 rounded-lg px-4 py-3",children:[(0,i.jsx)("p",{className:"text-text-primary text-sm font-medium",children:"Drop files here"}),(0,i.jsxs)("p",{className:"text-text-secondary text-center text-xs",children:["Images: PNG, JPG, JPEG, WEBP (max ",v,"MB)"]})]})}),(0,i.jsx)("div",{className:(0,_.cn)("absolute -bottom-5 flex w-full justify-center",{hidden:es.showWelcomeScreen}),children:(0,i.jsx)("p",{className:"text-text-muted whitespace-nowrap text-[10px]",children:"Inputs are processed by third-party AI and responses may be inaccurate."})})]}),(0,i.jsx)("div",{className:(0,_.cn)("absolute z-10 w-full",E?"-top-2 -translate-y-full":"-bottom-2 translate-y-full",!es.showLegalCopy&&"hidden"),inert:!es.showLegalCopy,children:(0,i.jsx)(r0,{})})]})]}),(0,i.jsx)(s1,{open:es.shouldShowMobileVoteFtue})]})}function nt(e,t,a){for(let i of t)e.updateMessage({id:i,status:s.nH.FAILED,failureReason:a})}let na=(0,g.memo)(function(e){let{variant:t}=e,{isFastModeInProgress:a,triggerFastResample:n}=function(e){let t=(0,g.useContext)(N.P),a=(0,g.useContext)(B.c),i=C();return{isFastModeInProgress:(0,N.g)(e=>e.isFastModeInProgress),triggerFastResample:(0,g.useCallback)(async()=>{let r;if(!t||t.getState().isFastModeInProgress)return;let n=t.getState(),{id:l,modality:o,lastMessageIds:c,messages:u}=n,m=u.find(e=>c.includes(e.id)&&"a"===e.participantPosition),p=u.find(e=>c.includes(e.id)&&"b"===e.participantPosition);if(!m||!p)return;d.z.capture({action:"fast_mode_button_clicked",params:{evaluation_session_id:l,modality:o,delay_variant:null!=e?e:"unknown"}});let h=t.getState().startNewStream();n.setIsFastModeInProgress(!0);try{await new Promise((e,a)=>{let i=setTimeout(()=>{r(),a(Error("Timed out waiting for session to be ready"))},15e3),s=()=>{clearTimeout(i),r(),e()},r=t.subscribe(e=>{e.canResampleMessages&&s()});t.getState().canResampleMessages&&s()})}catch(t){nt(n,[m.id,p.id],"Session was not ready in time"),n.setIsFastModeInProgress(!1),d.z.capture({action:"fast_mode_failed",params:{evaluation_session_id:l,modality:o,delay_variant:null!=e?e:"unknown",error:"session_ready_timeout"}});return}for(let e of[m,p])n.updateMessage({id:e.id,content:"",reasoning:"",status:s.nH.PENDING,modelId:null,failureReason:null,sources:[],experimental_attachments:[]});try{r=await fetch("/nextjs-api/stream/resample/".concat(l),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({modelAMessageId:m.id,modelBMessageId:p.id,strategy:"fast"})})}catch(t){nt(n,[m.id,p.id],"Fast resample request failed"),n.setIsFastModeInProgress(!1),d.z.capture({action:"fast_mode_failed",params:{evaluation_session_id:l,modality:o,delay_variant:null!=e?e:"unknown",error:t instanceof Error?t.message:"fetch_error"}});return}if(!r.ok||!r.body){let t=await r.text().catch(()=>"");nt(n,[m.id,p.id],"Fast resample request failed"),n.setIsFastModeInProgress(!1),d.z.capture({action:"fast_mode_failed",params:{evaluation_session_id:l,modality:o,delay_variant:null!=e?e:"unknown",error:t||"resample_response_".concat(r.status)}});return}let g=r.body.getReader(),f=!1,x=!1,v=e=>{let a="a"===e?m.id:p.id;return t.getState().messages.find(e=>e.id===a)};try{await e5(g,{signal:h.signal,onTextChunk:(e,a)=>{let i=v(e);if(!i)return;let s="string"==typeof i.content?i.content:"";t.getState().updateMessage({id:i.id,content:s+a})},onReasoningChunk:(e,a)=>{var i;let s=v(e);s&&t.getState().updateMessage({id:s.id,reasoning:(null!=(i=s.reasoning)?i:"")+a})},onSourceChunk:(e,a)=>{var i;let s=v(e);if(!s)return;let r=Array.isArray(a)?a:[...null!=(i=s.sources)?i:[],a];t.getState().updateMessage({id:s.id,sources:r})},onImageChunk:(e,a)=>{var i,s;let r=v(e);r&&t.getState().updateMessage({id:r.id,experimental_attachments:[...null!=(i=r.experimental_attachments)?i:[],{url:a.image,contentType:null!=(s=a.mimeType)?s:"image/png"}]})},onRoutedModelChunk:(e,a)=>{var i;let s=v(e);s&&t.getState().updateMessage({id:s.id,metadata:{...null!=(i=s.metadata)?i:{},routedModelOrganization:a.organization}})},onVideoChunk:()=>{},onWebDevChunk:()=>{},onFinish:r=>{let n=v(r);n&&(t.getState().updateMessage({id:n.id,status:s.nH.SUCCESS}),"a"===r?f=!0:x=!0,f&&x&&(t.getState().setIsFastModeInProgress(!1),i&&(null==a||a.getState().updateStatus(l,"success")),d.z.capture({action:"fast_mode_completed",params:{evaluation_session_id:l,modality:o,delay_variant:null!=e?e:"unknown"}})))},onError:(r,n)=>{let c=v(r);c&&(t.getState().updateMessage({id:c.id,status:s.nH.FAILED,failureReason:null!=n?n:null}),t.getState().setIsFastModeInProgress(!1),i&&(null==a||a.getState().updateStatus(l,"error")),d.z.capture({action:"fast_mode_failed",params:{evaluation_session_id:l,modality:o,delay_variant:null!=e?e:"unknown",error:null!=n?n:"Stream error"}}))}})}catch(e){nt(n,[m.id,p.id],"Fast resample stream failed"),n.setIsFastModeInProgress(!1)}},[t,a,i,e])}}(t);return a?null:(0,i.jsx)("div",{className:"mt-4 flex w-full flex-col items-center gap-3 px-4",children:(0,i.jsxs)(l.Button,{variant:"outline",size:"md",onClick:()=>void n(),className:"border-border-faint bg-surface-primary shrink-0",children:[(0,i.jsx)(r.Zap,{className:"text-interactive-warning size-4"}),"Get fast response"]})})});function ni(e){let{checkpointInView:t,lastMessagesArr:a}=e,i=(0,N.g)((0,k.k)(e=>({lastMessageIds:e.lastMessageIds,hasViewedLatestResponses:e.hasViewedLatestResponses,setHasViewedLatestResponses:e.setHasViewedLatestResponses})));(0,g.useEffect)(()=>{var e;0!==i.lastMessageIds.length&&0!==a.length&&!i.hasViewedLatestResponses&&t&&(null==(e=a[0])?void 0:e.role)!==s.PG.USER&&a.every(e=>[s.nH.SUCCESS,s.nH.FAILED].includes(e.status))&&i.setHasViewedLatestResponses(!0)},[i,t,a])}function ns(){let e=(0,N.g)(e=>e.autoModalityMetadata),t=(0,N.g)(e=>e.messages),{latestMessages:a}=sr(),{dismissed:i}=function(){let[e,t]=(0,h.fp)(sG);return{dismissed:e,dismiss:(0,g.useCallback)(()=>{t(!0)},[t]),reset:(0,g.useCallback)(()=>{t(!1)},[t])}}(),r=(0,g.useRef)(!1),n=(0,N.g)(e=>e.id),l=(0,g.useMemo)(()=>!(!e||!e.shouldShowModalitySuggestion||i||t.filter(e=>e.role===s.PG.USER).length>1||a.some(e=>e.status===s.nH.FAILED)),[e,i,a,t]);if(l&&!r.current){var o;d.z.capture({action:"auto_modality_suggestion_shown",params:{evaluation_session_id:n,suggested_modalities:[...null!=(o=null==e?void 0:e.suggestedModalities)?o:[]].sort().join(",")}})}return r.current=l,l}function nr(){let{dismiss:e}=rZ((0,N.g)(e=>e.modality));return(0,i.jsxs)("div",{className:"bg-surface-primary border-border-faint mx-auto flex w-full max-w-screen-xl items-center justify-between gap-3 rounded-xl border p-3 shadow-sm",children:[(0,i.jsxs)("p",{className:"text-text-primary text-xs font-medium sm:text-sm",children:[(0,i.jsx)("span",{className:"sm:hidden",children:"Chat history won't carry over to new conversations"}),(0,i.jsx)("span",{className:"hidden sm:inline",children:"Previous chat history will not be carried over to new conversations"})]}),(0,i.jsx)(l.Button,{variant:"primary",size:"sm",className:"flex-shrink-0",onClick:e,children:"Got it"})]})}function nn(e,t,a){let{pairwiseFeedbacks:i,mode:r,modality:n}=(0,N.g)((0,k.k)(e=>({pairwiseFeedbacks:e.pairwiseFeedbacks,mode:e.mode,modality:e.modality})));return(0,g.useMemo)(()=>{var l;return n===s.Jg.IMAGE||n===s.Jg.VIDEO?null:[s.lY.DIRECT].includes(r)?"a":(null==a||null==(l=a.get("a"))?void 0:l.pairwiseFeedbackId)!=null?null:null!=e&&"win"===sa(e,i)?"a":null!=t&&"win"===sa(t,i)?"b":null},[n,r,a,e,t,i])}function nl(e,t,a,i){if(i===s.Jg.WEBDEV)return{shouldShowA:null!=t,shouldShowB:null!=a,shouldRenderBoth:null!=t&&null!=a};let r=null!=t&&(null==a||"b"!==e),n=null!=a&&(null==t||"a"!==e);return{shouldShowA:r,shouldShowB:n,shouldRenderBoth:r&&n}}function no(e){let{messageA:t,messageB:a,firstMessageMap:n,showFeedbackPrompt:o}=e,c=(0,N.g)(e=>e.mode),[d,u]=(0,g.useState)(!1),m=nn(t,a,n),p=function(e,t,a,i){if(null!=e&&i!==s.lY.DIRECT)return"a"===e?a:t}(m,t,a,c);return(0,i.jsxs)("div",{className:"w-full",children:[o&&(0,i.jsxs)("div",{className:"flex w-full flex-col items-center py-4 text-center",children:[(0,i.jsx)("h3",{className:"text-text-primary text-2xl",children:"Please provide your feedback"}),(0,i.jsxs)("p",{className:"text-text-secondary text-sm",children:["Your feedback helps us improve your experience."," ",(0,i.jsx)("a",{href:"https://help.arena.ai/articles/8949646387-lmarena-experiments-battles-in-direct",target:"_blank",rel:"noopener noreferrer",className:"text-interactive-link hover:text-interactive-link-hover hover:underline",children:"Learn more"})]})]}),(0,i.jsx)(nd,{messageA:t,messageB:a,selectedMessage:m}),p&&(0,i.jsxs)("div",{className:"mx-auto max-w-[800px] pt-4",children:[(0,i.jsxs)(l.Button,{variant:"outline",className:"gap-2 rounded-md",onClick:()=>u(!0),children:[(0,i.jsx)(r.ChatLines,{size:18}),(0,i.jsx)("span",{children:"See other response"})]}),(0,i.jsx)(sp,{renderExpandedMessage:d,setRenderExpandedMessage:u,message:p})]})]})}function nc(e){let{messageA:t,messageB:a,selectedMessage:r}=e,n=(0,N.g)(e=>e.modality),{shouldShowA:l,shouldShowB:o}=nl(r,t,a,n),c=n===s.Jg.WEBDEV;return(0,i.jsxs)("div",{className:(0,_.cn)("flex min-w-0",c?"flex-col gap-2":"flex-col gap-2 lg:flex-row lg:gap-3"),children:[l&&t&&(0,i.jsx)(sj,{message:t,selectedMessage:r,messageLayoutMode:"container",className:(0,_.cn)({"max-w-full":c,"lg:max-w-[768px]":!c&&!o})},"agent-a--message"),o&&a&&(0,i.jsx)(sj,{message:a,selectedMessage:r,messageLayoutMode:"container",className:(0,_.cn)({"max-w-full":c,"lg:max-w-[768px]":!c&&!l})},"agent-b--message")]})}function nd(e){let{messageA:t,messageB:a,selectedMessage:s}=e,r=(0,N.g)(e=>e.modality),n=(e=>{let[t,a]=e;return(0,N.g)((e=>{let[t,a]=e,i="string"==typeof t?t:null==t?void 0:t.id,s="string"==typeof a?a:null==a?void 0:a.id;return(0,tA.Mz)([e=>e.pairwiseFeedbacks],e=>e.some(e=>e.messageAId===i||e.messageBId===s))})([t,a]))})([t,a]),{shouldShowA:l,shouldShowB:o,shouldRenderBoth:c}=(0,g.useMemo)(()=>nl(s,t,a,r),[s,t,a,r]),d=!n||iY.xl,u=(0,g.useCallback)(e=>iY.Fr&&c&&(e.canScrollNext()||e.canScrollPrev()),[c]);return(0,i.jsxs)(sD,{opts:{watchDrag:u,duration:15},messageA:t,messageB:a,children:[(0,i.jsxs)(sO,{className:"@container/carousel",children:[l&&t&&(0,i.jsx)(nu,{message:t,selectedMessage:s,isRenderingAlone:!o},"agent-a-message"),o&&a&&(0,i.jsx)(nu,{message:a,selectedMessage:s,isRenderingAlone:!l},"agent-b-message")]}),d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(sz,{className:"left-2 drop-shadow",variant:"secondary",hideOnDisable:!0}),(0,i.jsx)(sL,{className:"right-2 drop-shadow",variant:"secondary",shouldDim:n,hideOnDisable:!0})]}),(0,i.jsx)(sU,{messageA:t,messageB:a})]})}function nu(e){let{message:t,selectedMessage:a,isRenderingAlone:s}=e;return(0,i.jsx)(sP,{isRenderingAlone:s,className:s?"max-w-[800px]":"@[752px]/carousel:basis-1/2 basis-[calc(100%-theme(spacing.8))]",children:(0,i.jsx)(sj,{message:t,selectedMessage:a,messageLayoutMode:"container"})})}var nm=a(81673);function np(e){let{mode:t}=e,a=(0,nm.m)(),[r]=(0,g.useState)(t8()),[n]=(0,g.useState)(t8());return(0,i.jsxs)("div",{className:(0,_.cn)("flex gap-4 p-4 duration-500",{"animate-in fade-in":a,"opacity-0":!a}),children:[(0,i.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:r.map(e=>(0,i.jsx)(iW.E,{className:e.className},e.id))}),[s.lY.DIRECT].includes(t)?null:(0,i.jsx)("div",{className:"flex flex-1 flex-col gap-4",children:n.map(e=>(0,i.jsx)(iW.E,{className:e.className},e.id))})]})}function nh(){let e=(0,N.g)(e=>e.modality),t=rw(),a=e===s.Jg.VIDEO;return t.isRateLimited&&a?(0,i.jsx)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-center sm:gap-4",children:(0,i.jsx)("p",{className:"text-interactive-negative text-center text-xs font-medium sm:text-left sm:text-sm",children:"Looks like you've hit today's video limit. Check back in ".concat(t.timeRemaining,".")})}):null}function ng(){let{mode:e,modality:t}=(0,N.g)((0,k.k)(e=>({mode:e.mode,modality:e.modality}))),a=t===s.Jg.VIDEO,r=e===s.lY.BATTLE;return!a||r?null:(0,i.jsx)("div",{className:"flex w-full flex-col gap-3 sm:flex-row sm:items-center sm:justify-center sm:gap-4",children:(0,i.jsx)("p",{className:"text-interactive-negative text-center text-xs font-medium sm:text-left sm:text-sm",children:"Non-battle modes are not currently available for video generation."})})}let nf=[{icon:r.Camera,label:"Generate Image",tooltip:"Generate Image",modality:s.Jg.IMAGE},{icon:r.Globe,label:"Search the Web",tooltip:"Search the Web",modality:s.Jg.SEARCH},{icon:r.ImagePlus,label:"Edit an Image",tooltip:"Upload an image to edit",modality:"EDIT_IMAGE"},{icon:r.Code,label:"Build something",tooltip:"Build something",modality:s.Jg.WEBDEV}];function nx(e){let{focusInput:t,openFilePicker:a}=e,r=(0,N.g)(e=>e.setModality),n=(0,N.g)(e=>e.mode),[o,c]=$();return(0,i.jsx)(sE.N,{initial:!1,children:o===s.Jg.CHAT&&n===s.lY.BATTLE&&(0,i.jsx)(sk.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"no-scrollbar flex flex-row items-start gap-2 overflow-x-auto sm:flex-wrap sm:items-center sm:justify-center",children:(0,i.jsx)("div",{className:"flex w-full shrink-0 flex-nowrap items-center justify-start gap-2 pl-4 sm:flex-wrap sm:justify-center sm:pl-0 sm:pr-0",children:(0,i.jsx)("div",{className:"flex w-auto shrink-0 flex-nowrap items-center gap-2 pr-4 sm:w-full sm:flex-wrap sm:justify-center",children:nf.map((e,n)=>{let o=e.icon;return(0,i.jsxs)(l.Button,{variant:"outline",size:"md",onClick:()=>(e=>{let i="EDIT_IMAGE"===e?s.Jg.IMAGE:e;d.z.capture({action:"modality_suggestion_button_click",params:{extendedModality:e}}),r(i),c(i),"EDIT_IMAGE"===e&&a?a():t&&t()})(e.modality),className:"bg-surface-primary shrink-0",children:[(0,i.jsx)(o,{className:"size-4"}),e.label]},n)})})})})})}var nv=a(54759),nb=a(84990);let ny=[{label:"2048 Game",prompt:"Build a 2048 game with grid sliding, tile merging, score tracking, best score persistence, and smooth tile animations."},{label:"Asteroids Clone",prompt:"Create an Asteroids game with ship rotation, thrust, shooting, asteroid splitting, screen wrap, and particle explosions."},{label:"Breakout Clone",prompt:"Build a Breakout game with paddle control, brick layers, ball physics, power-ups, lives system, and level progression."},{label:"Centipede Clone",prompt:"Build a Centipede game with segmented enemy that splits when shot, mushroom field obstacles, spider enemies, and progressive difficulty waves."},{label:"Dig Dug Clone",prompt:"Build a Dig Dug game with tunnel digging, pump-to-inflate enemies, rock dropping mechanics, score multipliers, and underground maze navigation."},{label:"Flappy Bird Clone",prompt:"Build Flappy Bird with tap-to-fly, pipe obstacles, score tracking, collision detection, and smooth gravity physics."},{label:"Frogger Clone",prompt:"Build a Frogger game with a frog crossing roads and rivers, traffic patterns, floating logs, lily pad safe zones, and smooth hopping animation."},{label:"Galaga Clone",prompt:"Build a Galaga-style shooter with fixed player position, swooping enemy formations, capture mechanics, dual-ship power-up, and bonus stages."},{label:"Geometry Shooter",prompt:"Build a Geometry Wars-style twin-stick shooter with neon shapes, particle explosions, score multipliers, enemy variety, and intense visual effects."},{label:"Missile Command",prompt:"Create a Missile Command game with incoming missiles, crosshair targeting, explosion radius defense, multiple cities to protect, and escalating attack patterns."},{label:"Pac-Man Clone",prompt:"Create Pac-Man with maze navigation, ghost AI patterns, power pellets, fruit bonuses, lives system, and classic sound visualizations."},{label:"Q*bert Clone",prompt:"Build a Q*bert game with isometric cube pyramid, color-changing hops, enemy patterns, disc teleporters, and bouncing character animation."},{label:"River Raid Clone",prompt:"Create a River Raid game with vertical scrolling river, fuel management, bridge targets, enemy variety, and narrow passage navigation."},{label:"Space Invaders",prompt:"Create Space Invaders with marching aliens, shields, UFO bonus, increasing speed, and pixel-perfect collision."},{label:"Snake Game",prompt:"Build classic Snake with grid movement, food spawning, growing tail, self-collision, wall options, and speed increase."},{label:"Tetris Clone",prompt:"Build Tetris with piece rotation, line clearing, ghost piece, hold queue, next preview, and increasing speed."},{label:"Bubble Chain",prompt:"Build a Zuma-style game with marble chain on a track, ball shooting insertion, color matching, chain elimination, and path-following enemy approach."},{label:"Color Flood",prompt:"Create a color flood puzzle where clicking changes corner color to spread, move limit challenge, board size options, and victory animation."},{label:"Connect Four",prompt:"Create Connect Four with disc dropping, win detection, turn indicator, and animated falling pieces."},{label:"Hidden Object Scene",prompt:"Create a hidden object game with detailed scene illustration, item list to find, hint system, timer challenge, and item highlight on discovery. Pre-populated with sample scene."},{label:"Lights Out Puzzle",prompt:"Create a Lights Out puzzle with a grid of illuminated buttons where clicking toggles adjacent lights, multiple grid sizes, move counter, and celebration when solved."},{label:"Match-3 Game",prompt:"Build a match-3 game with gem swapping, cascade effects, special gems, score combos, and satisfying clear animations."},{label:"Memory Match",prompt:"Build a memory card game with flip animations, match detection, move counter, timer, and multiple themes."},{label:"Nonogram Puzzle",prompt:"Create a Picross/Nonogram puzzle with grid, row/column hints, mistake marking, and picture reveal. Pre-loaded with sample puzzles."},{label:"Peggle Clone",prompt:"Create a Peggle-style game with ball launch aiming, bouncing physics, peg clearing, score multipliers, bucket catch bonus, and satisfying peg-hit effects."},{label:"Pipe Dream",prompt:"Build a Pipe Dream puzzle where players rotate pipe segments to create a connected path before water flows, with countdown timer and level progression."},{label:"Rope Cutter",prompt:"Create a physics puzzle game with swinging objects, rope-cutting mechanics, star collection, and level progression."},{label:"Rush Hour Puzzle",prompt:"Build a Rush Hour sliding block puzzle with cars and trucks, grid movement constraints, exit goal, move counter, and level progression."},{label:"Sliding Puzzle",prompt:"Create a 15-puzzle with tile sliding, shuffle, move counter, timer, and solved state detection."},{label:"Sokoban Puzzle",prompt:"Build a Sokoban box-pushing puzzle with grid movement, crate pushing, goal targets, move counter, undo feature, and level progression."},{label:"Spot the Difference",prompt:"Build a spot-the-difference game with two side-by-side images, click-to-mark differences, difference counter, and timer mode. Uses generated patterns."},{label:"Sudoku",prompt:"Build Sudoku with 9x9 grid, number input, conflict highlighting, hints, difficulty levels, and auto-solve visualization."},{label:"Tangram Puzzle",prompt:"Create a tangram puzzle with draggable/rotatable geometric pieces, silhouette targets to fill, snap-to-fit detection, and multiple puzzle levels."},{label:"Tower of Hanoi",prompt:"Build a Tower of Hanoi puzzle with draggable disks, three pegs, move validation, optimal move counter, and auto-solve visualization."},{label:"Word Search",prompt:"Build a word search with letter grid, word list, highlight found words, timer, and category themes. Pre-populated with sample puzzle."},{label:"Wordle Clone",prompt:"Create Wordle with 5-letter guesses, color feedback, keyboard tracking, streak counter, and share results."},{label:"Battleship",prompt:"Create a Battleship game with ship placement phase, attack grid, hit/miss markers, ship sinking animations, and fog of war."},{label:"Blackjack",prompt:"Create Blackjack with deal animations, hit/stand, betting chips, dealer AI, and card counting display."},{label:"Checkers",prompt:"Create a checkers game with piece movement rules, jump captures, king promotion, multi-jump chains, and smooth piece sliding."},{label:"Chess Game",prompt:"Create a chess game with legal move highlighting, piece capture, check/checkmate detection, move history, and optional computer opponent."},{label:"Dots and Boxes",prompt:"Build a Dots and Boxes game with click-to-draw lines, box claiming when completed, score tracking, AI opponent, and color-coded territory."},{label:"Ludo Board",prompt:"Build a Ludo game with dice rolling, safe zones, token capturing, home stretch, multiple colored pieces, and turn-based play."},{label:"Mahjong Solitaire",prompt:"Build Mahjong Solitaire with tile layouts, matching pairs, free tile highlighting, shuffle option, hint system, and tile removal animations."},{label:"Minesweeper",prompt:"Build Minesweeper with grid reveal, flag marking, mine counter, timer, difficulty settings, and first-click safety."},{label:"Nine Men's Morris",prompt:"Create Nine Men's Morris with piece placement phase, mill formation, piece capture, movement phase, and win condition detection."},{label:"Nim Game",prompt:"Build Nim with multiple piles, take-any-amount rules, AI opponent with optimal strategy, visual pile representation, and win/lose detection."},{label:"Reversi Game",prompt:"Create a Reversi/Othello game with piece flipping animations, valid move highlighting, score display, AI opponent, and chain-flip animations."},{label:"Snakes and Ladders",prompt:"Create Snakes and Ladders with dice rolling, token movement, ladder climbing, snake sliding, multiple players, and animated piece movement."},{label:"Solitaire",prompt:"Build Klondike Solitaire with card dragging, auto-complete, undo, timer, move counter, and win animation."},{label:"Spider Solitaire",prompt:"Create Spider Solitaire with multiple suits, card stacking, completed run removal, deal from deck, difficulty levels, and smooth card animations."},{label:"Tic-Tac-Toe",prompt:"Create Tic-Tac-Toe with X/O placement, win detection, draw handling, and optional AI opponent."},{label:"War Card Game",prompt:"Create the card game War with automatic card flipping, battle comparisons, war tie-breaker, deck tracking, and victory celebration."},{label:"Air Hockey",prompt:"Create an air hockey game with paddle controls, puck physics, goal detection, score tracking, AI opponent, and smooth gliding animations."},{label:"Artillery Duel",prompt:"Build an artillery game with trajectory aiming, power adjustment, wind factor, terrain destruction, turn-based shots, and explosion effects."},{label:"Barrel Climber",prompt:"Create a Donkey Kong-style game with platform climbing, rolling barrel obstacles, ladder mechanics, hammer power-up, and rescue objective."},{label:"Bowling Alley",prompt:"Create a bowling game with ball aiming, power meter, spin control, pin physics, strike/spare detection, and satisfying pin scatter animations."},{label:"Button Olympics",prompt:"Build a Track & Field-style game with rapid button mashing, timing-based events, sprint/jump/throw disciplines, and medal rankings."},{label:"Carrom Board",prompt:"Build a carrom game with striker flicking, disc pocketing, queen capture rules, turn alternation, and smooth sliding physics."},{label:"Crokinole",prompt:"Build a crokinole disc-flicking game with finger-flick controls, disc physics, scoring zones, two-player turns, and satisfying board collisions."},{label:"Curling Game",prompt:"Create a curling game with stone sliding physics, sweeping mechanics, target house, turn-based play, and realistic ice friction."},{label:"Darts Game",prompt:"Build a darts game with aiming reticle, throw power, dart flight physics, dartboard scoring zones, 501/301 game modes, and dart wobble animations."},{label:"Free Throw",prompt:"Build a basketball free throw game with arc trajectory, swipe shooting, rim physics, swish detection, and streak counter."},{label:"Garden Defense",prompt:"Create a Plants vs Zombies-style lane defense with plantable defenders, resource collection, enemy waves, special abilities, and lawn grid strategy."},{label:"Marble Racing",prompt:"Create a marble racing game with track obstacles, marble physics, lane switching, speed boosts, finish line, and race position tracking."},{label:"Mini Golf Course",prompt:"Create a mini golf game with multiple hole course, aim and power controls, obstacle hazards, stroke counter, par tracking, and ball physics."},{label:"Paper Toss",prompt:"Build a paper toss game with swipe-to-throw, wind indicator, distance calculation, trash can target, streak tracking, and crumpled paper physics."},{label:"Penalty Kicks",prompt:"Create a penalty shootout game with aim cursor, power meter, goalkeeper AI, save animations, score tracking, and sudden death rounds."},{label:"Pinball Machine",prompt:"Build a retro pinball machine with flipper controls, ball physics, bumpers with bounce effects, score multipliers, multiball mode, and flashing lights."},{label:"Pool Table",prompt:"Create a 2D billiards game with cue stick aiming, power slider, realistic ball physics, pocket detection, ball spin effects, and smooth collision animations."},{label:"Shuffleboard",prompt:"Build a shuffleboard game with puck sliding physics, scoring zones, friction simulation, two-player turns, and knock-off mechanics."},{label:"Ski Slalom",prompt:"Build a ski slalom game with downhill slope, gate weaving, speed control, time tracking, missed gate penalties, and snow spray effects."}],nw=[{label:"Ant Colony Simulation",prompt:"Design an ant colony simulation with pheromone trails, food gathering behavior, multiple ant types, obstacle placement, and colony statistics. Auto-starts with visible demo."},{label:"Autumn Leaves",prompt:"Build falling autumn leaves with wind drift, spinning rotation, color variations, pile accumulation, and peaceful seasonal atmosphere. Auto-starts."},{label:"Boids Flocking",prompt:"Create a mesmerizing flocking simulation with thousands of birds/fish following simple rules to create emergent group patterns. Auto-starts."},{label:"Butterfly Garden",prompt:"Create an animated butterfly scene with fluttering wing physics, flower landing, species variety, and gentle breeze effects."},{label:"Campfire Flames",prompt:"Build a realistic fire simulation with flickering flames, ember particles rising, heat distortion effect, and adjustable intensity. Auto-starts."},{label:"Dandelion Seeds",prompt:"Build a dandelion simulation where clicking releases floating seeds that drift on wind currents, with gentle turbulence and peaceful atmosphere."},{label:"Desert Sandstorm",prompt:"Build a sandstorm simulation with swirling particles, visibility reduction, dune formation, intensity controls, and dramatic desert atmosphere. Auto-starts."},{label:"Flower Blooming",prompt:"Create a time-lapse flower blooming animation with petal unfolding, stamen reveal, color transitions, and multiple flower types. Auto-starts."},{label:"Fractal Tree Growth",prompt:"Build an animated fractal tree with recursive branching, leaf sprouting, seasonal color changes, wind sway, and growth speed controls. Auto-starts."},{label:"Growing Vines",prompt:"Create a vine growth animation with tendril curling, leaf sprouting, wall climbing, flower blooming, and organic spreading pattern. Auto-starts."},{label:"Lightning Storm",prompt:"Build a lightning generator with branching bolt algorithms, flash illumination, cloud backdrop, strike timing variation, and dramatic sky lighting effects."},{label:"Ocean Waves",prompt:"Create an ocean wave simulation with rolling swells, foam crests, shore breaking, tidal rhythm, and peaceful seaside atmosphere. Auto-starts."},{label:"Rain on Window",prompt:"Create a realistic rain on window simulation with droplets forming, sliding down with gravity, merging when they meet, variable intensity, and lightning flashes."},{label:"Rolling Fog",prompt:"Create a rolling fog simulation with dense cloud movement, depth layers, reveal/conceal effect, and atmospheric mystery. Auto-starts."},{label:"Smoke Plume",prompt:"Create a smoke simulation with rising particle clouds, wind drift, dissipation over time, color variations, and density controls. Auto-starts."},{label:"Snowfall Scene",prompt:"Build a snowfall animation with varied flake sizes, wind drift, accumulation, parallax depth, and peaceful winter atmosphere."},{label:"Snowflake Growth",prompt:"Create a snowflake crystal formation with branching growth algorithm, hexagonal symmetry, frost patterns, and time-lapse crystallization."},{label:"Tornado Vortex",prompt:"Build a tornado simulation with swirling debris particles, funnel cloud shape, dust at the base, varying intensity levels, and camera shake effect."},{label:"Waterfall Cascade",prompt:"Create a waterfall simulation with cascading water particles, mist spray, rock formations, pool splashing, and rainbow in the mist effect. Auto-starts."},{label:"Wheat Field",prompt:"Build a wheat field with wind wave patterns, golden stalks swaying, mouse-wind interaction, and relaxing countryside atmosphere. Auto-starts."},{label:"Aurora Borealis",prompt:"Build a northern lights animation with flowing curtains, color shifts, star background, horizon glow, and peaceful night sky."},{label:"Comet Trail",prompt:"Build a comet animation with icy nucleus, dust tail, ion tail, orbital path, starfield background, and approaching-sun brightening. Auto-starts."},{label:"Conway's Game of Life",prompt:"Create Conway's Game of Life with pattern drawing, speed control, preset patterns (glider, spaceship), and generation counter. Auto-starts with demo pattern."},{label:"Galaxy Spiral",prompt:"Build a spiral galaxy simulation with rotating star particles, dust lanes, central core glow, zoom controls, and billions-of-stars effect. Auto-starts."},{label:"Geyser Eruption",prompt:"Build a geyser simulation with pressure buildup, dramatic eruption, steam clouds, water spray, periodic timing, and geological wonder. Auto-starts."},{label:"Lava Lamp",prompt:"Build a mesmerizing lava lamp simulation with rising and falling blobs, liquid physics, color temperature controls, and ambient glow effects. Auto-starts."},{label:"Matrix Rain",prompt:"Create the Matrix digital rain with falling characters, varying speeds, trail fade, and green phosphor glow."},{label:"Particle Fireworks",prompt:"Build a fireworks display with click-to-launch rockets, particle explosions, color variety, trails, and grand finale mode."},{label:"Solar Flare",prompt:"Create a solar flare animation with plasma eruptions, magnetic field lines, coronal loops, sunspot activity, and dramatic stellar surface. Auto-starts."},{label:"Starfield Parallax",prompt:"Build a parallax starfield with multiple depth layers, shooting stars, nebula clouds, and warp speed effect."},{label:"Wormhole Tunnel",prompt:"Create a wormhole tunnel effect with swirling vortex, perspective depth, color shifting, speed controls, and dramatic space travel visuals. Auto-starts."},{label:"Flow Field",prompt:"Create a flow field visualization with Perlin noise, particle streams following vector fields, color gradients, and adjustable turbulence. Auto-starts."},{label:"Lissajous Curves",prompt:"Create animated Lissajous curves with adjustable frequency ratios, phase shifts, trail effects, and mesmerizing parametric patterns. Auto-starts."},{label:"Metaball Blobs",prompt:"Build a metaball simulation with merging blob shapes, mouse-attracted movement, color gradients, and organic motion. Auto-starts."},{label:"Moir\xe9 Patterns",prompt:"Build a moir\xe9 pattern generator with overlapping grids, rotation controls, spacing adjustment, and hypnotic interference effects. Auto-starts."},{label:"Pendulum Waves",prompt:"Create a pendulum wave with multiple pendulums of different lengths creating mesmerizing patterns. Auto-starts with visible demo."},{label:"Reaction Diffusion",prompt:"Build a reaction-diffusion pattern generator with organic growth patterns, feed/kill rate controls, multiple color schemes, and mesmerizing evolution. Auto-starts."},{label:"Spirograph Machine",prompt:"Build an automated spirograph that draws hypnotic geometric patterns with adjustable gear ratios, pen position, color gradients, and drawing speed. Auto-starts."},{label:"Bouncing DVD Logo",prompt:"Create the classic bouncing DVD screensaver with color change on corner hits, corner hit counter, and multiple logo mode."},{label:"Cloth Simulation",prompt:"Simulate flag-like cloth rippling in wind with pin/unpin points, adjustable wind, and pause/reset controls."},{label:"Disco Ball",prompt:"Create a disco ball simulation with rotating mirror facets, light beam projections, color cycling, dance floor reflections, and party atmosphere. Auto-starts."},{label:"Domino Rally",prompt:"Build a domino chain reaction simulator with click-to-place dominoes, adjustable spacing, curved path support, trigger button, and slow-motion replay."},{label:"Dripping Paint",prompt:"Build a paint drip simulation with viscous liquid physics, color mixing, canvas pooling, and satisfying drip formations. Auto-starts with demo."},{label:"Falling Sand",prompt:"Build a falling sand simulation with multiple materials (sand, water, fire), element interactions, and brush sizes."},{label:"Jellyfish Tank",prompt:"Create a jellyfish aquarium with pulsing bell animations, trailing tentacles, bioluminescent glow, gentle drifting movement, and multiple species. Auto-starts."},{label:"Stadium Wave",prompt:"Build a stadium crowd wave with sequential standing, arm raising, section timing, wave speed controls, and sports arena atmosphere. Auto-starts."},{label:"Traffic Flow",prompt:"Create a traffic simulation with car spawning, intersection management, traffic light timing, congestion visualization, and flow optimization controls. Auto-starts."}],nj=[{label:"Balancing Bird",prompt:"Build a balancing bird toy with fingertip balance point, wing counterweights, tilt response, and physics-defying equilibrium demonstration."},{label:"Bendy Straw",prompt:"Create a bendy straw sculpture with poseable segments, snap connections, colorful tubes, freeform art building, and flexible physics."},{label:"Bubble Wrap Popper",prompt:"Design virtual bubble wrap with satisfying pop interactions, pop counter, and never-ending mode."},{label:"Clacker Balls",prompt:"Build clacker balls with string physics, momentum building, rhythm clicking, skill challenge, and that satisfying 70s toy motion."},{label:"Drinking Bird",prompt:"Create a drinking bird toy with nodding motion, fluid thermodynamics, glass dipping, and perpetual bobbing desk toy behavior."},{label:"Etch A Sketch",prompt:"Create an Etch A Sketch toy with two rotary dial controls, silver screen drawing, shake-to-clear animation, and that classic aesthetic."},{label:"Fidget Spinner",prompt:"Build a fidget spinner with realistic spin physics, momentum decay, swipe-to-spin interaction, RPM counter, and multiple spinner designs."},{label:"Fortune Fish",prompt:"Create a fortune fish toy with palm placement, curling animation based on random values, movement interpretation display, and mystical styling."},{label:"Jacob's Ladder",prompt:"Build a Jacob's Ladder ribbon toy with cascading flip animation, hold-and-release interaction, and mesmerizing tumbling effect."},{label:"Lite-Brite",prompt:"Create a Lite-Brite toy with peg placement, glowing colors, black background, pattern templates, and that classic illuminated artwork feel."},{label:"Magna Doodle",prompt:"Create a Magna Doodle with magnetic stylus drawing, stamp shapes, erase slider, gray-green screen aesthetic, and smooth line rendering."},{label:"Nesting Dolls",prompt:"Create Russian nesting dolls with click-to-open interaction, progressively smaller dolls inside, painted designs, and satisfying reveal sequence."},{label:"Pin Art",prompt:"Build a pin art toy with push-through pins, 3D impression capture, reset shake, pin density options, and satisfying depth relief effect."},{label:"Pop Tube",prompt:"Create a pop tube toy with stretch and compress, corrugated texture, satisfying accordion motion, color options, and bendy positioning."},{label:"Silly Putty",prompt:"Create digital silly putty with stretch, bounce, and snap physics, color mixing, newspaper imprint effect, and satisfying squish."},{label:"Slinky Stairs",prompt:"Build a Slinky simulation with spring physics, stair-stepping motion, stretch and compression, gravity effects, and end-over-end walking."},{label:"Water Wiggler",prompt:"Create a water wiggler tube toy with slippery grip physics, squeeze-to-squirt-away effect, glitter inside, and impossible-to-hold feel."},{label:"Wooly Willy",prompt:"Build a Wooly Willy toy with magnetic wand, iron filing particles, bald head canvas, hair/beard/eyebrow styling, and shake-to-reset."},{label:"Yo-Yo Tricks",prompt:"Create a yo-yo with throw-and-return physics, string extension, sleep at bottom, return mechanics, and trick mode (walk the dog, around the world)."},{label:"Balloon Pop",prompt:"Build an interactive balloon with inflate-on-hold, stretch physics, wobble animation, pop at max size with confetti burst, and multiple colors."},{label:"Card House",prompt:"Create a card house builder with careful placement, lean-against physics, collapse chain reaction, height tracking, and breath-holding tension."},{label:"Coin Flip",prompt:"Build a coin flip with realistic 3D flip animation, heads/tails counter, streak tracking, and satisfying result."},{label:"Ferrofluid Display",prompt:"Create a ferrofluid simulation with magnetic field response, spiky formations, magnet cursor interaction, and glossy black liquid."},{label:"Gyroscope Toy",prompt:"Build a spinning gyroscope with precession physics, tilt the base to affect balance, spin decay over time, RPM display, and gimbal visualization."},{label:"Hourglass Timer",prompt:"Create a digital hourglass with sand particle physics, accumulation at bottom, flip-to-reset gesture, multiple time presets, and mesmerizing grain flow."},{label:"Jack in the Box",prompt:"Create a jack-in-the-box toy with crank-turning interaction, building tension indicator, surprise pop animation, spring wobble, and reset mechanism."},{label:"Jenga Tower",prompt:"Build a Jenga game with block pulling, tower wobble physics, collapse detection, turn-based play, and dramatic tension as tower gets unstable."},{label:"Kinetic Sand",prompt:"Build kinetic sand with satisfying cutting, molding shapes, crumble physics, multiple colors, and that oddly satisfying slice effect."},{label:"Magnetic Poetry",prompt:"Design a magnetic poetry canvas with draggable word magnets, fridge background, and word pack themes."},{label:"Marble Run",prompt:"Build a marble run with track pieces, release trigger, marble rolling physics, funnel collectors, loop-de-loops, and multiple marble racing."},{label:"Newton's Cradle",prompt:"Build a Newton's Cradle desk toy with realistic ball physics, pull-and-release interaction, momentum transfer, adjustable ball count, and slow-motion mode."},{label:"Paddle Ball",prompt:"Create a paddle ball toy with elastic string physics, ball bounce trajectory, paddle hit detection, streak counter, and progressively faster gameplay."},{label:"Perpetual Motion",prompt:"Create a perpetual motion desk toy with swinging balls, rotating wheels, magnetic repulsion, and mesmerizing endless motion illusion."},{label:"Pick-Up Sticks",prompt:"Create pick-up sticks with scattered pile, careful removal without moving others, color scoring, turn-based play, and collision detection."},{label:"Plasma Globe",prompt:"Create a plasma globe with electrical tendrils following touch/cursor, multiple color modes, intensity controls, and satisfying static response."},{label:"Puzzle Box",prompt:"Build a Japanese puzzle box with sequence of moves to open, sliding panels, hidden compartments, and rewarding unlock animation."},{label:"Safe Cracker",prompt:"Create a safe cracking game with combination dial, click detection, tumbler feedback, multiple lock types, and vault door opening animation."},{label:"Sand Pendulum",prompt:"Build a sand pendulum with swinging motion, sand trail drawing, Lissajous patterns, adjustable parameters, and zen-like pattern creation."},{label:"Soap Bubbles",prompt:"Build a bubble blowing toy with wand dipping, cursor-drag to blow, iridescent bubble surfaces, float physics, and pop interactions."},{label:"Stress Ball",prompt:"Create a squeezable stress ball with satisfying deformation physics, squeeze-and-release animation, color change under pressure, and particle burst effects."},{label:"Tornado Tube",prompt:"Build a tornado tube connector with water vortex, swirl trigger, bubble inclusion, glitter particles, and mesmerizing water transfer."},{label:"Zoetrope",prompt:"Create a zoetrope animation wheel with spinning drum, slits for viewing, animation strip selection, speed control, and stop-motion effect."},{label:"Color Picker",prompt:"Build an advanced color picker with wheel, sliders, HEX/RGB/HSL modes, and color history."},{label:"Countdown Timer",prompt:"Build a countdown app with 3 pre-configured sample countdowns, animated display, and notifications."},{label:"Dice Roller",prompt:"Build a dice roller with multiple dice types (D4, D6, D8, D12, D20), roll history, 3D tumble animation, and total calculations."},{label:"Draw Something",prompt:"Build a simple drawing canvas with brush sizes, colors, eraser, undo, clear, and fill tool. Starts with a sample doodle."},{label:"Magic 8 Ball",prompt:"Create a Magic 8 Ball with shake interaction, floating answer reveal, and mystical styling."},{label:"Magnetic Sculpture",prompt:"Build a magnetic desktop sculpture with stackable shapes, satisfying snap connections, freeform building, and polished chrome aesthetic."},{label:"Password Generator",prompt:"Build a password generator with length slider, character toggles, strength indicator, and copy button."},{label:"Scratch Card",prompt:"Build a scratch card with scratch-to-reveal animation, prize reveal, and satisfying scratch effect."},{label:"Spin the Wheel",prompt:"Create a wheel with segments, spin physics, winner announcement, confetti, and probability weighting."},{label:"Stopwatch",prompt:"Build a stopwatch with start/stop/reset, lap times, millisecond precision, and lap history."},{label:"Unit Converter",prompt:"Create a unit converter with categories, bidirectional conversion, favorites, and copy to clipboard."},{label:"View-Master",prompt:"Build a View-Master toy with 3D stereo card viewing, click-to-advance, reel selection, that iconic red viewer design, and depth effect."}],nN=[{label:"ASCII Art Generator",prompt:"Build an ASCII art creator from text with font styles, character density, live preview, and copy to clipboard."},{label:"Avatar Creator",prompt:"Build an avatar creator with face shape, hair, eyes, accessories, skin tone picker, and live preview."},{label:"Badge Designer",prompt:"Build a circular badge/pin creator with shape layers, text on path, icon library, color schemes, and live preview."},{label:"Celtic Knot Designer",prompt:"Create a Celtic knot builder with interlacing ribbon paths, over/under weaving, symmetry modes, and color gradients. Starts with sample design."},{label:"Color Palette Generator",prompt:"Build a color palette tool with random generation, color harmony rules, copy hex values, and palette history."},{label:"Comic Panel Layout",prompt:"Build a comic strip creator with panel grid templates, speech bubbles, action lines, caption boxes, and comic book styling. Starts with demo."},{label:"Cross Stitch Pattern",prompt:"Create a cross stitch pattern maker with grid canvas, thread color palette, X-stitch rendering, pattern symbols, and fabric texture preview. Starts with sample."},{label:"CSS Gradient Builder",prompt:"Build a gradient generator with color stops, angle control, gradient types, live preview, and CSS code output."},{label:"Favicon Creator",prompt:"Create a favicon generator with text/emoji input, colors, multiple size previews, and background options."},{label:"Flag Designer",prompt:"Build a flag creator with stripe patterns, common flag layouts, symbol library (stars, crescents, crosses), color picker, and waving animation."},{label:"Flexbox Sandbox",prompt:"Design a flexbox playground with container controls, child settings, visual representation, and CSS output."},{label:"Friendship Bracelet",prompt:"Build a friendship bracelet pattern maker with thread colors, knot patterns, chevron/diamond designs, and woven preview. Starts with sample pattern."},{label:"Generative Art Studio",prompt:"Build a generative art creator with algorithm presets (fractals, flow fields), parameter sliders, and randomize button."},{label:"Glitch Art Studio",prompt:"Build a glitch art generator with data corruption effects, RGB splitting, scan lines, pixel sorting, and VHS distortion aesthetics."},{label:"Graffiti Text",prompt:"Build a graffiti text generator with bubble letters, spray paint drips, color fills, brick wall background, and urban art styling."},{label:"Heraldic Shield Designer",prompt:"Create a coat of arms builder with shield shape selection, field divisions, charge library (lions, eagles, crosses), and medieval styling. Starts with sample."},{label:"Isometric Builder",prompt:"Build an isometric pixel art tool with 3D block placement, layer depth, color picker, rotate view, and voxel-style building. Starts with sample."},{label:"Lorem Ipsum Generator",prompt:"Design a Lorem Ipsum generator with count options, different styles (hipster, corporate), and copy button."},{label:"Mandala Generator",prompt:"Design a mandala tool with radial symmetry, adjustable segments, brush options, and color palettes. Starts with a demo pattern."},{label:"Mosaic Maker",prompt:"Build a mosaic tile creator with tile palette, grid placement, grout lines, color schemes, and Roman mosaic styling. Starts with sample."},{label:"Neon Sign Generator",prompt:"Build a neon sign creator with glowing text effects, tube bending animations, color picker, flicker modes, and realistic neon glow."},{label:"Optical Illusions",prompt:"Create an interactive optical illusion showcase with classic illusions, explanations, and user interaction triggers."},{label:"Paper Airplane Lab",prompt:"Create a paper airplane designer with fold patterns, wing adjustments, flight simulation preview, distance tracking, and airplane type gallery."},{label:"Paper Snowflake",prompt:"Create a paper snowflake cutter with fold simulation, cut tool, unfold reveal, symmetry preview, and collection gallery. Starts with sample cuts."},{label:"Pattern Tiler",prompt:"Create a seamless pattern maker with shape tools, rotation, reflection symmetry, tile preview, and infinite wallpaper generation. Starts with demo."},{label:"Pixel Art Editor",prompt:"Build a pixel art editor with grid canvas, palette, pencil/fill/eraser, layers, animation frames, and preview mode. Starts with sample pixel art."},{label:"Pop Art Generator",prompt:"Build a pop art creator with Warhol-style grid, halftone dots, bold colors, contrast adjustment, and comic-book aesthetic. Starts with sample."},{label:"QR Code Generator",prompt:"Create a QR code generator with text/URL input, size options, color customization, and logo overlay."},{label:"Quilt Designer",prompt:"Build a quilt pattern maker with block templates, fabric swatches, rotation controls, symmetry options, and full quilt preview. Starts with sample."},{label:"Ransom Note",prompt:"Create a ransom note generator with cut-out letter styling, magazine font mix, paper texture, tape effects, and dramatic message builder."},{label:"Retrowave Generator",prompt:"Create a synthwave landscape with neon grid, sunset gradients, chrome text, and animated scan lines."},{label:"Shadow Generator",prompt:"Create a box shadow generator with offset, blur, spread, color, multiple layers, and copy CSS."},{label:"Stained Glass Maker",prompt:"Build a stained glass designer with shape tools, color fill, lead lines, and light simulation. Starts with a sample design."},{label:"Tessellation Maker",prompt:"Create an Escher-style tessellation tool with shape morphing, tile repetition, interlocking preview, and infinite pattern generation. Starts with demo."},{label:"Vintage Postcard",prompt:"Create a postcard designer with retro templates, stamps, postmarks, and handwritten fonts."},{label:"Watercolor Studio",prompt:"Build a watercolor painting tool with wet-on-wet blending, paper texture, water spread, pigment bleeding, and brush wetness. Starts with sample."},{label:"Wax Seal Maker",prompt:"Create a wax seal designer with monogram letters, decorative borders, seal shape options, wax color picker, and emboss preview."}],nk=[{label:"Aquarium Monitor",prompt:"Build an aquarium dashboard with tank temperature, pH levels, fish count, feeding schedule, filter status, and water quality charts. Pre-populated with sample data."},{label:"Arcade Leaderboard",prompt:"Build a retro arcade high score board with player initials, score rankings, blinking new record, cabinet styling, and attract mode. Pre-populated with sample scores."},{label:"Beehive Tracker",prompt:"Create a beehive monitoring dashboard with hive weight, bee activity graph, honey production, queen status, and seasonal patterns. Pre-populated with sample data."},{label:"Bird Watching Log",prompt:"Build a bird watching dashboard with species gallery, sighting map, seasonal migration chart, rarity indicators, and life list count. Pre-populated with sample sightings."},{label:"Collection Tracker",prompt:"Build a collection dashboard for trading cards/stamps with rarity breakdown, completion percentage, value estimation, and visual grid gallery. Pre-populated with sample items."},{label:"Crypto Portfolio",prompt:"Build a crypto tracker with coin values, sparkline charts, portfolio allocation pie chart, and 24h changes. Pre-populated with sample holdings."},{label:"Esports Command",prompt:"Build an esports tournament dashboard with live bracket view, match cards with momentum charts, team comparison radar, and schedule timeline. Pre-loaded with sample tournament."},{label:"Fitness Dashboard",prompt:"Create a fitness tracker with step chart, calories burned, workout history, heart rate zones, and weekly progress. Pre-populated with sample data."},{label:"Gaming Stats",prompt:"Create a gaming statistics dashboard with playtime charts, achievement progress, session history, and friends activity."},{label:"GitHub Contributions",prompt:"Build a contribution heatmap calendar with sample data, intensity colors, tooltips, and streak calculations."},{label:"Greenhouse Monitor",prompt:"Build a greenhouse dashboard with temperature zones, humidity gauges, light levels, irrigation status, and plant growth charts. Pre-populated with sample data."},{label:"ISS Tracker",prompt:"Build an ISS tracking dashboard with orbital position map, pass predictions, crew info display, altitude gauge, and live position indicator. Pre-populated with current data."},{label:"League Standings",prompt:"Create a sports league table with team rankings, points, goal difference, recent form indicators, promotion/relegation zones, and animated position changes. Pre-populated."},{label:"Mission Control",prompt:"Create a space mission control dashboard with rocket telemetry gauges, altitude tracker, fuel levels, trajectory visualization, and countdown display. Pre-populated with simulated data."},{label:"Moon Phase Calendar",prompt:"Build a moon phase dashboard with lunar cycle visualization, phase names, moonrise times, eclipse predictions, and zodiac positions. Pre-populated with current month."},{label:"Ocean Research",prompt:"Create an ocean research dashboard with buoy sensor cards, mini map with drifting tracks, time-series charts, storm alerts, and depth visualization. Pre-populated with sample data."},{label:"Photography Stats",prompt:"Create a photography dashboard with lens usage pie chart, aperture histogram, location map, camera body stats, and best shots gallery. Pre-populated with sample data."},{label:"Podcast Stats",prompt:"Create a podcast analytics dashboard with downloads chart, listener geography, average duration, and top episodes."},{label:"Reading Progress",prompt:"Build a reading tracker with book shelf visual, pages read chart, reading streak, genre breakdown, and yearly goal progress. Pre-populated with sample library."},{label:"Running Heat Map",prompt:"Create a running stats dashboard with route heat map overlay, pace zones, elevation profile, personal records, and weekly mileage. Pre-populated with sample routes."},{label:"Seismograph Display",prompt:"Create a seismograph dashboard with real-time wave drawing, magnitude scale, depth indicator, recent activity list, and tectonic plate map. Pre-populated with sample readings."},{label:"Solar Panel Monitor",prompt:"Build a solar energy dashboard with power output gauge, daily generation graph, weather impact, efficiency metrics, and savings tracker. Pre-populated with sample data."},{label:"Stargazing Map",prompt:"Create a stargazing dashboard with constellation finder, planet positions, meteor shower calendar, viewing conditions, and dark sky rating. Pre-populated for tonight."},{label:"Stock Dashboard",prompt:"Design a stock dashboard with candlestick charts, volume bars, moving averages, and watchlist. Pre-populated with sample data."},{label:"Tide Chart",prompt:"Create a tide times dashboard with high/low predictions, tidal curve graph, moon correlation, and surfing conditions. Pre-populated with sample location."},{label:"Tournament Bracket",prompt:"Create a tournament bracket visualizer with match progression, winner advancement, finals highlight, and animated bracket filling. Pre-populated with sample tournament."},{label:"Weather Dashboard",prompt:"Build a weather app with current conditions, hourly forecast, weekly outlook, and animated weather icons. Pre-populated with sample data."},{label:"Wind Farm Display",prompt:"Create a wind farm dashboard with turbine status indicators, power generation chart, wind speed gauges, and energy output. Pre-populated with sample farm."}],nE=[{label:"Accordion Gallery",prompt:"Create an accordion showcase with smooth expand/collapse, nested accordions, icon rotation, exclusive/multiple modes, and content reveal animations."},{label:"Badge Animations",prompt:"Build a notification badge gallery with bounce entrances, pulse effects, count-up animations, shake alerts, and satisfying clear animations."},{label:"Bottom Sheet Gallery",prompt:"Build a bottom sheet showcase with peek heights, drag-to-expand, snap points, gesture handles, and iOS/Android style variations."},{label:"Button States Gallery",prompt:"Build a gallery of satisfying button interactions with ripple effects, 3D press depth, magnetic hover, gooey morphing, and particle bursts."},{label:"Card Hover Gallery",prompt:"Build a card collection with various hover effects - lift, glow, border animations, and content reveals."},{label:"Card Shuffle Deck",prompt:"Build a playing card deck with satisfying shuffle animations (riffle, overhand, cut), card dealing, flip reveals, and fan spread display."},{label:"Checkbox Designs",prompt:"Create a checkbox showcase with custom check animations, indeterminate states, icon variations, group selections, and creative check marks."},{label:"Credit Card Form",prompt:"Create a credit card input with live card preview, flip for CVV, card type detection, expiry formatting, and satisfying validation states."},{label:"Cursor Trail Gallery",prompt:"Build a cursor effects showcase with particle trails, magnetic attraction, elastic following, rainbow ribbons, and constellation connections."},{label:"Date Picker Gallery",prompt:"Build a date picker showcase with calendar grid, range selection, disabled dates, custom styling, month navigation, and today highlighting."},{label:"Dock Magnifier",prompt:"Build a Mac-style dock with icon magnification on hover, draggable reordering, active indicators, bouncing launch animation, and folder stacks."},{label:"Drag Drop Patterns",prompt:"Build a drag-and-drop showcase with sortable lists, kanban moves, file drops, snap-to-grid, and smooth transition animations."},{label:"Dropdown Showcase",prompt:"Create a dropdown menu gallery with search filtering, multi-level nesting, icons, custom rendering, keyboard navigation, and smooth animations."},{label:"Easing Studio",prompt:"Create an easing curve studio with draggable cubic-bezier editor, live animation previews, preset comparisons, and motion trail visualization."},{label:"Elegant Clock Collection",prompt:"Build multiple beautiful clock designs - minimal analog, flip clock, word clock, binary clock - each with smooth animations."},{label:"FAB Menu Explosion",prompt:"Create a floating action button that explodes into multiple options with staggered animations, orbital positioning, and smooth collapse."},{label:"Floating Labels",prompt:"Create a form input showcase with floating label animations, focus states, validation feedback, character counts, and accessible patterns."},{label:"Image Cropper",prompt:"Build an image crop tool with aspect ratio presets, drag handles, zoom controls, rotation, and preview pane. Uses sample geometric image."},{label:"List Reorder",prompt:"Build a sortable list showcase with drag handles, placeholder gaps, smooth reposition, keyboard reorder, and position number animation."},{label:"Loading States",prompt:"Build a loading state gallery with skeleton screens, shimmer effects, spinners, progress bars, and smooth content appearance."},{label:"Masonry Gallery",prompt:"Create a masonry layout showcase with varied card sizes, smooth placement algorithm, filter transitions, and responsive breakpoints."},{label:"Modal Gallery",prompt:"Create a modal dialog showcase with different entry animations, backdrop effects, sizes, positions, and dismissal patterns."},{label:"OTP Input",prompt:"Build an OTP verification input with auto-advance between boxes, paste support, error shake, countdown timer, and resend animation."},{label:"Page Transitions",prompt:"Create a page transition gallery with morph animations, slide reveals, zoom transitions, flip effects, and liquid wipe patterns."},{label:"Parallax Cards",prompt:"Build 3D parallax cards that tilt based on mouse position, with layered depth effects, shine highlights, and shadow casting."},{label:"Pull to Refresh",prompt:"Build a pull-to-refresh showcase with different spinner styles, rubber-band physics, threshold indicators, and completion animations."},{label:"Search Animations",prompt:"Create a search bar showcase with expand-on-focus, icon morph, clear button, recent searches dropdown, and result highlighting."},{label:"Slider Gallery",prompt:"Build a slider showcase with range selectors, step markers, value tooltips, gradient tracks, thumb designs, and smooth drag interactions."},{label:"Star Rating",prompt:"Create a rating component showcase with star animations, half-star support, custom icons, hover preview, and satisfying selection feedback."},{label:"Step Wizard",prompt:"Build a stepper showcase with progress indication, step validation, icon states, vertical/horizontal layouts, and smooth transition animations."},{label:"Tag Input",prompt:"Create a tag input showcase with chip creation, backspace deletion, autocomplete, duplicate prevention, and colorful tag styling."},{label:"Toast Gallery",prompt:"Create a toast notification showcase with multiple styles, slide/fade/bounce animations, stacking behavior, progress timers, and dismiss gestures."},{label:"Toggle Collection",prompt:"Build a toggle switch showcase with iOS-style, Android-style, custom themed, animated transitions, disabled states, and satisfying interactions."},{label:"Typography Animation",prompt:"Create text animation showcase with typewriter, letter shuffle, glitch, gradient flow, and split animations."}],nA=[{label:"Ant Farm",prompt:"Build a digital ant farm with ants tunneling through dirt, carrying food, colony chambers forming, glass-case view, and tap-to-add-food interaction."},{label:"Apothecary Shop",prompt:"Build an apothecary shelf with potion bottles, ingredient jars, mortar and pestle, recipe book, and mystical herb labels."},{label:"Arctic Station",prompt:"Build an arctic research station with weather instruments, ice core samples, aurora display, penguin visitors, and frozen tundra backdrop."},{label:"Art Gallery",prompt:"Build an art gallery with framed exhibits, spotlight lighting, visitor benches, museum atmosphere, and click-to-examine artwork details."},{label:"Bonsai Trimmer",prompt:"Build a bonsai tree trimmer with branch snipping, shape sculpting, pot selection, seasonal appearance, and zen garden setting."},{label:"Candy Factory",prompt:"Build a candy factory with conveyor belts, candy machines, wrapper stations, quality control, and colorful sweet production line."},{label:"Carnival Midway",prompt:"Build a carnival midway scene with game booths, prize displays, ticket counter, flashing lights, and festive fairground atmosphere."},{label:"Circus Tent",prompt:"Create a circus big top interior with trapeze rigging, center ring, audience seating, spotlight beams, and spectacular show atmosphere."},{label:"Cloud Castle",prompt:"Create a floating cloud castle with rainbow bridges, pegasus stables, sky gardens, tower spires, and dreamy atmospheric effects."},{label:"Crystal Cave",prompt:"Create a crystal cave scene with glowing gem formations, light refraction, dripping stalactites, underground pool, and explorer's lantern."},{label:"Desert Oasis",prompt:"Create a desert oasis scene with palm trees, water pool, sand dunes, camel resting, tent shelter, and shimmering heat mirages."},{label:"Desktop Terrarium",prompt:"Create a terrarium with growing plants, water droplet condensation, soil moisture indicator, day/night cycle, and occasional critter visitors."},{label:"Dragon's Hoard",prompt:"Build a dragon's treasure hoard with gold coin piles, gem collections, scattered jewelry, sleeping dragon, and click-to-collect interactions."},{label:"Firefly Jar",prompt:"Build a firefly jar with glowing insects, random blink patterns, jar tap interaction to excite them, lid open/close, and peaceful night backdrop."},{label:"Fish Aquarium",prompt:"Build a relaxing fish tank with swimming fish AI, bubbling aerator, swaying plants, treasure chest decoration, and day/night lighting cycle. Auto-starts."},{label:"Gingerbread House",prompt:"Create a gingerbread house builder with candy decorations, icing trim, gumdrop buttons, licorice details, and sweet holiday styling."},{label:"Hamster Wheel",prompt:"Create a hamster wheel with a running hamster, wheel spin physics, speed bursts, tired animations, treat rewards, and exercise meter tracking."},{label:"Hot Air Balloon",prompt:"Create a hot air balloon ride with burner flame control, altitude gauge, drifting clouds, landscape below, and gentle swaying motion."},{label:"Kite Flying",prompt:"Build a kite flying simulation with wind gusts, string tension physics, tail ribbon animation, altitude tracking, and trick maneuvers."},{label:"Mushroom Village",prompt:"Build a fairy mushroom village with toadstool houses, glowing spores, tiny doors, forest floor details, and magical woodland atmosphere."},{label:"Observatory Dome",prompt:"Create an observatory interior with telescope controls, star charts, dome rotation, viewing chair, and cosmic wonder atmosphere."},{label:"Pirate Ship Deck",prompt:"Build a pirate ship deck with steering wheel, cannon stations, treasure map, crow's nest view, swaying ocean motion, and nautical details."},{label:"Toy Workshop",prompt:"Create Santa's toy workshop with workbenches, elf stations, toy assembly, gift wrapping, and festive holiday atmosphere."},{label:"Wizard Tower",prompt:"Create a wizard's tower room with floating spell books, bubbling cauldrons, crystal ball, enchanted items, and magical particle effects."},{label:"Zen Rock Stack",prompt:"Create a zen rock stacking game with balance physics, stone selection, tower height challenge, and peaceful meditation atmosphere."},{label:"Conspiracy Board",prompt:"Build a red-string conspiracy board with pinnable cards, draggable connections, pushpin styling, and cork board background."},{label:"Ghost Hunter EMF",prompt:"Design a ghost hunter tracker with simulated EMF/temperature readings, flickering displays, static interference effects, and dramatic meter spikes."},{label:"Haunted House Tour",prompt:"Create a haunted house explorer with clickable room map, animated ghost apparitions, paranormal meter with flickering needle, and spooky visual effects."},{label:"Space Station Dashboard",prompt:"Create a sci-fi space station with life support monitors, radar, airlock controls, and holographic UI."},{label:"Spaceport Departures",prompt:"Build a spaceport board with starship routes, delays, gate assignments, and glitchy sci-fi styling."},{label:"Steampunk Dashboard",prompt:"Build a steampunk control panel with brass gauges, pressure dials, gear mechanisms, steam vents, and Victorian industrial aesthetic."},{label:"Submarine Sonar",prompt:"Create a submarine sonar with sweeping animation, contacts, ping controls, and cinematic underwater theme."},{label:"Time Machine Date Picker",prompt:"Create a steampunk date picker with spinning brass dials, gear animations, steam effects, and vintage gauge styling."},{label:"Decision Maker",prompt:"Build a decision helper with yes/no/maybe, custom options, dramatic countdown reveal, and let-fate-decide button."},{label:"Fortune Cookie",prompt:"Build a fortune cookie app with crack-to-reveal animation, lucky numbers display, and mystical styling."},{label:"Life Stats Counter",prompt:"Show heartbeats since birth, breaths taken, steps estimate, meals eaten, and other fascinating life statistics."},{label:"Pet Rock Simulator",prompt:"Create a pet rock with googly eyes, accessories, moods, care actions, and name tag."},{label:"Plant Growth Sim",prompt:"Build a virtual garden with plantable seeds, watering, growth stages, harvest animations, and seasonal cycles."},{label:"Pokemon PC Storage",prompt:"Create a Pokemon box system with tabs, draggable sprites, stat hover, type search, and box themes."},{label:"Potion Crafting Lab",prompt:"Design a potion mixer with ingredient shelf, cauldron bubbling, color mixing, effect labels, and magical brewing animations."},{label:"RPG Character Sheet",prompt:"Create an RPG character sheet with stat bars, inventory grid, equipment slots, skill tree, and dice roll integration."},{label:"Skill Tree",prompt:"Create an RPG skill tree with unlockable nodes, prerequisites, point allocation, and reset button."},{label:"Superhero ID Card",prompt:"Create a superhero ID card creator with power selection, costume color picker, hero name input, and comic book styled card display."},{label:"Tamagotchi Pet",prompt:"Design a virtual pet with hunger/happiness stats, feeding, playing, evolution stages, and mini-games."},{label:"Treasure Chest",prompt:"Build an interactive treasure chest with lock mechanism, key insertion, dramatic lid opening, gold coin spill, and gems glittering."},{label:"Vending Machine",prompt:"Create an interactive vending machine with product grid, coin insertion animation, button pressing, spiral dispensing, and product drop physics."},{label:"Villain Lair Designer",prompt:"Create an evil lair builder with room types (shark tank, laser room), trap placements, and dramatic lighting."},{label:"Wizard Spell Tracker",prompt:"Design a spell slot tracker with levels, rest recovery, prepared spells, and parchment styling."}],nC=[{label:"Airbnb Listing",prompt:"Create an Airbnb-style listing page with photo gallery, amenity icons, calendar availability, review stars, and booking card. Use CSS patterns for photos."},{label:"Apple Watch Face",prompt:"Build an Apple Watch face designer with complications (weather, activity rings, calendar), customizable colors, and smooth hand animations."},{label:"Calendar App",prompt:"Create a Google Calendar-style interface with month/week/day views, event blocks, drag-to-create, color categories, and today indicator. Pre-populated with sample events."},{label:"Chat Bubbles",prompt:"Build an iMessage-style chat interface with sent/received bubbles, typing indicator, read receipts, and emoji reactions. Pre-populated with sample conversation."},{label:"Discord Server",prompt:"Build a Discord server with channel list, message area, user list, role colors, and reaction emojis."},{label:"Dribbble Shots",prompt:"Build a Dribbble-style design showcase with shot grid, like animations, designer profiles, and detail view. Use CSS gradients for shots."},{label:"Duolingo Lesson",prompt:"Create a Duolingo-style lesson interface with progress bar, heart lives, streak flame, XP rewards, matching exercises, and celebration animations."},{label:"Instagram Feed",prompt:"Design an Instagram-style feed with post cards, like/comment buttons, story circles, and profile headers. Use CSS patterns instead of photos."},{label:"iOS Control Center",prompt:"Create an iOS Control Center panel with blurred background, interactive toggles, brightness/volume sliders, now-playing card, and expandable modules."},{label:"Linear App",prompt:"Build a Linear-style issue tracker with project sidebar, issue list, status filters, keyboard shortcuts, and smooth transitions. Pre-populated with sample issues."},{label:"Maps Interface",prompt:"Build a Google Maps-style interface with pan/zoom controls, location pins, search bar, layer toggle, and directions panel. Uses illustrated map."},{label:"Netflix Browse",prompt:"Create a Netflix-style browse interface with horizontal content rows, hover-to-expand cards, category sections, and hero banner. Use CSS gradients for thumbnails."},{label:"Notion Page",prompt:"Create a Notion-style page with block types (text, headers, lists, toggles), slash commands, and drag reordering. Pre-populated with sample content."},{label:"Pinterest Board",prompt:"Build a Pinterest-style board with masonry pin grid, save buttons, board organization, and pin detail modal. Use CSS patterns for images."},{label:"Product Page",prompt:"Create an Amazon-style product page with image gallery, variant selector, star ratings, price display, buy button, and related items. Use CSS for product images."},{label:"Slack Channel",prompt:"Create a Slack workspace with channels, direct messages, threads, emoji reactions, and file sharing UI. Pre-populated with sample messages."},{label:"Spotify Player",prompt:"Create a Spotify-style player with album art, progress bar, play controls, queue, and volume. Use CSS gradients for album art."},{label:"Strava Activity",prompt:"Create a Strava-style activity feed with workout cards, route maps, kudos buttons, and athlete stats. Pre-populated with sample activities."},{label:"TikTok Feed",prompt:"Create a TikTok-style interface with vertical video scroll, like/comment/share buttons, creator info overlay, and infinite scroll. Use CSS gradients for video placeholders."},{label:"Trello Board",prompt:"Build a Trello board with draggable cards, list columns, add card/list, and card modal. Pre-populated with sample tasks."},{label:"Twitter Feed",prompt:"Build a Twitter-style feed with tweet cards, like/retweet buttons, compose tweet, and trending sidebar. Pre-populated with sample tweets."},{label:"VS Code File Explorer",prompt:"Build a VS Code-style file explorer with tree view, folder expand/collapse, file icons by type, multi-select, and right-click context menu."}],n_=[{label:"Amiga Workbench",prompt:"Build an Amiga Workbench interface with drawer windows, icon grid, title bar styling, disk icons, and that classic blue/orange/white color scheme."},{label:"Atari 2600",prompt:"Build an Atari 2600 console interface with wood grain styling, game cartridge slot, difficulty switches, and a playable simple game with chunky pixels."},{label:"Calculator Watch",prompt:"Build a Casio calculator watch with tiny LCD display, calculator mode, stopwatch, alarm set, world time, and classic silver bezel with rubber buttons."},{label:"Cassette Player",prompt:"Build a retro cassette player with spinning tape reels, play/pause/rewind, fast-forward, and mechanical buttons."},{label:"Commodore 64",prompt:"Build a Commodore 64 interface with boot sequence, BASIC prompt, blinking cursor, PETSCII graphics, and that iconic blue-on-blue color scheme."},{label:"Game Boy Interface",prompt:"Create a Game Boy handheld with LCD screen, D-pad and A/B buttons, power LED, and a built-in simple game with dot-matrix green screen aesthetic."},{label:"iPod Classic",prompt:"Build an iPod Classic with click wheel, menu navigation, cover flow, and that iconic white interface."},{label:"Mechanical Counter",prompt:"Build a mechanical flip counter with rotating digit drums, satisfying roll-over animations, increment/decrement buttons, and analog odometer aesthetic."},{label:"Minitel Terminal",prompt:"Build a French Minitel terminal with blocky graphics, function keys, phone line aesthetic, page navigation, and distinctive 80s teletext style."},{label:"Motorola Razr",prompt:"Create a Motorola Razr flip phone with flip-open animation, keypad, small outer display, menu navigation, and sleek silver design."},{label:"NeXTSTEP Desktop",prompt:"Create a NeXTSTEP interface with dock, vertical title bars, shelf, app icons, and that distinctive Steve Jobs-era grayscale aesthetic."},{label:"Nintendo DS",prompt:"Create a Nintendo DS dual-screen interface with touch controls on bottom screen, game display on top, stylus interactions, and clamshell design."},{label:"Nokia 3310",prompt:"Create a Nokia 3310 with pixelated screen, Snake game, SMS composer, and classic ringtone visualizer."},{label:"Palm Pilot",prompt:"Build a Palm Pilot PDA with Graffiti input area, app launcher, date book, address book, memo pad, and green-gray LCD screen."},{label:"Sega Genesis",prompt:"Build a Sega Genesis console interface with cartridge slot, game select screen, 16-bit graphics style, and a playable mini-game with blast processing aesthetic."},{label:"Teletext Pages",prompt:"Create a Teletext/Ceefax simulator with blocky graphics, page numbers, reveal buttons, colored text blocks, and channel surfing between information pages."},{label:"Terminal Emulator",prompt:"Build a retro terminal with green phosphor text, command history, CRT scanlines, and typing sounds."},{label:"VHS Collection",prompt:"Build a VHS collection browser with spine shelf view, tape flip details, tracking lines, and rental store aesthetic."},{label:"Vintage Radio",prompt:"Design an old radio with analog tuning dial, static between stations, preset buttons, and vacuum tube glow."},{label:"Windows 3.1",prompt:"Create a Windows 3.1 desktop with Program Manager, group windows, app icons, File Manager, and classic gray interface with 3D borders."},{label:"Windows 95 Desktop",prompt:"Build a Windows 95 desktop with draggable windows, start menu, taskbar with clock, desktop icons, and proper z-index stacking."}],nB=[{label:"Algorithm Visualizer",prompt:"Build algorithm visualization with sorting (bubble, quick, merge), step-by-step playback, and speed control."},{label:"Color Theory Explorer",prompt:"Create a color theory app with interactive wheel, harmony demonstrations, contrast checker, and colorblind simulator."},{label:"Constellation Viewer",prompt:"Build a night sky app with twinkling stars, constellation lines that draw on hover, shooting star animations, and draggable sky rotation."},{label:"Family Tree",prompt:"Build a family tree with person nodes, connections, avatar thumbnails, dates, and automatic layout."},{label:"Flowchart Builder",prompt:"Create a flowchart builder with shapes, connectors, text editing, snap-to-grid, and zoom controls. Starts with a sample flowchart."},{label:"Mind Map Builder",prompt:"Build a mind map with central topic, branching nodes, connection lines, colors, and zoom/pan controls. Starts with a sample mind map."},{label:"Network Graph",prompt:"Build a network graph with force-directed layout, node clustering, zoom/pan, and search highlight."},{label:"Organization Chart",prompt:"Create an org chart with employee nodes, reporting lines, expand/collapse, and search employees."},{label:"Periodic Table",prompt:"Build an interactive periodic table with element modals, category colors, filters, and element quiz."},{label:"Prism Ray Toy",prompt:"Design a light-ray toy with draggable prisms and mirrors, real-time reflections/refractions with rainbow dispersion, and preset puzzles to solve."},{label:"Circuit Traces",prompt:"Build animated circuit board traces with electricity flowing through paths, node pulse effects, branching patterns, and tech aesthetic. Auto-starts."},{label:"Electric Field Lines",prompt:"Create an electric field visualizer with placeable charges, animated field lines flowing between them, and charge strength adjustment. Auto-starts with demo."},{label:"Heartbeat Monitor",prompt:"Create an ECG heartbeat monitor with scrolling waveform, adjustable BPM, different rhythm patterns, and hospital monitor styling."},{label:"Oil Slick Rainbow",prompt:"Build an oil slick simulation with iridescent color shifting, surface tension physics, droplet spreading, and thin-film interference patterns."},{label:"Sparkler Trail",prompt:"Build a sparkler effect with cursor-following sparks, crackling particle burst, ember trails, multiple colors, and magical nighttime feel."}],nT=[{label:"Cart Checkout",prompt:"Create a shopping cart with item list, quantity controls, price calculations, promo code input, and checkout summary. Pre-populated with sample items."},{label:"Order Tracking",prompt:"Design an order tracking page with status timeline, shipping details, and order summary."},{label:"Product Filters",prompt:"Build a product listing with filter sidebar, sort options, grid/list toggle, and animated filter application. Pre-populated with sample products."},{label:"Product Quickview",prompt:"Create a product quickview modal with image gallery, variant selector, size guide, and add-to-cart. Uses CSS for product images."},{label:"Restaurant Menu",prompt:"Design a restaurant menu with categories, item cards, dietary icons, and order builder. Pre-populated with sample menu."},{label:"Review Gallery",prompt:"Build a review section with star breakdown, photo reviews, helpfulness voting, and verified badges. Pre-populated with sample reviews."},{label:"Size Selector",prompt:"Create a size selector with grid layout, out-of-stock states, size guide modal, and visual feedback."},{label:"Storefront Grid",prompt:"Build an e-commerce storefront with product cards, quick add, wishlist hearts, and responsive grid. Uses CSS gradients for product images."},{label:"T-Shirt Designer",prompt:"Build a t-shirt designer with garment color picker, print area, text/graphic placement, multiple shirt views, and fabric texture preview."},{label:"Tattoo Designer",prompt:"Create a tattoo design tool with flash art library, body placement preview, size scaling, black/color modes, and skin tone backgrounds."}],nI=[{label:"Campus Wayfinder",prompt:"Build a campus map with building markers, animated route highlighting, zoom/pan controls, and color-coded building categories."},{label:"Concert Seat Picker",prompt:"Build a venue seating selector with section map, seat grid, price tiers, and cart summary."},{label:"Isometric City",prompt:"Build an isometric city builder with tile grid, placeable buildings/trees/roads, automatic shadows, and a random city generator. Starts with pre-populated city."},{label:"Metro Line Builder",prompt:"Create a subway map designer with station nodes, curved lines, transfer points, and line coloring. Starts with a sample metro system."},{label:"Office Hoteling",prompt:"Create an office floor plan with bookable desks, availability, employee search, and booking confirmation."},{label:"Tiny Planet Builder",prompt:"Design a tiny planet builder with rotating spherical world, drag-and-drop trees/houses/clouds, day/night toggle, and weather overlays. Starts with built planet."},{label:"Train Switcher",prompt:"Create a train track switching game with moving trains, clickable switches, timed deliveries to stations, collisions, and auto-running demo on load."},{label:"Travel Scratch Map",prompt:"Build a world map where you scratch off visited countries, track stats, and see coverage percentage."},{label:"Treasure Hunt",prompt:"Design a proximity treasure hunt on canvas with hidden targets, hot/cold hints, and celebration on find."},{label:"UFO Abduction",prompt:"Create a UFO abduction arcade with movable saucer, light-beam cone, physics objects to grab, and combo scoring. Uses CSS/SVG props and looping demo on load."}],nS=[{label:"3D Card Flip",prompt:"Create cards with 3D flip animations on hover, perspective effects, and reveal content."},{label:"3D Globe",prompt:"Build an interactive globe with country highlighting, rotation, zoom, and location markers. Uses procedural texture."},{label:"3D Room Viewer",prompt:"Create a simple 3D room with orbit controls, furniture placement, and day/night lighting. Uses basic geometry."},{label:"Gashapon Machine",prompt:"Build a gashapon capsule toy machine with turnable crank, capsule drop animation, rarity sparkle effects, and collectible shelf view. Starts with starter collection."},{label:"Magic Mirror",prompt:"Build a funhouse mirror with various distortion modes (stretch, squeeze, wave, bulge), real-time morphing, and mirror frame styling."},{label:"Neon Bullet Dodge",prompt:"Build a neon dodge arena with player orb, procedural bullet patterns, slow-motion meter, near-miss combos, and attract-mode that plays until user takes control."},{label:"Origami Folder",prompt:"Create an origami guide with step-by-step folds, paper preview, crease patterns, multiple models, and animated folding demonstration."},{label:"Product 360 Viewer",prompt:"Build a product viewer with 360\xb0 rotation, zoom, hotspot annotations, and multiple color variants. Uses procedural or CSS product."},{label:"Slot Machine",prompt:"Create a casino slot machine with spinning reels, lever pull animation, symbol matching, win line highlighting, coin payout animation, and jackpot celebration."},{label:"Tilt Marble Maze",prompt:"Build a tilt marble labyrinth with wooden board, holes and checkpoints, mouse/touch tilt control, marble physics, and preloaded sample maze."}];[...ny,...nw,...nj,...nN,...nk,...nE,...nA,...nC,...n_,...nB,...nT,...nI,...nS];let nR=[{icon:r.Monitor,name:"UI",variations:nE},{icon:r.LayoutDashboard,name:"Dashboard",variations:nk},{icon:r.Copy,name:"Clone",variations:nC},{icon:r.Gamepad2,name:"Game",variations:ny},{icon:r.Box,name:"3D/Special",variations:nS},{icon:r.Monitor,name:"Retro",variations:n_},{icon:r.Palette,name:"Creative",variations:nN},{icon:r.Sparkles,name:"Animation",variations:nw},{icon:r.Eye,name:"Visualizer",variations:nB},{icon:r.Wand2,name:"Toy",variations:nj},{icon:r.Sparkles,name:"Whimsical",variations:nA},{icon:r.Map,name:"Map",variations:nI},{icon:r.ShoppingCart,name:"E-commerce",variations:nT}];nR.flatMap(e=>e.variations.map(t=>({...t,icon:e.icon,category:e.name})));let nM=()=>()=>{};function nD(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"horizontal",[t,a]=(0,g.useState)("none"),[i,s]=(0,g.useState)(null);return(0,g.useEffect)(()=>{if(!i)return;let t=()=>{let t="horizontal"===e?i.scrollLeft:i.scrollTop,s=("horizontal"===e?i.scrollWidth:i.scrollHeight)-("horizontal"===e?i.clientWidth:i.clientHeight);s<=0?a("none"):t<10?a("start"):t>=s-10?a("end"):a("middle")};t(),i.addEventListener("scroll",t,{passive:!0});let s=new ResizeObserver(t);return s.observe(i),()=>{i.removeEventListener("scroll",t),s.disconnect()}},[i,e]),{position:t,setRef:s,element:i}}function nO(e){let{sendMessage:t}=e,[a,r]=(0,N.g)((0,k.k)(e=>[e.mode,e.setMode])),n=(0,m.kH)(e=>e.userId),{modelAId:o,modelBId:c}=(0,L.g)(e=>e),[u,p]=(0,g.useState)(null),[h,f]=(0,g.useState)([]),{position:x,setRef:v,element:b}=nD(),{position:y,setRef:w}=nD("vertical"),j=(0,g.useSyncExternalStore)(nM,()=>!0,()=>!1),E=async e=>{d.z.capture({action:"webdev_suggestion_clicked",params:{button_label:e.label,mode:a,user_id:n,model_a_id:o,model_b_id:c}});let i=rA[a];(!i.requiresModelA||(null==o?void 0:o.trim()))&&(!i.requiresModelB||(null==c?void 0:c.trim()))||r(s.lY.BATTLE);try{await t(e.prompt,{isPresetPrompt:!0,presetLabel:e.label})}catch(e){console.error("Failed to send message:",e)}};return j?(0,i.jsxs)("div",{className:"flex w-full flex-col gap-3 px-4",children:[(0,i.jsxs)("div",{className:"order-2 flex flex-col gap-2 md:order-1",children:[(0,i.jsx)("span",{className:"text-foreground-secondary hidden text-left text-sm md:block",children:"What would you like to build?"}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("div",{ref:v,className:"flex w-full items-center gap-2 overflow-x-auto [-ms-overflow-style:none] [scrollbar-width:none] [&::-webkit-scrollbar]:hidden",children:[nR.map((e,t)=>{let a=e.icon,s=t===u;return(0,i.jsxs)(l.Button,{variant:"outline",size:"md","aria-pressed":s,onClick:()=>(e=>{p(e);let t=nR[e];f(t?(0,_.R3)([...t.variations]):[])})(t),className:(0,_.cn)("shrink-0 rounded-[4px] font-normal transition-colors",s?"text-interactive-active bg-surface-raised border-border-medium hover:bg-surface-raised-alt hover:text-interactive-active":"bg-surface-primary border-border-medium hover:bg-interactive-normal/10 hover:border-interactive-normal/10"),children:[(0,i.jsx)(a,{className:"size-4"}),e.name]},e.name)}),(0,i.jsx)("div",{className:"w-8 shrink-0"})]}),"none"!==x&&("start"===x||"middle"===x)&&(0,i.jsxs)("div",{className:"absolute inset-y-0 right-0 z-10 flex items-center justify-end",children:[(0,i.jsx)("div",{className:"from-background pointer-events-none absolute inset-y-0 right-0 w-16 bg-gradient-to-l to-transparent"}),(0,i.jsx)("button",{type:"button",onClick:()=>{b&&b.scrollTo({left:b.scrollWidth,behavior:"smooth"})},className:"bg-surface-secondary hover:bg-surface-tertiary border-border-medium relative flex size-6 shrink-0 items-center justify-center rounded-full border transition-colors","aria-label":"Scroll to end",children:(0,i.jsx)(nv.A,{className:"text-foreground-secondary size-3.5"})})]}),"none"!==x&&("end"===x||"middle"===x)&&(0,i.jsxs)("div",{className:"absolute inset-y-0 left-0 z-10 flex items-center justify-start",children:[(0,i.jsx)("div",{className:"from-background pointer-events-none absolute inset-y-0 left-0 w-16 bg-gradient-to-r to-transparent"}),(0,i.jsx)("button",{type:"button",onClick:()=>{b&&b.scrollTo({left:0,behavior:"smooth"})},className:"bg-surface-secondary hover:bg-surface-tertiary border-border-medium relative flex size-6 shrink-0 items-center justify-center rounded-full border transition-colors","aria-label":"Scroll to start",children:(0,i.jsx)(nb.A,{className:"text-foreground-secondary size-3.5"})})]})]})]}),null!==u&&(0,i.jsxs)("div",{className:"relative order-1 flex w-full flex-col md:order-2",children:[("middle"===y||"end"===y)&&(0,i.jsx)("div",{className:"from-background via-background/70 pointer-events-none absolute inset-x-0 top-0 z-10 h-16 bg-gradient-to-b to-transparent"}),(0,i.jsx)("div",{ref:w,className:"flex max-h-36 w-full flex-col overflow-y-auto pb-6 [-ms-overflow-style:none] [scrollbar-width:none] sm:max-h-44 md:max-h-48 [&::-webkit-scrollbar]:hidden",children:h.map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>void E(e),className:"text-foreground-secondary hover:text-foreground hover:bg-surface-secondary flex w-full shrink-0 items-center gap-3 rounded-md px-2 py-2 text-left text-sm transition-colors",children:e.label},e.label))},u),("start"===y||"middle"===y)&&(0,i.jsx)("div",{className:"from-background via-background/70 pointer-events-none absolute inset-x-0 bottom-0 z-10 h-16 bg-gradient-to-t to-transparent"})]})]}):null}let nP="mx-auto max-w-[800px]";function nz(e){let{evaluationFormProps:t,textAreaRef:a,fileInputRef:r,openFilePicker:n,scrollableAreaRef:l,checkpointElementRef:o,messageThreads:c,latestMessages:u}=e,{ref:p,inView:h}=(0,sA.Wx)({threshold:0,rootMargin:eK});ni({checkpointInView:h,lastMessagesArr:null!=u?u:[]});let f="treatment1"===(0,A._P)("modality-buttons-experiment"),x=(0,S.d)("md"),v=rI(),b=rT(),y=ns(),{shouldShow:j,variant:E}=function(){let e=(0,A._P)("fast-mode"),t=(0,tg.KL)(e),{isFastModeInProgress:a,evaluationSessionId:i,mode:r,modality:n,messages:l,lastMessageIds:o,isPredictingModality:c,isNewModelSample:u}=(0,N.g)((0,k.k)(e=>({isFastModeInProgress:e.isFastModeInProgress,evaluationSessionId:e.id,mode:e.mode,modality:e.modality,messages:e.messages,lastMessageIds:e.lastMessageIds,isPredictingModality:e.isPredictingModality,isNewModelSample:2===(0,X.co)(e).length}))),m=t?({"no-delay":0,"4-second-delay":4e3,"8-second-delay":8e3,"12-second-delay":12e3})[e]:0,[p,h]=(0,g.useState)(!1),f=(0,g.useMemo)(()=>{if(!t||a||c||r!==s.lY.BATTLE||n!==s.Jg.CHAT&&n!==s.Jg.IMAGE&&n!==s.Jg.SEARCH||!u)return!1;let e=o.map(e=>l.find(t=>t.id===e)).filter(e=>null!=e&&e.role===s.PG.ASSISTANT);return!(e.length<2)&&e.every(e=>e.status===s.nH.PENDING&&(!("string"==typeof e.content||Array.isArray(e.content))||0===e.content.length))},[t,a,c,r,n,u,l,o]);return(0,g.useEffect)(()=>{if(!f)return void h(!1);let t=setTimeout(()=>{h(!0),d.z.capture({action:"fast_mode_button_shown",params:{evaluation_session_id:i,modality:n,delay_variant:null!=e?e:"unknown"}})},m);return()=>clearTimeout(t)},[f,m,i,n,e]),{shouldShow:f&&p,variant:e}}(),C=r$(),B=rw(),T=(0,m.kH)(e=>e.user),I=(0,m.kH)(m.Q_),R="/"===(0,w.a8)(),M=(0,N.g)((0,k.k)(e=>({id:e.id,mode:e.mode,loading:e.loading,modality:e.modality,messagesLength:e.messages.length}))),D=B.isRateLimited&&M.modality===s.Jg.VIDEO,O=M.modality===s.Jg.VIDEO&&M.mode!==s.lY.BATTLE&&null!=c&&c.length>0,P=R&&0===M.messagesLength&&M.modality===s.Jg.WEBDEV&&(!c||0===c.length),z=R&&0===M.messagesLength&&M.modality!==s.Jg.WEBDEV&&(!c||0===c.length),L=(0,g.useMemo)(()=>{if(!c||M.mode!==s.lY.DIRECT_BATTLE)return -1;for(let e=c.length-1;e>=0;e--){let t=c[e];if(!t)continue;let a=t.get(th.BQ.a),i=t.get(th.BQ.b);if((null==a?void 0:a.role)===s.PG.ASSISTANT&&(null==i?void 0:i.role)===s.PG.ASSISTANT&&null==a.pairwiseFeedbackId&&null==i.pairwiseFeedbackId)return e}return -1},[c,M.mode]),U=(0,g.useMemo)(()=>null==c?void 0:c.map((e,t)=>{let a=e.get(th.BQ.a),r=e.get(th.BQ.b);return(null==a?void 0:a.role)===s.PG.USER?(0,i.jsx)("div",{className:(0,_.cn)(nP,"flex w-full justify-end"),children:(0,i.jsx)(sN,{message:a})},null==a?void 0:a.id):a&&!r?(0,i.jsx)("div",{className:(0,_.cn)(nP,"w-full"),children:(0,i.jsx)(sj,{message:a,selectedMessage:"a",messageLayoutMode:"page"})},a.id):(0,i.jsx)(no,{messageA:a,messageB:r,firstMessageMap:c[0],showFeedbackPrompt:t===L},"".concat(null==a?void 0:a.id).concat(null==r?void 0:r.id))}),[c,L]),F=M.mode!==s.lY.DIRECT_BATTLE&&M.mode!==s.lY.DIRECT&&x&&iY.Fr,G=c&&c.length>0;return(0,i.jsx)(sT,{children:(0,i.jsx)("div",{className:"relative flex min-h-0 flex-1 flex-col",children:(0,i.jsxs)("div",{className:"absolute inset-0 flex flex-col",children:[(0,i.jsx)(sE.N,{mode:"wait",initial:!1,children:M.loading?(0,i.jsx)("div",{className:"-mb-4 min-h-0 flex-1",children:(0,i.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,i.jsx)(np,{mode:M.mode})})},"loading"):G?(0,i.jsxs)("div",{className:(0,_.cn)("-mb-4 min-h-0 flex-1",{"flex flex-col":C}),children:[C&&(0,i.jsx)("div",{className:"w-full flex-shrink-0 px-4 pt-4",children:(0,i.jsx)(nr,{})}),(0,i.jsx)(ea.F,{ref:l,className:"h-full min-h-0 flex-1",children:(0,i.jsx)("div",{className:"relative h-full w-full overscroll-none",children:(0,i.jsxs)("div",{className:(0,_.cn)({"h-full":F},"flex flex-col items-center","px-[--chat-padding] [--chat-padding:theme(spacing.4)]"),children:[(0,i.jsxs)("ol",{className:(0,_.cn)("mt-8 flex w-full max-w-screen-xl grow flex-col-reverse justify-end gap-4 overscroll-none pb-2 duration-500",{"md:pb-24":v,"pb-12 md:pb-20":b||D||O}),children:[(0,i.jsx)("div",{className:"h-0",ref:e=>{p(e),o.current=e}}),D&&(0,i.jsx)("li",{className:"w-full max-w-screen-xl",children:(0,i.jsx)(nh,{})}),O&&(0,i.jsx)("li",{className:"w-full max-w-screen-xl",children:(0,i.jsx)(ng,{})}),y&&(0,i.jsx)("li",{className:"w-full max-w-screen-xl",children:(0,i.jsx)(sK,{})}),j&&(0,i.jsx)("li",{className:"w-full max-w-screen-xl",children:(0,i.jsx)(na,{variant:E})}),U]}),F&&(0,i.jsx)(sM,{latestMessages:null!=u?u:[]})]})})})]},"messages"):(0,i.jsx)(sk.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1,ease:"easeOut"},className:"flex flex-1 flex-col items-center justify-center px-4",children:(0,i.jsx)("div",{className:"w-full max-w-2xl text-center",children:(0,i.jsx)("p",{className:"text-text-muted text-2xl sm:text-5xl",children:null==T||I?"":"What would you like to do?"})})},"empty-state")}),(0,i.jsx)("div",{className:(0,_.cn)("relative flex flex-col items-center pb-6",[s.lY.BATTLE,s.lY.SIDE_BY_SIDE,s.lY.DIRECT_BATTLE].includes(M.mode)&&"px-4"),children:(0,i.jsxs)("div",{className:(0,_.cn)("flex w-full flex-col gap-3",[s.lY.BATTLE,s.lY.SIDE_BY_SIDE,s.lY.DIRECT_BATTLE].includes(M.mode)&&"max-w-screen-xl"),children:[P&&(0,i.jsx)("div",{className:"relative order-1 w-full overflow-x-visible md:absolute md:top-full md:order-2 md:pt-4",children:(0,i.jsx)(nO,{sendMessage:t.sendMessage})}),z&&f&&(0,i.jsx)("div",{className:"relative order-1 w-full overflow-x-visible md:absolute md:top-full md:order-2 md:pt-4",children:(0,i.jsx)(nx,{focusInput:()=>{var e;return null==(e=a.current)?void 0:e.focus()},openFilePicker:n})}),(0,i.jsx)("div",{className:(0,_.cn)("relative order-2 w-full md:order-1",nP),children:(0,g.createElement)(ne,{...t,textAreaRef:a,fileInputRef:r,key:"evaluation-form-".concat(M.id)})})]})})]})})})}function nL(e){let{evaluationFormProps:t,textAreaRef:a,fileInputRef:r,openFilePicker:n,userHasHistory:l}=e,o=(0,N.g)(e=>e.update),c=(0,N.g)(e=>e.title),d=(0,N.g)(e=>e.modality),u=(0,N.g)(e=>e.messages.length),m="treatment1"===(0,A._P)("modality-buttons-experiment"),p=d!==s.Jg.WEBDEV&&0===u,h=0===u&&d===s.Jg.WEBDEV;return(0,g.useEffect)(()=>{"New Chat"!==c&&o({title:"New Chat"})},[c,o]),(0,i.jsx)("div",{className:"relative flex min-h-0 flex-1 flex-col",children:(0,i.jsxs)("div",{className:"flex flex-1 flex-col items-center justify-center px-0 md:justify-center",children:[(0,i.jsx)("div",{className:"flex w-full max-w-3xl flex-1 items-center justify-center px-4 text-center md:flex-none",children:(0,i.jsx)("div",{className:"flex flex-col items-center",children:l?(0,i.jsx)("h1",{className:"text-text-tertiary mb-0 text-center text-[48px] font-light leading-tight sm:mb-4 sm:text-[52px]",children:"What would you like to do?"}):(0,i.jsx)(rs,{})})}),(0,i.jsx)("div",{className:"w-full max-w-[800px] md:relative md:text-center",children:(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[p&&m&&(0,i.jsx)("div",{className:"relative order-1 w-full overflow-x-visible md:absolute md:top-full md:z-[1] md:order-2",children:(0,i.jsx)(nx,{focusInput:()=>{var e;return null==(e=a.current)?void 0:e.focus()},openFilePicker:n})}),h&&(0,i.jsx)("div",{className:"relative order-1 w-full overflow-x-visible md:absolute md:top-full md:z-[1] md:order-2",children:(0,i.jsx)(nO,{sendMessage:t.sendMessage})}),(0,i.jsx)("div",{className:"relative order-2 px-4 pb-6 md:order-1",children:(0,i.jsx)(ne,{...t,showBanner:!1,textAreaRef:a,fileInputRef:r})})]})})]})})}var nU=a(57853),nF=a(60318);function nG(e){var t,a;let{hasViewedLatestResponses:i,checkpointRef:s,messagesLength:r=0,evaluationId:n}=e,l=(0,g.useRef)(null),[o,c]=(0,nU.A)(),d=(0,g.useRef)(!1),u=(0,g.useRef)(n),{y:m}=(0,nF.A)(l),p=(null!=(a=null==(t=l.current)?void 0:t.scrollHeight)?a:m)-m-c.height,h=(0,g.useCallback)(()=>{if(null==s?void 0:s.current)s.current.scrollIntoView({behavior:"smooth",block:"end"});else{var e;let t=null==(e=l.current)?void 0:e.querySelector("[data-radix-scroll-area-viewport]");t&&t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}},[s]),f=(0,g.useCallback)(()=>{var e;let t=null==(e=l.current)?void 0:e.querySelector("[data-radix-scroll-area-viewport]");t&&t.scrollTo({top:t.scrollHeight+100,behavior:"instant"})},[]);return(0,g.useLayoutEffect)(()=>{u.current!==n&&(d.current=!1,u.current=n),0!==r&&!d.current&&(null==s?void 0:s.current)&&(f(),d.current=!0)},[r,s,f,n]),{scrollContainerRef:l,scrollViewportRef:o,scrollViewportDimensions:c,distanceFromBottom:p,showScrollDownButton:p>100&&!i,scrollToBottom:h}}var nH=a(16555);let nV=e=>{let{className:t,...a}=e;return(0,i.jsx)(nH.YZ,{className:(0,_.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})},nW=nH.Zk,nY=e=>{let{withHandle:t,className:a,...s}=e;return(0,i.jsx)(nH.TW,{className:(0,_.cn)("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...s,children:t&&(0,i.jsx)("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-sm border",children:(0,i.jsx)(r.GripVertical,{className:"h-2.5 w-2.5"})})})};var nJ=a(86695),nq=a(6781),nQ=a.n(nq);async function nK(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"project.zip",a=new(nQ());for(let t of e)t.content&&a.file(t.path,t.content);let i=await a.generateAsync({type:"blob"}),s=URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}var nX=a(28614),nZ=a(36947),n$=a(89519),n0=a(53301),n1=a(84719),n2=a(41440),n4=a(26386),n5=a(19038),n3=a(65089),n6=a(28024),n9=a(2286);let n8={light:{"--code-editor-bg":"hsl(var(--surface-primary))","--code-editor-text":"hsl(var(--text-primary))","--code-editor-border":"hsl(var(--border-faint) / 0.8)","--code-editor-gutter-bg":"hsl(var(--surface-primary))","--code-editor-gutter-color":"hsl(var(--text-tertiary))","--code-editor-gutter-active":"hsl(var(--text-secondary))","--code-editor-cursor":"hsl(var(--interactive-cta))","--code-editor-active-line":"hsl(var(--surface-highlight) / 0.65)","--code-editor-selection":"hsl(var(--interactive-cta) / 0.16)","--code-editor-selection-focused":"hsl(var(--interactive-cta) / 0.26)","--code-editor-tooltip-bg":"hsl(var(--surface-floating))","--code-editor-tooltip-border":"hsl(var(--border-faint))","--code-editor-tooltip-color":"hsl(var(--text-primary))","--code-editor-tooltip-shadow":"rgba(15, 23, 42, 0.12)","--code-editor-fold-color":"hsl(var(--interactive-link))","--code-editor-fold-hover":"hsl(var(--interactive-cta-hover))"},dark:{"--code-editor-bg":"hsl(var(--surface-primary))","--code-editor-text":"hsl(var(--text-primary))","--code-editor-border":"hsl(var(--border-faint) / 0.45)","--code-editor-gutter-bg":"hsl(var(--surface-primary))","--code-editor-gutter-color":"hsl(var(--text-tertiary))","--code-editor-gutter-active":"hsl(var(--text-secondary))","--code-editor-cursor":"hsl(var(--interactive-cta))","--code-editor-active-line":"hsl(var(--surface-highlight) / 0.75)","--code-editor-selection":"hsl(var(--interactive-cta) / 0.28)","--code-editor-selection-focused":"hsl(var(--interactive-cta) / 0.38)","--code-editor-tooltip-bg":"hsl(var(--surface-floating))","--code-editor-tooltip-border":"hsl(var(--border-faint) / 0.6)","--code-editor-tooltip-color":"hsl(var(--text-primary))","--code-editor-tooltip-shadow":"rgba(0, 0, 0, 0.35)","--code-editor-fold-color":"hsl(var(--interactive-link))","--code-editor-fold-hover":"hsl(var(--interactive-cta))"}},n7=(0,n9.Lv)({markerDOM:e=>{let t=document.createElement("span");return t.className="cm-fold-marker".concat(e?" cm-fold-marker--open":" cm-fold-marker--closed"),t.setAttribute("aria-hidden","true"),t.innerHTML=e?'<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.7 5.25L7 8.55L10.3 5.25" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>':'<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.25 3.7L8.55 7L5.25 10.3" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>',t}}),le=[n6.Lz.theme({"&":{color:"var(--code-editor-text)"},"&.cm-editor":{backgroundColor:"var(--code-editor-bg)",borderRadius:"inherit"},".cm-scroller":{fontFamily:'var(--font-dm-mono), "DM Mono", "Fira Code", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',lineHeight:"1.5"},".cm-line":{padding:"0 0 0 4px"},".cm-gutters":{backgroundColor:"var(--code-editor-gutter-bg) !important",borderRight:"none",color:"var(--code-editor-gutter-color)"},".cm-gutter.cm-lineNumbers":{fontFamily:'var(--font-dm-mono), "DM Mono", "Fira Code", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',fontSize:"12px",minWidth:"46px"},".cm-gutterElement.cm-activeLineGutter":{color:"var(--code-editor-gutter-active)",backgroundColor:"transparent"},".cm-foldGutter .cm-gutterElement":{padding:"0 8px 0 4px",color:"var(--code-editor-gutter-color)",display:"flex",alignItems:"center"},".cm-cursor":{borderLeftColor:"var(--code-editor-cursor)",borderLeftWidth:"2px"},".cm-activeLine":{backgroundColor:"var(--code-editor-active-line)"},".cm-selectionBackground":{backgroundColor:"var(--code-editor-selection) !important"},"&.cm-focused .cm-selectionBackground":{backgroundColor:"var(--code-editor-selection-focused) !important"},"&.cm-focused":{outline:"none"},".cm-tooltip":{backgroundColor:"var(--code-editor-tooltip-bg)",border:"1px solid var(--code-editor-tooltip-border)",boxShadow:"0 18px 38px var(--code-editor-tooltip-shadow)",color:"var(--code-editor-tooltip-color)"},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"var(--code-editor-tooltip-border)"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:"var(--code-editor-tooltip-bg)"},".cm-foldGutter .cm-gutterElement .cm-fold-marker":{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"20px",height:"20px",marginRight:"4px",borderRadius:"4px",transition:"background-color 0.12s ease, color 0.12s ease",color:"var(--code-editor-fold-color)",transform:"translateY(1px)"},".cm-foldGutter .cm-gutterElement .cm-fold-marker--open":{color:"var(--code-editor-fold-color)"},".cm-foldGutter .cm-gutterElement .cm-fold-marker svg":{display:"block"},".cm-foldGutter .cm-gutterElement:hover .cm-fold-marker":{backgroundColor:"var(--code-editor-active-line)",color:"var(--code-editor-fold-hover)"},".cm-highlight-change":{backgroundColor:"hsl(142 76% 36% / 0.2)",borderRadius:"2px"}}),n7],lt=n4.Pe.define(),la=n4.sU.define({create:()=>n5.NZ.none,update(e,t){for(let e of t.effects)if(e.is(lt)){let t=n5.NZ.mark({class:"cm-highlight-change"});return n5.NZ.set([t.range(e.value.from,e.value.to)])}return e.map(t.changes)},provide:e=>n5.Lz.decorations.from(e)});function li(e){let{code:t,contentType:a,className:s,highlightStart:r,highlightEnd:n}=e,{resolvedTheme:l}=(0,ak.D)(),o=(0,g.useRef)(null),c=(0,g.useRef)(t),d="dark"===l?"dark":"light",u=(0,g.useMemo)(()=>n8[d],[d]);var m=t,p=o.current;let h=(0,g.useRef)(m);(0,g.useEffect)(()=>{if(p)if(m.startsWith(h.current)){let e=m.slice(h.current.length);if(e){let t=p.state.doc.length;p.dispatch({changes:{from:t,to:t,insert:e},annotations:n6.ZX.addToHistory.of(!1)}),h.current=m}}else p.dispatch({changes:{from:0,to:p.state.doc.length,insert:m},annotations:n6.ZX.addToHistory.of(!1)}),h.current=m},[m,p]);let f=(0,g.useCallback)(e=>{if(o.current=e,r)try{let t=e.state.doc.line(r),a=n?e.state.doc.line(n):t;e.dispatch({effects:[n5.Lz.scrollIntoView(t.from,{y:"center",yMargin:100}),lt.of({from:t.from,to:a.to})]})}catch(e){console.error("Error scrolling to line:",e)}},[r,n]),x=(0,g.useMemo)(()=>[...ln[a],la],[a]);return(0,i.jsx)("div",{className:(0,_.cn)("relative h-full overflow-hidden",s),style:u,children:(0,i.jsx)("div",{className:"absolute inset-0",children:(0,i.jsx)(n6.Ay,{value:c.current,theme:"light"===d?n3.jL:n3.Ts,height:"100%",style:lr,basicSetup:ls,extensions:x,readOnly:!0,onCreateEditor:f})})})}let ls={lineNumbers:!0,highlightActiveLine:!0,foldGutter:!1},lr={fontSize:"12px",height:"100%",fontFamily:'var(--font-dm-mono), "DM Mono", "Fira Code", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},ln={"text/html":[(0,n$.qy)(),...le],"text/javascript":[(0,n0.Q2)({jsx:!0,typescript:!0}),...le],"text/css":[(0,nZ.AH)(),...le],"text/markdown":[(0,n2.wD)(),...le],"application/json":[(0,n1.Pq)(),...le],"text/plain":le};function ll(e){var t;let{files:a,selectedFile:s}=e,{pinnedTabs:n,previewTab:l,pinTab:o,closeTab:c,moveTab:d}=tp(),[u,m]=tn(),[p,h]=(0,g.useState)(null),[f,x]=(0,g.useState)(null),{validPinnedTabs:v,validPreviewTab:b}=(0,g.useMemo)(()=>{let e=new Set(a.map(e=>e.path));return{validPinnedTabs:n.filter(t=>e.has(t)),validPreviewTab:l&&e.has(l)?l:null}},[n,l,a]),y=(0,g.useMemo)(()=>{let e=[...v];return b&&!v.includes(b)&&e.push(b),s&&!e.includes(s.path)&&e.push(s.path),e},[v,b,s]);if(0===y.length)return null;let w=null!=(t="code"===u.mode?u.path:void 0)?t:null==s?void 0:s.path,j=e=>{m({mode:"code",path:e})},N=()=>{x(null)},k=()=>{h(null),x(null)};return(0,i.jsxs)("div",{className:"bg-surface-secondary no-scrollbar flex overflow-x-auto",children:[y.map(e=>{var t;let a=null!=(t=e.split("/").pop())?t:e,s=e===w,n=!v.includes(e),l=e===p,u=e===f;return(0,i.jsxs)("div",{role:"tab",tabIndex:0,draggable:!0,onClick:()=>j(e),onDoubleClick:()=>{o(e)},onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),j(e))},onDragStart:t=>{h(e),m({mode:"code",path:e}),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",e)},onDragOver:t=>{t.preventDefault(),t.dataTransfer.dropEffect="move",p&&e!==p&&x(e)},onDragLeave:N,onDrop:t=>((e,t)=>{if(e.preventDefault(),x(null),!p||p===t)return void h(null);d(p,t),h(null)})(t,e),onDragEnd:k,className:(0,_.cn)("group relative flex h-[34px] shrink-0 cursor-pointer items-center gap-1.5 border-b px-3 text-xs transition-colors","border-r-border-faint border-r",s?"bg-surface-primary text-text-primary border-b-transparent":"border-b-border-faint text-text-tertiary hover:bg-surface-tertiary hover:text-text-secondary opacity-90 hover:opacity-100",l&&"opacity-50",u&&"bg-surface-tertiary"),children:[iE(a),(0,i.jsx)("span",{className:(0,_.cn)("font-mono",n&&"italic"),children:a}),(0,i.jsx)("button",{type:"button","aria-label":"Close ".concat(a),onClick:t=>((e,t)=>{if(e.stopPropagation(),c(t),w===t){var a;let e=y.indexOf(t),i=null!=(a=y[e-1])?a:y[e+1];i&&m({mode:"code",path:i})}})(t,e),className:(0,_.cn)("text-text-tertiary hover:text-text-primary -mr-1 ml-1 rounded p-0.5 transition-opacity","hover:bg-surface-tertiary opacity-0 group-hover:opacity-100",s&&"opacity-100"),children:(0,i.jsx)(r.XIcon,{className:"size-3"})})]},e)}),(0,i.jsx)("div",{className:"border-border-faint h-[34px] min-w-4 flex-1 border-b"})]})}function lo(e){var t,a;let[i]=tn();if("code"!==i.mode)return{file:void 0,highlightStart:void 0,highlightEnd:void 0};let s=i.path?e.find(e=>e.path===i.path):void 0;return s?{file:s,highlightStart:i.highlightStart,highlightEnd:i.highlightEnd}:{file:null!=(a=null!=(t=e.find(e=>"src/App.tsx"===e.path))?t:e.find(e=>"index.html"===e.path))?a:e[0],highlightStart:void 0,highlightEnd:void 0}}function lc(e){let{className:t,message:a}=e,{data:s}=iB(a),{files:r,tree:n}=(0,g.useMemo)(()=>{var e;let t=null!=(e=null==s?void 0:s.files)?e:[];return{files:t,tree:function(e){let t={};for(let i of e){let e=i.path.split("/"),s=e.pop();if(!s)continue;let r=t;for(let t of e){var a;null!=(a=r)[t]||(a[t]={type:"folder",children:{}}),"folder"===r[t].type&&(r=r[t].children)}r[s]={type:"file",file:i}}return function e(t,a){return Object.entries(t).map(t=>{let[i,s]=t,r=a?"".concat(a,"/").concat(i):i;return"file"===s.type?{type:"file",name:i,path:r,file:s.file}:{type:"folder",name:i,path:r,children:e(s.children,r)}}).sort((e,t)=>"folder"===e.type&&"file"===t.type?-1:"file"===e.type&&"folder"===t.type?1:e.name.localeCompare(t.name))}(t,"")}(t)}},[null==s?void 0:s.files]),{file:l}=lo(r);return 0===n.length?null:(0,i.jsxs)("div",{className:(0,_.cn)("bg-surface-primary flex flex-col overflow-hidden",t),children:[(0,i.jsx)("div",{className:"border-border-faint flex min-h-[34px] shrink-0 items-center border-b px-3",children:(0,i.jsx)("span",{className:"text-text-tertiary font-rebrand-mono text-xs font-semibold uppercase tracking-wide",children:"Files"})}),(0,i.jsx)("div",{className:"flex flex-col overflow-y-auto overflow-x-hidden p-1.5",children:n.map(e=>(0,i.jsx)(ld,{node:e,depth:0,selectedFilePath:null==l?void 0:l.path},e.path))})]})}function ld(e){let{node:t,depth:a,selectedFilePath:s}=e,[,r]=tn(),{previewFile:n,pinTab:l}=tp(),[o,c]=(0,g.useState)(!0);return"file"===t.type?(0,i.jsxs)("div",{className:"relative min-w-0",style:{paddingLeft:"".concat(12*a+8,"px")},children:[a>0&&(0,i.jsx)(lu,{depth:a}),(0,i.jsxs)(lm,{onClick:()=>{n(t.file.path),r({mode:"code",path:t.file.path})},onDoubleClick:()=>{l(t.file.path),r({mode:"code",path:t.file.path})},isSelected:t.file.path===s,children:[iE(t.name),(0,i.jsx)("span",{className:"truncate font-mono text-xs",children:t.name})]})]}):(0,i.jsxs)(aK.Nt,{open:o,onOpenChange:c,children:[(0,i.jsxs)("div",{className:"relative min-w-0",style:{paddingLeft:"".concat(12*a+8,"px")},children:[a>0&&(0,i.jsx)(lu,{depth:a}),(0,i.jsx)(aK.R6,{asChild:!0,children:(0,i.jsxs)(lm,{children:[iA(o),(0,i.jsx)("span",{className:"truncate font-mono text-xs",children:t.name})]})})]}),(0,i.jsx)(aK.Ke,{className:"data-[state=closed]:animate-collapse-up data-[state=open]:animate-collapse-down",children:(0,i.jsx)("div",{className:"relative min-w-0",children:t.children.map(e=>(0,i.jsx)(ld,{node:e,depth:a+1,selectedFilePath:s},e.path))})})]})}function lu(e){let{depth:t}=e;return(0,i.jsx)(i.Fragment,{children:Array.from({length:t}).map((e,t)=>(0,i.jsx)("div",{className:"border-border-faint absolute bottom-0 top-0 border-l",style:{left:"".concat(12*t+16,"px")}},t))})}function lm(e){let{isSelected:t=!1,className:a,...s}=e;return(0,i.jsx)("button",{type:"button",className:(0,_.cn)("flex w-full items-center gap-1.5 rounded-md px-1.5 py-1 text-left text-sm outline-none transition-colors disabled:pointer-events-none disabled:opacity-50",t?"bg-surface-tertiary text-text-primary font-medium":"text-text-secondary hover:bg-surface-tertiary hover:text-text-primary",a),...s})}var lp=a(53881);function lh(e){let{statusText:t}=e,{RiveComponent:a}=(0,aN.useRive)({src:"/rive/building-loop.riv",autoplay:!0});return(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"mb-4 flex justify-center",children:(0,i.jsx)(a,{className:"h-32 w-32"})}),(0,i.jsx)("p",{className:"text-text-secondary text-lg font-semibold",children:t}),(0,i.jsx)("p",{className:"text-text-tertiary max-w-[15rem] text-sm",children:"Preview will appear when agent is done working"})]})}function lg(){return(0,i.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,i.jsx)(lp.A,{className:"h-12 w-12"}),(0,i.jsx)("p",{className:"font-medium",children:"No preview available"})]})}function lf(){return(0,i.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,i.jsx)(r.Unlink,{className:"h-12 w-12"}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("p",{className:"font-medium",children:"Something went wrong"}),(0,i.jsx)("p",{className:"text-text-tertiary text-sm",children:"Please start a new chat and try again."})]}),(0,i.jsx)(l.Button,{variant:"secondary",size:"md",className:"flex-1 gap-1 sm:flex-initial",asChild:!0,children:(0,i.jsxs)(n.Link,{href:"/code",children:[(0,i.jsx)(r.SquarePen,{className:"size-3.5"}),"New Chat"]})})]})}function lx(){var e;let[t]=tr(),a=to(t),{data:s,error:r}=iB(null!=a?a:null),n=(0,N.g)(e=>e.markWebDevPreviewAsViewed),l=null!=(e=null==s?void 0:s.files)?e:[],o=(0,S.d)("md"),{file:c,highlightStart:d,highlightEnd:u}=lo(l),{pinnedTabs:m,previewTab:p,pinTab:h}=tp({defaultFile:null==c?void 0:c.path}),[,f]=tn(),x=m.length>0||null!==p;return((0,g.useEffect)(()=>{(null==s?void 0:s.status)==="success"&&(null==a?void 0:a.id)&&n(a.id)},[null==s?void 0:s.status,null==a?void 0:a.id,n]),r)?(0,i.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,i.jsx)(lf,{})}):s?"pending"===s.status&&0===s.files.length?(0,i.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,i.jsx)(lh,{statusText:"Thinking..."})}):c?(0,i.jsx)("div",{className:"relative flex h-full flex-col",children:(0,i.jsxs)(nV,{direction:"horizontal",className:"flex-1",children:[!o&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(nW,{defaultSize:15,minSize:15,maxSize:30,children:(0,i.jsx)(lc,{className:"h-full",message:null!=a?a:null})}),(0,i.jsx)(nY,{className:"bg-border-faint"})]}),(0,i.jsx)(nW,{defaultSize:75,children:x&&c?(0,i.jsxs)("div",{className:"flex h-full flex-col",children:[(0,i.jsx)(ll,{files:l,selectedFile:c}),(0,i.jsx)(li,{code:c.content,contentType:c.contentType,className:"flex-1",highlightStart:d,highlightEnd:u})]}):(0,i.jsx)(lv,{files:l,onFileClick:e=>{h(e.path),f({mode:"code",path:e.path})}})})]})}):(0,i.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,i.jsx)(lg,{})}):null}function lv(e){let{files:t,onFileClick:a}=e,s=(()=>{let e=t.find(e=>e.path.endsWith("App.tsx")||e.path.endsWith("App.jsx")),a=t.filter(t=>t!==e);return e&&a.length>=2?[a[0],e,a[1]].filter(Boolean):e&&1===a.length?[a[0],e].filter(Boolean):e?[e]:t.slice(0,3)})();return(0,i.jsx)("div",{className:"bg-surface-primary flex h-full flex-col items-center justify-center p-8",children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"relative mb-6",children:(0,i.jsx)(nX.ArenaColosseum,{size:40,className:"text-text-tertiary opacity-50"})}),(0,i.jsxs)("div",{className:"mb-8 text-center",children:[(0,i.jsx)("p",{className:"text-text-secondary mb-1 text-sm",children:"Start exploring the generated code"}),(0,i.jsx)("p",{className:"text-text-tertiary text-xs",children:"Click a file below or select from the file tree"})]}),(0,i.jsx)("div",{className:"flex flex-wrap justify-center gap-2",children:s.map(e=>{var t;let s=null!=(t=e.path.split("/").pop())?t:e.path;return(0,i.jsxs)("button",{type:"button",onClick:()=>a(e),className:"bg-surface-secondary hover:bg-surface-tertiary border-border-faint hover:border-border-medium group flex items-center gap-2.5 rounded-lg border px-4 py-2.5 transition-colors",children:[iE(s),(0,i.jsx)("span",{className:"text-text-secondary group-hover:text-text-primary text-sm font-medium transition-colors",children:s})]},e.path)})})]})})}function lb(){let[e]=tr(),t=to(e),{data:a,error:s}=iB(t),r=(0,N.g)(e=>e.markWebDevPreviewAsViewed);(0,g.useEffect)(()=>{(null==a?void 0:a.status)==="success"&&(null==t?void 0:t.id)&&r(t.id)},[null==a?void 0:a.status,null==t?void 0:t.id,r]);let[n]=td(),[l]=tu(),[o]=tm(),c=(0,S.d)("md"),d=(0,g.useRef)(null),[u,m]=(0,g.useState)(0);(0,g.useLayoutEffect)(()=>{d.current&&m(d.current.clientWidth)},[]),(0,g.useEffect)(()=>{let e=d.current;if(!e)return;let t=new ResizeObserver(e=>{let t=e[0];t&&m(t.contentRect.width)});return t.observe(e),()=>t.disconnect()},[]);let p=te[o],h=!c&&"100%"!==p,f="number"==typeof p?p:u,x=h&&u>0&&f>u?u/f:1;return(0,i.jsx)("div",{ref:d,className:(0,_.cn)("relative flex h-full w-full items-start justify-center overflow-hidden",(null==a?void 0:a.status)==="success"&&h&&"[background-image:radial-gradient(rgba(0,0,0,0.07)_1px,transparent_1px)] [background-size:16px_16px] dark:[background-image:radial-gradient(rgba(255,255,255,0.1)_1px,transparent_1px)]"),children:(()=>{if(s)return(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,i.jsx)(lf,{})});if(!a)return null;if("build-error"===a.status){let e=0===a.files.length;return(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:e?(0,i.jsx)(lg,{}):(0,i.jsx)(lf,{})})}if("pending"===a.status){let e=a.files.length>0;return(0,i.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,i.jsx)(lh,{statusText:e?"Building...":"Thinking..."})})}return(0,i.jsx)("div",{className:(0,_.cn)("h-full",!c&&"transition-all duration-200 ease-out",h&&"border-border-faint rounded-lg border bg-white shadow-lg dark:bg-neutral-900"),style:{width:h?f:"100%",transform:x<1?"scale(".concat(x,")"):void 0,transformOrigin:"top center"},children:(0,i.jsx)("iframe",{src:(()=>{if(!a||"success"!==a.status)return"";try{let e=new URL(a.previewUrl);return e.pathname=l,e.searchParams.set("embed","true"),e.toString()}catch(e){return a.previewUrl}})(),className:"h-full w-full border-0",sandbox:"allow-scripts allow-same-origin allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-presentation allow-popups",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth",title:"Option ".concat(e.toUpperCase()," Preview"),referrerPolicy:"origin-when-cross-origin"},n)})})()})}function ly(){let[e]=tn();return(0,i.jsx)("div",{className:"flex h-full flex-col",children:(0,i.jsx)("div",{className:"flex-1 overflow-hidden",children:"preview"===e.mode?(0,i.jsx)(lb,{}):(0,i.jsx)(lx,{})})})}function lw(e){var t;let{className:a,hideOptionTabs:s=!1,showSelectedOnly:n=!1}=e,[o,c]=tn(),[u,p]=tr(),h=(0,m.kH)(m.Q_),x=to(u),{data:v}=iB(null!=x?x:null),b=(null==v?void 0:v.status)==="success"?v.previewUrl:null,y=null!=(t=null==v?void 0:v.files)?t:[],[,w]=td(),[j,k]=tu(),[E,A]=(0,g.useState)(j);(0,g.useEffect)(()=>{A(j)},[j]);let{setLocation:C}=(0,eV.G)(),B=(0,S.d)("md"),T=(0,N.g)(e=>e.title),[,I]=(0,i0.A)(),[R,M]=tm(),D=()=>{if(!b)return"";try{let e=new URL(b);return e.pathname=j,e.toString()}catch(e){return b}},O=async()=>{if(h)return void C("webdev-preview-url");if(0===y.length||!x)return;let e=T.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");try{await nK(y,"".concat(e||"project",".zip")),d.z.capture({action:"webdev_project_downloaded",params:{message_id:x.id,file_count:y.length}})}catch(e){f.oR.error("Failed to download project")}},P=!b||h,z=!b||0===y.length,L=(0,_.cn)("bg-transparent data-[state=active]:shadow-sm data-[state=active]:text-text-primary data-[state=inactive]:text-text-tertiary","data-[state=active]:bg-surface-tertiary");return(0,i.jsx)(eo.TooltipProvider,{children:(0,i.jsxs)("div",{className:(0,_.cn)("flex min-h-0 flex-col",a),children:[!s&&!n&&(0,i.jsx)("div",{className:"h-12 flex-none",children:(0,i.jsx)(nJ.tU,{value:u,onValueChange:e=>{p(e,"canvas"),c({mode:"preview"},"canvas")},children:(0,i.jsxs)(nJ.j7,{className:"bg-surface-primary grid h-12 grid-cols-2 items-stretch rounded-none p-0",children:[(0,i.jsx)(lj,{position:"a"}),(0,i.jsx)(lj,{position:"b"})]})})}),!s&&n&&(0,i.jsx)(lN,{model:u}),s&&B&&(0,i.jsx)("div",{className:"h-4 flex-none"}),(0,i.jsx)("div",{className:"border-border-faint bg-surface-raised-alt flex-none border-b",children:(0,i.jsxs)("div",{className:"flex h-12 items-center gap-1.5 px-2 py-1 md:gap-2",children:[(0,i.jsx)(nJ.tU,{value:o.mode,onValueChange:e=>c("preview"===e?{mode:"preview"}:{mode:"code"},"canvas"),className:"shrink-0",children:(0,i.jsxs)(nJ.j7,{className:"bg-surface-secondary items-stretch",children:[(0,i.jsx)(nJ.Xi,{value:"preview","aria-label":"Preview",className:L,title:"Preview",children:(0,i.jsx)(r.Eye,{className:"h-4 w-4"})}),(0,i.jsx)(nJ.Xi,{value:"code","aria-label":"Code",className:L,title:"Code",children:(0,i.jsx)(r.Code,{className:"h-4 w-4"})})]})}),(0,i.jsx)("div",{className:"hidden flex-1 md:block"}),"preview"===o.mode&&(0,i.jsx)("div",{className:"hidden md:block",children:(0,i.jsxs)(rm.rI,{children:[(0,i.jsx)(rm.ty,{asChild:!0,children:(0,i.jsxs)(l.Button,{variant:"ghost",size:"icon",className:"size-8",disabled:!b,children:["desktop"===R&&(0,i.jsx)(r.Monitor,{className:"size-4"}),"tablet"===R&&(0,i.jsx)(r.Tablet,{className:"size-4"}),"mobile"===R&&(0,i.jsx)(r.Smartphone,{className:"size-4"})]})}),(0,i.jsxs)(rm.SQ,{align:"center",className:"w-36",children:[(0,i.jsxs)(rm._2,{onClick:()=>M("desktop"),children:[(0,i.jsx)(r.Monitor,{className:"size-4"}),"Desktop"]}),(0,i.jsxs)(rm._2,{onClick:()=>M("tablet"),children:[(0,i.jsx)(r.Tablet,{className:"size-4"}),"Tablet"]}),(0,i.jsxs)(rm._2,{onClick:()=>M("mobile"),children:[(0,i.jsx)(r.Smartphone,{className:"size-4"}),"Mobile"]})]})]})}),(0,i.jsxs)("div",{className:"border-border-faint bg-surface-secondary flex h-9 min-w-0 flex-1 items-center gap-1.5 rounded-md border px-2 py-1 md:w-full md:max-w-lg md:flex-initial",children:[(0,i.jsxs)(eo.m_,{open:!!b&&void 0,children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:"inline-flex",children:(0,i.jsx)(l.Button,{variant:"ghost",size:"icon",className:"size-6 shrink-0 p-0",disabled:!b,onClick:()=>{w(e=>e+1)},children:(0,i.jsx)(r.RefreshCw,{className:"size-3.5"})})})}),(0,i.jsx)(eo.ZI,{children:(0,i.jsx)("p",{children:"Refresh preview"})})]}),h?(0,i.jsx)("button",{type:"button",className:"text-text-secondary hover:text-text-primary min-w-0 flex-1 cursor-pointer truncate text-left text-sm transition-colors",onClick:()=>C("webdev-preview-url"),children:"Log in to view preview URL"}):(0,i.jsxs)("div",{className:"flex min-w-0 flex-1 items-center overflow-hidden",children:[(0,i.jsx)("span",{className:"text-text-quaternary shrink-0 text-sm",children:(()=>{if(!b)return"";try{let e=new URL(b).hostname,t=e.split(".");if(t.length>2)return"".concat(t[0].slice(0,28),"...").concat(t.slice(-2).join("."));return e}catch(e){return""}})()}),(0,i.jsx)("input",{type:"text",value:E,onChange:e=>A(e.target.value),onKeyDown:e=>{if("Enter"===e.key){e.currentTarget.blur();let t=E.startsWith("/")?E:"/".concat(E);k(t),A(t),w(e=>e+1)}},disabled:!b,className:"text-text-secondary placeholder:text-text-tertiary min-w-0 flex-1 bg-transparent text-sm outline-none disabled:cursor-not-allowed",placeholder:"/"})]}),(0,i.jsxs)(eo.m_,{open:!P&&void 0,children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:(0,_.cn)("inline-flex",P&&"cursor-not-allowed"),children:(0,i.jsx)(iV.i,{size:17,className:"size-6 shrink-0 p-0",variant:"ghost",disabled:P,onClick:()=>I(D())})})}),(0,i.jsx)(eo.ZI,{children:(0,i.jsx)("p",{children:"Copy URL"})})]}),(0,i.jsxs)(eo.m_,{open:!P&&void 0,children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsx)("span",{className:(0,_.cn)("inline-flex",P&&"cursor-not-allowed"),children:(0,i.jsx)(l.Button,{variant:"ghost",size:"icon",className:"size-6 shrink-0",disabled:P,onClick:()=>{let e=D();e&&window.open(e,"_blank","noopener,noreferrer")},children:(0,i.jsx)(r.ExternalLink,{className:"size-3.5"})})})}),(0,i.jsx)(eo.ZI,{children:(0,i.jsx)("p",{children:"Open in new tab"})})]})]}),(0,i.jsx)("div",{className:"hidden flex-1 md:block"}),(0,i.jsxs)(eo.m_,{children:[(0,i.jsx)(eo.k$,{asChild:!0,children:(0,i.jsxs)(l.Button,{variant:"tertiary",size:"sm",disabled:z,onClick:()=>void O(),className:"group h-9 w-9 shrink-0 gap-0 p-0 md:h-auto md:w-auto md:shrink md:gap-1.5 md:px-3 md:py-1",children:[(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0",children:[(0,i.jsxs)("g",{className:"transition-transform duration-200 ease-out group-hover:-translate-y-[1px]",children:[(0,i.jsx)("path",{d:"M12 3v12"}),(0,i.jsx)("path",{d:"m8 11 4 4 4-4"})]}),(0,i.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",className:"transition-transform duration-200 ease-out group-hover:translate-y-[1px]"})]}),(0,i.jsx)("span",{className:"hidden md:inline",children:"Download"})]})}),(0,i.jsx)(eo.ZI,{side:"bottom",align:"end",className:"text-xs",children:(0,i.jsx)("p",{children:"Download Project as Zip File"})})]})]})}),(0,i.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,i.jsx)(ly,{})})]})})}function lj(e){let{position:t,className:a}=e,n=(0,L.g)(e=>e.models),o=to(t),c=sl(o),d=(0,N.g)(e=>e.pairwiseFeedbacks),u=o?sa(o,d):null,{handleVote:m,createIndividualVoteHandlers:p}=i7(),h=sn(),g="treatment"===(0,A._P)("webdev-voting-buttons"),f=t9(o,n,"Option"),x=t6(),v=o?n.find(e=>e.id===o.modelId):null,b=null==v?void 0:v.organization,y=t===th.BQ.a?s.sb.MODEL_A:s.sb.MODEL_B,{handleMouseEnter:w,handleMouseLeave:j}=p(t),k=x("".concat(t.toUpperCase()," is better"));return(0,i.jsx)(nJ.Xi,{asChild:!0,value:t,children:(0,i.jsxs)("span",{className:(0,_.cn)("flex min-w-0 cursor-pointer justify-between gap-2 overflow-hidden rounded-none transition-all","data-[state=active]:bg-surface-raised-alt data-[state=active]:text-text-primary data-[state=active]:font-medium","data-[state=inactive]:bg-surface-primary data-[state=inactive]:text-text-tertiary hover:bg-surface-raised/50","a"===t?"rounded-tr-xl":"rounded-tl-xl",a),children:[(0,i.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:["string"==typeof b&&(0,i.jsx)(el.D,{organization:b,className:"size-4 shrink-0"}),(null==o?void 0:o.status)===s.nH.PENDING&&(0,i.jsx)(iH.R,{className:"h-4 w-4 flex-shrink-0 animate-spin"}),(null==o?void 0:o.status)===s.nH.PENDING?(0,i.jsx)(ai,{className:"truncate font-mono text-sm",duration:1.5,spread:1,children:f}):(0,i.jsx)("span",{className:"truncate",children:f}),c?(0,i.jsx)("span",{className:"h-2 w-2 shrink-0 rounded-full bg-green-500"}):null,"win"===u?(0,i.jsx)(r.Trophy,{className:"text-interactive-positive shrink-0",size:16}):null]}),g&&null===u&&(0,i.jsx)(eZ.G,{content:"View both previews to vote",wrapDisabled:!h,open:!h&&void 0,children:(0,i.jsx)(l.Button,{onClick:e=>{e.stopPropagation(),m(y)},disabled:!h,variant:"outline",size:"sm",className:"bg-surface-secondary/50 hover:bg-interactive-positive/12 hover:text-interactive-positive hover:border-interactive-positive ml-auto h-8 shrink-0 gap-1.5 rounded-lg px-3",onMouseEnter:w,onMouseLeave:j,children:k})})]})})}function lN(e){let{model:t}=e,a=(0,L.g)(e=>e.models),n=to(null!=t?t:"a"),o=(0,N.g)(e=>e.pairwiseFeedbacks),c=n?sa(n,o):null,{handleVote:d,createIndividualVoteHandlers:u}=i7(),m=sn(),p="treatment"===(0,A._P)("webdev-voting-buttons"),h=t9(n,a,"Option"),g=t6(),f=n?a.find(e=>e.id===n.modelId):null,x=null==f?void 0:f.organization,v=null!=t?t:"a",b=v===th.BQ.a?s.sb.MODEL_A:s.sb.MODEL_B,{handleMouseEnter:y,handleMouseLeave:w}=u(v),j=g("".concat(v.toUpperCase()," is better"));return(0,i.jsx)("div",{className:"border-border mt-1 h-12 flex-none",children:(0,i.jsxs)("div",{className:"flex h-12 items-center justify-between gap-2 px-3",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:["string"==typeof x&&(0,i.jsx)(el.D,{organization:x,className:"size-4"}),(null==n?void 0:n.status)===s.nH.PENDING?(0,i.jsx)(ai,{className:"text-text-secondary text-sm",duration:1.5,spread:1,children:h}):(0,i.jsx)("span",{className:"text-text-secondary text-sm",children:h}),"win"===c?(0,i.jsx)(r.Trophy,{className:"text-interactive-positive",size:16}):null]}),p&&null===c&&(0,i.jsx)(eZ.G,{content:"View both previews to vote",wrapDisabled:!m,open:!m&&void 0,children:(0,i.jsx)(l.Button,{onClick:()=>{d(b)},disabled:!m,variant:"outline",size:"sm",className:"bg-surface-secondary/50 hover:bg-interactive-positive/12 hover:text-interactive-positive hover:border-interactive-positive h-8 gap-1.5 rounded-lg px-3",onMouseEnter:y,onMouseLeave:w,children:j})})]})})}function lk(){let[e,t]=tc(),[a]=tr(),r=(0,N.g)(e=>e.mode),n=[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(r);return(0,i.jsx)(eD._s,{open:e,onOpenChange:t,children:(0,i.jsxs)(eD.zj,{className:"h-[95svh] max-h-[95svh]",children:[(0,i.jsx)(eD.BE,{className:"p-1",children:(0,i.jsxs)(eD.gk,{className:"sr-only",children:["WebDev Preview - Option ",null==a?void 0:a.toUpperCase()]})}),(0,i.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,i.jsx)(lw,{className:"h-full",hideOptionTabs:n,showSelectedOnly:!n})})]})})}function lE(e){let{messageA:t,messageB:a,firstMessageMap:s}=e,r=nn(t,a,s);return(0,i.jsx)("div",{className:"flex flex-col gap-2",children:(0,i.jsx)(nc,{messageA:t,messageB:a,selectedMessage:r})})}function lA(){let{messageThreads:e}=sr(),{mode:t,lastMessageIds:a,pairwiseFeedbacks:n}=(0,N.g)((0,k.k)(e=>({mode:e.mode,lastMessageIds:e.lastMessageIds,pairwiseFeedbacks:e.pairwiseFeedbacks}))),{handleVote:o,createTieVoteHandlers:c}=i7(),d=sn(),u=t6(),m="border border-border-medium",p=(0,_.cn)(m,"hover:text-interactive-positive focus:text-interactive-positive hover:border-interactive-positive focus:border-interactive-positive hover:bg-interactive-positive/10 focus:bg-interactive-positive/10"),h=(0,_.cn)(m,"hover:text-interactive-negative focus:text-interactive-negative hover:border-interactive-negative focus:border-interactive-negative hover:bg-interactive-negative/10 focus:bg-interactive-negative/10"),g=e[0],f=null==g?void 0:g.get("a"),x=null==g?void 0:g.get("b"),v=f&&x&&a.includes(f.id)&&a.includes(x.id),b=f?sa(f,n):null,y=(null==f?void 0:f.status)===s.nH.PENDING||(null==x?void 0:x.status)===s.nH.PENDING,w=v&&t!==s.lY.DIRECT&&null===b&&!y,{handleTieMouseEnter:j,handleBothBadMouseEnter:E,handleMouseLeave:A}=c();return(0,i.jsx)(sE.N,{mode:"wait",children:w&&(0,i.jsx)(sk.P.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:20,opacity:0},transition:{duration:.3,ease:"easeOut"},className:"flex justify-center",children:(0,i.jsxs)("div",{className:"border-border-faint bg-surface-tertiary flex w-[90%] items-center justify-center gap-2 rounded-t-xl border border-b-0 px-4 py-2.5",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(eZ.G,{content:"View both previews to vote",wrapDisabled:!d,wrapClassName:"block w-full",open:!d&&void 0,children:(0,i.jsxs)(l.Button,{size:"sm",variant:"secondary",className:(0,_.cn)("w-full rounded px-3 py-1 text-xs",p),disabled:!d,onClick:()=>o(s.sb.TIE),onMouseEnter:j,onMouseLeave:A,children:[(0,i.jsx)(r.ThumbsUp,{size:10}),u("Both are good")]})})}),(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(eZ.G,{content:"View both previews to vote",wrapDisabled:!d,wrapClassName:"block w-full",open:!d&&void 0,children:(0,i.jsxs)(l.Button,{size:"sm",variant:"secondary",className:(0,_.cn)("w-full rounded px-3 py-1 text-xs",h),disabled:!d,onClick:()=>o(s.sb.BOTH_BAD),onMouseEnter:E,onMouseLeave:A,children:[(0,i.jsx)(r.ThumbsDown,{size:10}),u("Both are bad")]})})})]})})})}function lC(e){let{evaluationFormProps:t,className:a}=e,{messageThreads:r}=sr(),n=(0,g.useRef)(null),l=(0,N.g)((0,k.k)(e=>({id:e.id,messagesLength:e.messages.length,hasViewedLatestResponses:e.hasViewedLatestResponses}))),{ref:o}=(0,sA.Wx)({threshold:0,rootMargin:eK}),{scrollContainerRef:c}=nG({hasViewedLatestResponses:l.hasViewedLatestResponses,checkpointRef:n,messagesLength:l.messagesLength,evaluationId:l.id});return(0,i.jsxs)("div",{className:(0,_.cn)("flex min-h-0 flex-col",a),children:[(0,i.jsx)("div",{className:"flex-none",children:(0,i.jsx)(eJ,{showLoginButton:!1})}),(0,i.jsx)("div",{className:"relative flex min-h-0 flex-1 flex-col",children:(0,i.jsxs)("div",{className:"absolute inset-0 flex flex-col",children:[(0,i.jsx)(ea.F,{className:"min-h-0 flex-1",ref:c,children:(0,i.jsx)("div",{className:"relative h-full w-full overscroll-none",children:(0,i.jsx)("div",{className:(0,_.cn)("flex flex-col items-center","px-3 [--chat-padding:theme(spacing.3)]"),children:(0,i.jsxs)("ol",{className:(0,_.cn)("mt-4 flex w-full max-w-screen-xl grow flex-col-reverse justify-end gap-3 overscroll-none pb-2 duration-500"),children:[(0,i.jsx)("div",{className:"h-0",ref:e=>{o(e),n.current=e}}),r.map((e,t)=>{var a,n;let l=e.get(th.BQ.a),o=e.get(th.BQ.b);if((null==l?void 0:l.role)===s.PG.USER)return(0,i.jsx)(sN,{message:l},null==l?void 0:l.id);let c="".concat(null!=(a=null==l?void 0:l.id)?a:"idx-".concat(t,"-a"),":").concat(null!=(n=null==o?void 0:o.id)?n:"idx-".concat(t,"-b"));return(0,i.jsx)(lE,{messageA:l,messageB:o,firstMessageMap:r[0]},c)})]})})})}),(0,i.jsx)("div",{className:"flex flex-col items-center px-3 pb-4",children:(0,i.jsxs)("div",{className:"w-full max-w-screen-xl",children:[(0,i.jsx)(lA,{}),(0,i.jsx)(ne,{...t})]})})]})}),(0,i.jsx)(lk,{})]})}function l_(e){let{evaluationFormProps:t,className:a}=e,{messageThreads:r,latestMessages:n}=sr(),l=ns(),o=(0,g.useRef)(null),c=(0,N.g)((0,k.k)(e=>({id:e.id,messagesLength:e.messages.length,hasViewedLatestResponses:e.hasViewedLatestResponses}))),{ref:d,inView:u}=(0,sA.Wx)({threshold:0,rootMargin:eK}),{scrollContainerRef:m}=nG({hasViewedLatestResponses:c.hasViewedLatestResponses,checkpointRef:o,messagesLength:c.messagesLength,evaluationId:c.id});return ni({checkpointInView:u,lastMessagesArr:n}),(0,i.jsxs)("div",{className:(0,_.cn)("flex min-h-0 flex-col",a),children:[(0,i.jsx)("div",{className:"flex-none",children:(0,i.jsx)(eJ,{showLoginButton:!1})}),(0,i.jsx)("div",{className:"relative flex min-h-0 flex-1 flex-col",children:(0,i.jsxs)("div",{className:"absolute inset-0 flex flex-col",children:[(0,i.jsx)(ea.F,{className:"min-h-0 flex-1",ref:m,children:(0,i.jsx)("div",{className:"relative h-full w-full overscroll-none",children:(0,i.jsx)("div",{className:(0,_.cn)("flex flex-col items-center","px-[--chat-padding] [--chat-padding:theme(spacing.4)]"),children:(0,i.jsxs)("ol",{className:(0,_.cn)("mt-8 flex w-full max-w-screen-xl grow flex-col-reverse justify-end gap-4 overscroll-none pb-2 duration-500"),children:[(0,i.jsx)("div",{className:"h-0",ref:e=>{d(e),o.current=e}}),l&&(0,i.jsx)("li",{className:"w-full max-w-screen-xl",children:(0,i.jsx)(sK,{})}),r.map((e,t)=>{var a,n;let l=e.get(th.BQ.a),o=e.get(th.BQ.b);if((null==l?void 0:l.role)===s.PG.USER)return(0,i.jsx)(sN,{message:l},null==l?void 0:l.id);let c="".concat(null!=(a=null==l?void 0:l.id)?a:"idx-".concat(t,"-a"),":").concat(null!=(n=null==o?void 0:o.id)?n:"idx-".concat(t,"-b"));return(0,i.jsx)(lE,{messageA:l,messageB:o,firstMessageMap:r[0]},c)})]})})})}),(0,i.jsx)("div",{className:"flex flex-col items-center px-4 pb-6",children:(0,i.jsxs)("div",{className:"w-full md:max-w-screen-xl",children:[(0,i.jsx)(lA,{}),(0,i.jsx)(ne,{...t,minRows:1})]})})]})})]})}function lB(e){let{evaluationFormProps:t}=e,a=(0,S.d)("md"),r=(0,N.g)(e=>e.mode),n=[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(r);return(0,i.jsx)(ti,{children:a?(0,i.jsx)(lC,{evaluationFormProps:t,className:"h-full"}):(0,i.jsxs)(nV,{direction:"horizontal",children:[(0,i.jsx)(nW,{defaultSize:30,minSize:25,maxSize:50,children:(0,i.jsx)(l_,{evaluationFormProps:t,className:"h-full"})}),(0,i.jsx)(nY,{className:"data-[resize-handle-state=hover]:bg-sidebar-border data-[resize-handle-state=drag]:bg-sidebar-border data-[resize-handle-state=drag]:w-[2px]"}),(0,i.jsx)(nW,{defaultSize:70,minSize:50,maxSize:75,children:(0,i.jsx)(lw,{className:"h-full",hideOptionTabs:n})})]})})}var lT=function(e){return e.WEBDEV_MODE="webdev_mode",e.EVALUATION_CHAT="evaluation_chat",e.NEW_PAGE_PLACEHOLDER="new_page_placeholder",e}(lT||{});function lI(e){let{userHasHistory:t}=e,a=(0,g.useRef)(null),r=(0,g.useRef)(null),n=(0,N.g)((0,k.k)(e=>({id:e.id,mode:e.mode,modality:e.modality,messagesLength:e.messages.length,loading:e.loading,hasViewedLatestResponses:e.hasViewedLatestResponses}))),l=(0,w.a8)(),o=(0,g.useRef)(null),[c,u]=(0,g.useState)(!1),p=l.startsWith("/c/")&&"/c"!==l,x="/"===l||(0,j.SO)(l),v=x?"new_page_placeholder":p&&n.loading?n.modality===s.Jg.WEBDEV?"webdev_mode":"evaluation_chat":(p||0!==n.messagesLength)&&n.modality===s.Jg.WEBDEV?"webdev_mode":"evaluation_chat",{messageThreads:A,latestMessages:C}=sr(),{fileUploaderProps:_,isImageUploadEnabled:B,isFileUploadEnabled:T,handlePaste:I,handleFilesSelected:R,maxFileSizeInMb:M}=function(e){let[t,a]=(0,h.fp)(Y.A),[,r]=$(),{mode:n,modality:l,setModality:o,messages:c}=(0,N.g)((0,k.k)(e=>({mode:e.mode,modality:e.modality,setModality:e.setModality,messages:e.messages}))),{modelAId:u,modelBId:m,models:p}=(0,L.g)(e=>e),x=(0,g.useMemo)(()=>H(n,u,m,p,l),[n,u,m,p,l]),v=(0,g.useMemo)(()=>t.some(e=>e.file.type.startsWith("video/")),[t]),b=(0,g.useMemo)(()=>t.some(e=>e.file.type.startsWith("image/")),[t]),y=(0,g.useMemo)(()=>l===s.Jg.VIDEO,[l])&&!b,w=x&&!v,j=(0,g.useMemo)(()=>V(n,u,m,p,l),[n,u,m,p,l]),E=l===s.Jg.VIDEO?10:15,A=(0,g.useMemo)(()=>t1(n,u,m,p),[n,u,m,p]),C=(0,g.useCallback)(e=>{a(t=>{var a;let i=[...t],s=i[e];if((null==(a=i[e])?void 0:a.preview)&&URL.revokeObjectURL(i[e].preview),i.splice(e,1),s){let e=t_(s.file.type);d.z.capture({action:"attachment_upload_abandoned",params:{mode:n,modality:l,attachment_type:e}})}return i})},[a,n,l]),_=(0,g.useMemo)(()=>{if(l===s.Jg.VIDEO)return!1;if(n===s.lY.BATTLE)return!0;for(let i of[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(n)?[u]:[u,m]){var e,t,a;let s=p.find(e=>e.id===i),r=null!=(a=null==s||null==(t=s.capabilities)||null==(e=t.inputCapabilities)?void 0:e.image)&&a;if("object"==typeof r&&!1===r.multipleImages)return!1}return!0},[n,u,m,p,l]),B=(0,g.useCallback)(async i=>{let c=i.filter(e=>e.type.startsWith("image/")),u=i.filter(e=>e.type.startsWith("video/")),m=i.filter(e=>z.EC.includes(e.type)),p=c.length>0&&u.length>0,h=c.length>0&&v||u.length>0&&b,g=c.length>0&&!w,x=u.length>0&&!y,N=m.length>0&&!j;if(p||h)return void f.oR.warning("Image and video cannot be combined",{description:"Please attach either image(s) or one video for this message."});if(g)return void console.warn("Selected model(s) do not support image input");if(x)return void console.warn("Selected model(s) do not support video input");if(N)return void console.warn("Selected model(s) do not support file input");for(let e of m.filter(e=>"application/pdf"===e.type)){let t=await rQ(e);if(t.isCorrupted)return void f.oR.warning("Unable to open file",{description:"It looks empty or didn't save properly"});if(t.pageCount&&t.pageCount>90)return void f.oR.warning("PDF page limit exceeded",{description:"File exceeds the ".concat(90," page limit")})}if(!_&&t.length+c.length>1)return void f.oR.warning("Multiple images not supported",{description:"Selected model only supports single image upload"});let k=t.filter(e=>z.EC.includes(e.file.type)),E=k.length+m.length;if(t.length+i.length>10||E>A)return void f.oR.warning("Maximum attachments reached",{description:"You have reached the max amount of attachments you can upload."});let C=i.map(e=>({file:e,preview:e.type.startsWith("image/")?URL.createObjectURL(e):void 0}));for(let e of(a(e=>[...e,...C]),m.length>0&&0===k.length&&l!==s.Jg.CHAT&&(o(s.Jg.CHAT),r(s.Jg.CHAT)),i)){let t=t_(e.type);d.z.capture({action:"attachment_upload",params:{mode:n,modality:l,attachment_type:t}})}e&&setTimeout(()=>{e()},0)},[t,n,_,b,v,w,y,j,e,a,l,o,r,A]),T=(0,g.useCallback)(e=>{let t=e.clipboardData.items,a=[];for(let e of t)if(e.type.startsWith("image/")){let t=e.getAsFile();t&&a.push(t)}a.length>0&&(e.preventDefault(),B(a))},[B]),I=(0,rK.A)(n);(0,g.useEffect)(()=>{if(I&&I!==n){t.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)}),a([]);return}!_&&t.length>1&&(a(t.slice(0,1)),f.oR.warning("Multiple images removed",{description:"Selected model only supports single image. Keeping first image only."}))},[t,_,a,n,I,l]);let S=(0,rK.A)(t);(0,g.useEffect)(()=>{var e;!(n!==s.lY.BATTLE||!(t.length>0&&(null!=(e=null==S?void 0:S.length)?e:0)===0&&0===c.length)||t.some(e=>"application/pdf"===e.file.type)||t.some(e=>e.file.type.startsWith("video/")))&&([s.Jg.VIDEO,s.Jg.IMAGE,s.Jg.WEBDEV,s.Jg.AUTO].includes(l)||(o(s.Jg.IMAGE),r(s.Jg.IMAGE)))},[t.length,null==S?void 0:S.length,l,o,r,c,n]);let R=function(e){let{onFilesSelected:t,attachments:a,onRemoveAttachment:s,isImageUploadEnabled:r=!0,isFileUploadEnabled:n=!0,maxFileSizeInMb:l=15,maxFiles:o}=e,c=(0,g.useCallback)(e=>{if(e.length>0){let t,a=e.map(e=>e.errors.map(e=>e.message).join(", ")),i=t=>e.some(e=>e.errors.some(e=>e.code===t));t=i(rG.O4.FileInvalidType)?"Failed to upload file. Unsupported file type.":i(rG.O4.FileTooLarge)?"Failed to upload file. Make sure the file is less than ".concat(l,"MB"):"Failed to upload file.",f.oR.error(t,{dismissible:!0}),console.error(a.join("\n"))}},[l]),d=(0,g.useCallback)(e=>{if(e.length>0){let a=e.filter(e=>e.type.startsWith("image/")),i=e.filter(e=>z.EC.includes(e.type));if(a.length>0&&!r)return void f.oR.error("Selected model(s) do not support image input",{dismissible:!0});if(i.length>0&&!n)return void f.oR.error("Selected model(s) do not support file input",{dismissible:!0});t(e)}},[t,r,n]),u={};r&&(u={...u,...rH}),n&&(u={...u,...rV});let{getRootProps:m,getInputProps:p,isDragActive:h}=(0,rG.VB)({onDrop:d,accept:u,maxSize:1024*l*1024,noClick:!0,maxFiles:null!=o?o:void 0,multiple:null==o||o>1,onDropRejected:c});return{getRootProps:m,getInputProps:p,isDragActive:h,renderAttachments:()=>{let e=a.map((e,t)=>({attachment:e,index:t})).filter(e=>{let{attachment:t}=e,a=t.file.type.startsWith("image/"),i=t.file.type.startsWith("video/"),s=z.EC.includes(t.file.type);return!!i||a&&r||s&&n});return 0===e.length?null:(0,i.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(e=>{let{attachment:t,index:a}=e;return(0,i.jsx)(rJ,{attachment:t,index:a,onRemoveAttachment:s},a)})})}}}({onFilesSelected:B,attachments:t,onRemoveAttachment:C,isImageUploadEnabled:w,isFileUploadEnabled:j,maxFileSizeInMb:E,maxFiles:_?void 0:1});return(0,g.useEffect)(()=>()=>{t.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)})},[t]),{handleRemoveAttachment:C,handleFilesSelected:B,handlePaste:T,fileUploaderProps:R,isImageUploadEnabled:w,isFileUploadEnabled:j,maxFileSizeInMb:E}}(()=>{var e;null==(e=a.current)||e.focus()}),D=n.modality===s.Jg.WEBDEV,O=(0,g.useCallback)(()=>{var e;null==(e=r.current)||e.click()},[]),{scrollContainerRef:P,scrollToBottom:U}=nG({hasViewedLatestResponses:n.hasViewedLatestResponses,checkpointRef:o,messagesLength:n.messagesLength,evaluationId:n.id}),{sendMessage:F}=function(e){let{setIsSubmitting:t,textAreaRef:a,scrollToBottom:i}=e,r=(0,N.g)((0,k.k)(e=>({id:e.id,noMessages:0===e.messages.length,modality:e.modality,mode:e.mode}))),n=(0,m.kH)(e=>e.user),l=(0,m.kH)(e=>e.userId),o=(0,m.kH)(m.Q_),c=(0,L.g)(e=>e),{setOpen:u,setPromiseHandlers:p}=b(),{appendMultiStream:f}=tH(),[x,v]=(0,h.fp)(Y.A),{setOpen:y}=(0,E.cL)(),w=(0,S.d)("md"),{setLocation:j}=(0,eV.G)(),{reset:A}=sH(),{dismissEducation:C}=(0,rn.f)(),_=(0,g.useCallback)(async e=>await Promise.all(e.map(async(e,t)=>{if(e.isAlreadyUploaded&&e.uploadedUrl)return{key:e.file.name,url:e.uploadedUrl,mimeType:e.file.type};try{return v(e=>e.map((e,a)=>a===t?{...e,uploading:!0}:e)),await sq(e.file)}catch(e){throw v(e=>e.map((e,a)=>a===t?{...e,error:"Upload failed"}:e)),e}})),[v]);return{sendMessage:(0,g.useCallback)(async(e,m,h)=>{let g=null!=h?h:x;if(!e.trim()&&0===g.length)return!1;let b=async()=>{try{var n,o,u,p,h,x,b,j,N;t(!0),iY.Fr&&(null==(n=a.current)||n.blur());let k=g.length>0?await _(g):[],E=null!=(o=null==c?void 0:c.modelAId)?o:null,B=null!=(u=null==c?void 0:c.modelBId)?u:null,T=g.some(e=>!0===e.isAlreadyUploaded),I=k.map(e=>t_(e.mimeType)),S=tI(k.map(e=>({contentType:e.mimeType})));d.z.capture({action:"chat_submit",params:{is_first_message:r.noMessages,mode:r.mode,user_id:l,modality:r.modality,evaluation_session_id:r.id,model_a_id:E,model_b_id:B,has_attachments:k.length>0,attachments_count:k.length,attachment_type:I.length>0?I:void 0,file_count:S,input_length:e.length,has_edited_images:T}}),[s.lY.DIRECT,s.lY.DIRECT_BATTLE].includes(r.mode)?null==(h=window)||null==(p=h.gtag)||p.call(h,"event","conversion_event_chat_direct"):r.mode===s.lY.SIDE_BY_SIDE?null==(b=window)||null==(x=b.gtag)||x.call(b,"event","conversion_event_chat_sbs"):r.mode===s.lY.BATTLE&&(null==(N=window)||null==(j=N.gtag)||j.call(N,"event","conversion_event_chat_battle")),v([]),A(),C(),f({content:e,experimental_attachments:k.map((e,t)=>{var a,i,s;let r=null==(a=g[t])?void 0:a.preview,n=e.mimeType.startsWith("video/")&&null!=r&&r.startsWith("https://")?r:void 0;return{name:null!=(s=null==(i=g[t])?void 0:i.file.name)?s:e.key,contentType:e.mimeType,url:e.url,...null!=n?{thumbnailUrl:n}:{}}}),metadata:{...null!=m?m:{}}}),r.noMessages&&(window.history.replaceState({},"","/c/".concat(r.id)),document.cookie.split("; ").some(e=>e.startsWith("".concat(th.pC.sidebarState,"=")))||w||y(!0)),i&&setTimeout(()=>{i()},100)}catch(e){throw console.error("Failed to send message:",e),e}finally{t(!1)}};try{if(((null==n?void 0:n.touConsentTimestamp)==null||new Date(n.touConsentTimestamp)<eX)&&await new Promise((e,t)=>{p({resolve:e,reject:t}),u(!0)}),r.modality===s.Jg.VIDEO&&o)return j("video-modality-chat-submit"),!1;if(g.some(e=>"application/pdf"===e.file.type)&&o)return j("document-upload-chat-submit"),!1;return await b(),!0}catch(e){return console.error("Failed to send message",e),!1}},[f,C,r,w,x,c,A,i,v,t,j,p,y,u,a,_,n,l,o])}}({setIsSubmitting:u,textAreaRef:a,scrollToBottom:U}),G=(0,g.useMemo)(()=>({sendMessage:F,latestMessages:C,isSubmitting:c,textAreaRef:a,handlePaste:I,handleFilesSelected:R,fileUploaderProps:_,isImageUploadEnabled:B,isFileUploadEnabled:T,maxFileSizeInMb:M,showScreenshotOption:D}),[F,c,I,R,_,C,B,T,M,D]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{id:eQ,className:"relative flex h-full flex-col overflow-hidden overscroll-none",children:["webdev_mode"!==v&&(0,i.jsx)(eJ,{}),(0,i.jsx)("div",{className:"flex min-h-0 flex-1 justify-center overflow-hidden overscroll-none",children:(0,i.jsx)("main",{className:"relative flex h-full min-w-0 flex-1 flex-col overflow-hidden overscroll-none outline-none",..._.getRootProps(),children:(()=>{switch(v){case"webdev_mode":return(0,i.jsx)(lB,{evaluationFormProps:G});case"evaluation_chat":return(0,i.jsx)(nz,{evaluationFormProps:G,textAreaRef:a,fileInputRef:r,openFilePicker:O,scrollableAreaRef:P,checkpointElementRef:o,messageThreads:A,latestMessages:C});case"new_page_placeholder":return(0,i.jsx)(nL,{evaluationFormProps:G,textAreaRef:a,fileInputRef:r,openFilePicker:O,userHasHistory:t})}})()})})]}),(0,i.jsx)(K,{}),(0,i.jsx)(y,{})]})}},66818:(e,t)=>{"use strict";t.N=function(e){var t;switch((null!=(t=e.split(".").at(-1))?t:"").toLowerCase()){case"html":return"text/html";case"js":case"jsx":case"ts":case"tsx":return"text/javascript";case"css":return"text/css";case"md":return"text/markdown";case"json":return"application/json";default:return"text/plain"}}},68336:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SWITCHING_PROTOCOLS=t.SERVICE_UNAVAILABLE=t.SEE_OTHER=t.RESET_CONTENT=t.REQUESTED_RANGE_NOT_SATISFIABLE=t.REQUEST_URI_TOO_LONG=t.REQUEST_TOO_LONG=t.REQUEST_TIMEOUT=t.REQUEST_HEADER_FIELDS_TOO_LARGE=t.PROXY_AUTHENTICATION_REQUIRED=t.UPGRADE_REQUIRED=t.EARLY_HINTS=t.PROCESSING=t.PRECONDITION_REQUIRED=t.PRECONDITION_FAILED=t.PERMANENT_REDIRECT=t.PAYMENT_REQUIRED=t.PARTIAL_CONTENT=t.OK=t.NOT_MODIFIED=t.NOT_IMPLEMENTED=t.NOT_FOUND=t.NOT_ACCEPTABLE=t.NON_AUTHORITATIVE_INFORMATION=t.NO_CONTENT=t.NETWORK_AUTHENTICATION_REQUIRED=t.MULTIPLE_CHOICES=t.MULTI_STATUS=t.MOVED_TEMPORARILY=t.MOVED_PERMANENTLY=t.METHOD_NOT_ALLOWED=t.METHOD_FAILURE=t.LOCKED=t.LENGTH_REQUIRED=t.INTERNAL_SERVER_ERROR=t.INSUFFICIENT_STORAGE=t.INSUFFICIENT_SPACE_ON_RESOURCE=t.IM_A_TEAPOT=t.HTTP_VERSION_NOT_SUPPORTED=t.GONE=t.GATEWAY_TIMEOUT=t.FORBIDDEN=t.FAILED_DEPENDENCY=t.EXPECTATION_FAILED=t.CREATED=t.CONTINUE=t.CONFLICT=t.BAD_REQUEST=t.BAD_GATEWAY=t.ACCEPTED=void 0,t.DATABASE_ERROR=t.VALIDATION_ERROR=t.MISDIRECTED_REQUEST=t.USE_PROXY=t.UNSUPPORTED_MEDIA_TYPE=t.UNPROCESSABLE_ENTITY=t.UNAVAILABLE_FOR_LEGAL_REASONS=t.UNAUTHORIZED=t.TOO_MANY_REQUESTS=t.TEMPORARY_REDIRECT=void 0,t.ACCEPTED="Accepted",t.BAD_GATEWAY="Bad Gateway",t.BAD_REQUEST="Bad Request",t.CONFLICT="Conflict",t.CONTINUE="Continue",t.CREATED="Created",t.EXPECTATION_FAILED="Expectation Failed",t.FAILED_DEPENDENCY="Failed Dependency",t.FORBIDDEN="Forbidden",t.GATEWAY_TIMEOUT="Gateway Timeout",t.GONE="Gone",t.HTTP_VERSION_NOT_SUPPORTED="HTTP Version Not Supported",t.IM_A_TEAPOT="I'm a teapot",t.INSUFFICIENT_SPACE_ON_RESOURCE="Insufficient Space on Resource",t.INSUFFICIENT_STORAGE="Insufficient Storage",t.INTERNAL_SERVER_ERROR="Internal Server Error",t.LENGTH_REQUIRED="Length Required",t.LOCKED="Locked",t.METHOD_FAILURE="Method Failure",t.METHOD_NOT_ALLOWED="Method Not Allowed",t.MOVED_PERMANENTLY="Moved Permanently",t.MOVED_TEMPORARILY="Moved Temporarily",t.MULTI_STATUS="Multi-Status",t.MULTIPLE_CHOICES="Multiple Choices",t.NETWORK_AUTHENTICATION_REQUIRED="Network Authentication Required",t.NO_CONTENT="No Content",t.NON_AUTHORITATIVE_INFORMATION="Non Authoritative Information",t.NOT_ACCEPTABLE="Not Acceptable",t.NOT_FOUND="Not Found",t.NOT_IMPLEMENTED="Not Implemented",t.NOT_MODIFIED="Not Modified",t.OK="OK",t.PARTIAL_CONTENT="Partial Content",t.PAYMENT_REQUIRED="Payment Required",t.PERMANENT_REDIRECT="Permanent Redirect",t.PRECONDITION_FAILED="Precondition Failed",t.PRECONDITION_REQUIRED="Precondition Required",t.PROCESSING="Processing",t.EARLY_HINTS="Early Hints",t.UPGRADE_REQUIRED="Upgrade Required",t.PROXY_AUTHENTICATION_REQUIRED="Proxy Authentication Required",t.REQUEST_HEADER_FIELDS_TOO_LARGE="Request Header Fields Too Large",t.REQUEST_TIMEOUT="Request Timeout",t.REQUEST_TOO_LONG="Request Entity Too Large",t.REQUEST_URI_TOO_LONG="Request-URI Too Long",t.REQUESTED_RANGE_NOT_SATISFIABLE="Requested Range Not Satisfiable",t.RESET_CONTENT="Reset Content",t.SEE_OTHER="See Other",t.SERVICE_UNAVAILABLE="Service Unavailable",t.SWITCHING_PROTOCOLS="Switching Protocols",t.TEMPORARY_REDIRECT="Temporary Redirect",t.TOO_MANY_REQUESTS="Too Many Requests",t.UNAUTHORIZED="Unauthorized",t.UNAVAILABLE_FOR_LEGAL_REASONS="Unavailable For Legal Reasons",t.UNPROCESSABLE_ENTITY="Unprocessable Entity",t.UNSUPPORTED_MEDIA_TYPE="Unsupported Media Type",t.USE_PROXY="Use Proxy",t.MISDIRECTED_REQUEST="Misdirected Request",t.VALIDATION_ERROR="Validation error",t.DATABASE_ERROR="Database error"},68838:(e,t,a)=>{"use strict";a.d(t,{w:()=>s});var i=a(96884);let s=(0,i.createServerReference)("601518c14e2ad5ee8dbc5827a9b900ee04c3c6d926",i.callServer,void 0,i.findSourceMapURL,"getProxyImage")},69460:(e,t,a)=>{"use strict";a.d(t,{G:()=>n});var i=a(91147),s=a(7860),r=a(42328);function n(e){let{children:t,content:a,open:n,className:l,wrapDisabled:o=!1,wrapClassName:c}=e,d=o?(0,i.jsx)("span",{className:(0,s.cn)("inline-block",c),children:t}):t;return(0,i.jsxs)(r.m_,{open:n,children:[(0,i.jsx)(r.k$,{asChild:!0,children:d}),(0,i.jsx)(r.ZI,{className:(0,s.cn)("bg-header-primary text-interactive-on-cta",l),children:a})]})}},72711:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>g,gC:()=>h,l6:()=>o,mi:()=>f,s3:()=>c,yv:()=>d});var i=a(91147),s=a(23817),r=a(41568),n=a(7860),l=a(55771);let o=s.bL,c=s.YJ,d=s.WT,u=l.forwardRef((e,t)=>{let{className:a,children:l,...o}=e;return(0,i.jsxs)(s.l9,{ref:t,className:(0,n.cn)("border-border text-header-secondary hover:text-header-primary data-[state=open]:text-text-tertiary ring-offset-background placeholder:text-muted-foreground focus:ring-ring group flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border px-3 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:block [&>span]:truncate",a),...o,children:[l,(0,i.jsx)(s.In,{asChild:!0,children:(0,i.jsx)(r.ChevronDown,{className:"h-[18px] w-[18px] transition-transform duration-200 group-data-[state=open]:-rotate-180"})})]})});u.displayName=s.l9.displayName;let m=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,i.jsx)(s.PP,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,i.jsx)(r.ChevronUp,{className:"h-4 w-4"})})});m.displayName=s.PP.displayName;let p=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,i.jsx)(s.wn,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...l,children:(0,i.jsx)(r.ChevronDown,{className:"h-4 w-4"})})});p.displayName=s.wn.displayName;let h=l.forwardRef((e,t)=>{let{className:a,children:r,position:l="popper",...o}=e;return(0,i.jsx)(s.ZL,{children:(0,i.jsxs)(s.UC,{ref:t,className:(0,n.cn)("border-border-faint bg-surface-primary text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-[9999] max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-0",a),position:l,...o,children:[(0,i.jsx)(m,{}),(0,i.jsx)(s.LM,{className:(0,n.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,i.jsx)(p,{})]})})});h.displayName=s.UC.displayName,l.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,i.jsx)(s.JU,{ref:t,className:(0,n.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=s.JU.displayName;let g=l.forwardRef((e,t)=>{let{className:a,children:l,showCheck:o=!0,...c}=e;return(0,i.jsxs)(s.q7,{ref:t,className:(0,n.cn)("hover:bg-surface-highlight focus:bg-surface-highlight data-[state=checked]:text-text-tertiary relative flex w-full cursor-default select-none items-center rounded-sm p-2 text-sm font-medium outline-none transition-colors duration-200 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,i.jsx)(s.p4,{children:l}),o&&(0,i.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(s.VF,{children:(0,i.jsx)(r.CheckIcon,{className:"size-4"})})})]})});g.displayName=s.q7.displayName;let f=l.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,i.jsx)(s.wv,{ref:t,className:(0,n.cn)("bg-muted -mx-1 my-1 h-px",a),...r})});f.displayName=s.wv.displayName},79787:(e,t,a)=>{"use strict";a.d(t,{Y:()=>s});var i=a(55771);function s(e,t){let a=(0,i.useRef)(e),s=(0,i.useRef)(null);(0,i.useEffect)(()=>{a.current=e},[e]);let r=(0,i.useCallback)(function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{a.current(...i)},t)},[t]);return(0,i.useEffect)(()=>()=>{s.current&&clearTimeout(s.current)},[]),r}},83245:()=>{},83718:(e,t,a)=>{"use strict";a.d(t,{F:()=>l});var i=a(91147),s=a(76016),r=a(7860),n=a(55771);let l=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,i.jsxs)(s.bL,{ref:t,className:(0,r.cn)("relative overflow-hidden",a),...l,children:[(0,i.jsx)(s.LM,{className:"h-full w-full rounded-[inherit] [&>div]:!block [&>div]:!h-full",children:n}),(0,i.jsx)(o,{}),(0,i.jsx)(s.OK,{})]})});l.displayName=s.bL.displayName;let o=n.forwardRef((e,t)=>{let{className:a,orientation:n="vertical",...l}=e;return(0,i.jsx)(s.VM,{ref:t,orientation:n,className:(0,r.cn)("flex touch-none select-none transition-colors","vertical"===n&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===n&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...l,children:(0,i.jsx)(s.lr,{className:"bg-border relative flex-1 rounded-full"})})});o.displayName=s.VM.displayName},84602:(e,t,a)=>{"use strict";a.d(t,{G7:()=>c,L$:()=>m,h_:()=>p,oI:()=>d,uB:()=>o,xL:()=>u});var i=a(91147),s=a(41568);a(1835);var r=a(7860),n=a(98104),l=a(55771);let o=l.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)(n.uB,{ref:t,className:(0,r.cn)("bg-surface-primary border-border-faint text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md border",a),...s})});o.displayName=n.uB.displayName;let c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,i.jsxs)("div",{className:"border-border-faint flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,i.jsx)(s.Search,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,i.jsx)(n.uB.Input,{ref:t,className:(0,r.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-base outline-none disabled:cursor-not-allowed disabled:opacity-50 sm:text-sm",a),...l})]})});c.displayName=n.uB.Input.displayName;let d=e=>{let{className:t,...a}=e;return(0,i.jsx)(n.uB.List,{className:(0,r.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...a})};d.displayName=n.uB.List.displayName;let u=l.forwardRef((e,t)=>(0,i.jsx)(n.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));u.displayName=n.uB.Empty.displayName;let m=l.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)(n.uB.Group,{ref:t,className:(0,r.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",a),...s})});m.displayName=n.uB.Group.displayName,l.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)(n.uB.Separator,{ref:t,className:(0,r.cn)("bg-border -mx-1 h-px",a),...s})}).displayName=n.uB.Separator.displayName;let p=l.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,i.jsx)(n.uB.Item,{ref:t,className:(0,r.cn)("data-[selected=true]:text-text-primary relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0","hover:bg-surface-tertiary data-[selected=true]:bg-surface-tertiary",a),...s})});p.displayName=n.uB.Item.displayName},91256:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SWITCHING_PROTOCOLS=t.SERVICE_UNAVAILABLE=t.SEE_OTHER=t.RESET_CONTENT=t.REQUESTED_RANGE_NOT_SATISFIABLE=t.REQUEST_URI_TOO_LONG=t.REQUEST_TOO_LONG=t.REQUEST_TIMEOUT=t.REQUEST_HEADER_FIELDS_TOO_LARGE=t.PROXY_AUTHENTICATION_REQUIRED=t.UPGRADE_REQUIRED=t.EARLY_HINTS=t.PROCESSING=t.PRECONDITION_REQUIRED=t.PRECONDITION_FAILED=t.PERMANENT_REDIRECT=t.PAYMENT_REQUIRED=t.PARTIAL_CONTENT=t.OK=t.NOT_MODIFIED=t.NOT_IMPLEMENTED=t.NOT_FOUND=t.NOT_ACCEPTABLE=t.NON_AUTHORITATIVE_INFORMATION=t.NO_CONTENT=t.NETWORK_AUTHENTICATION_REQUIRED=t.MULTIPLE_CHOICES=t.MULTI_STATUS=t.MOVED_TEMPORARILY=t.MOVED_PERMANENTLY=t.METHOD_NOT_ALLOWED=t.METHOD_FAILURE=t.LOCKED=t.LENGTH_REQUIRED=t.INTERNAL_SERVER_ERROR=t.INSUFFICIENT_STORAGE=t.INSUFFICIENT_SPACE_ON_RESOURCE=t.IM_A_TEAPOT=t.HTTP_VERSION_NOT_SUPPORTED=t.GONE=t.GATEWAY_TIMEOUT=t.FORBIDDEN=t.FAILED_DEPENDENCY=t.EXPECTATION_FAILED=t.CREATED=t.CONTINUE=t.CONFLICT=t.BAD_REQUEST=t.BAD_GATEWAY=t.ACCEPTED=void 0,t.MISDIRECTED_REQUEST=t.USE_PROXY=t.UNSUPPORTED_MEDIA_TYPE=t.UNPROCESSABLE_ENTITY=t.UNAVAILABLE_FOR_LEGAL_REASONS=t.UNAUTHORIZED=t.TOO_MANY_REQUESTS=t.TEMPORARY_REDIRECT=void 0,t.ACCEPTED=202,t.BAD_GATEWAY=502,t.BAD_REQUEST=400,t.CONFLICT=409,t.CONTINUE=100,t.CREATED=201,t.EXPECTATION_FAILED=417,t.FAILED_DEPENDENCY=424,t.FORBIDDEN=403,t.GATEWAY_TIMEOUT=504,t.GONE=410,t.HTTP_VERSION_NOT_SUPPORTED=505,t.IM_A_TEAPOT=418,t.INSUFFICIENT_SPACE_ON_RESOURCE=419,t.INSUFFICIENT_STORAGE=507,t.INTERNAL_SERVER_ERROR=500,t.LENGTH_REQUIRED=411,t.LOCKED=423,t.METHOD_FAILURE=420,t.METHOD_NOT_ALLOWED=405,t.MOVED_PERMANENTLY=301,t.MOVED_TEMPORARILY=302,t.MULTI_STATUS=207,t.MULTIPLE_CHOICES=300,t.NETWORK_AUTHENTICATION_REQUIRED=511,t.NO_CONTENT=204,t.NON_AUTHORITATIVE_INFORMATION=203,t.NOT_ACCEPTABLE=406,t.NOT_FOUND=404,t.NOT_IMPLEMENTED=501,t.NOT_MODIFIED=304,t.OK=200,t.PARTIAL_CONTENT=206,t.PAYMENT_REQUIRED=402,t.PERMANENT_REDIRECT=308,t.PRECONDITION_FAILED=412,t.PRECONDITION_REQUIRED=428,t.PROCESSING=102,t.EARLY_HINTS=103,t.UPGRADE_REQUIRED=426,t.PROXY_AUTHENTICATION_REQUIRED=407,t.REQUEST_HEADER_FIELDS_TOO_LARGE=431,t.REQUEST_TIMEOUT=408,t.REQUEST_TOO_LONG=413,t.REQUEST_URI_TOO_LONG=414,t.REQUESTED_RANGE_NOT_SATISFIABLE=416,t.RESET_CONTENT=205,t.SEE_OTHER=303,t.SERVICE_UNAVAILABLE=503,t.SWITCHING_PROTOCOLS=101,t.TEMPORARY_REDIRECT=307,t.TOO_MANY_REQUESTS=429,t.UNAUTHORIZED=401,t.UNAVAILABLE_FOR_LEGAL_REASONS=451,t.UNPROCESSABLE_ENTITY=422,t.UNSUPPORTED_MEDIA_TYPE=415,t.USE_PROXY=305,t.MISDIRECTED_REQUEST=421},96137:(e,t,a)=>{"use strict";a.d(t,{Lt:()=>u,pY:()=>p,wY:()=>m});var i=a(58933),s=a(20041),r=a(7860);let n=null,l=null,o=["javascript","typescript","ts","tsx","jsx","json","jsonc","html","css","python","bash","shell","markdown","yaml","sql","java","cpp","c","go","rust","php","ruby","swift","text","plaintext"],c=["github-light","github-dark"];async function d(){return n||l||(l=(0,s.O_)({themes:c,langs:o}),n=await l)}function u(){d()}async function m(e,t,a){let i=await d(),s=o.includes(t)?t:"plaintext";return i.codeToHtml(e,{lang:s,theme:a,transformers:[{pre(e){this.addClassToHast(e,"shiki-code-block")},code(e){e.properties.class=(0,r.cn)("whitespace-pre-wrap break-words")}}]})}async function p(e,t,a,s){let r=await d(),n=o.includes(t)?t:"plaintext",l=e,c=e.split("\n");return"create"===s?l=c.map(e=>"+".concat(e)).join("\n"):"delete"===s?l=c.map(e=>"-".concat(e)).join("\n"):/^[+-]/m.test(e)||(l=c.map(e=>"+".concat(e)).join("\n")),r.codeToHtml(l,{lang:n,theme:a,transformers:[(0,i.N6)(),{name:"diff-transformer",preprocess(e){return this.meta={originalLines:e.split("\n")},e},pre(e){this.addClassToHast(e,"shiki-code-block"),this.addClassToHast(e,"has-diff")},line(e,t){var a,i,s;let r=null!=(s=(null!=(i=null==(a=this.meta)?void 0:a.originalLines)?i:[])[t-1])?s:"";r.startsWith("+")?(this.addClassToHast(e,"line"),this.addClassToHast(e,"diff"),this.addClassToHast(e,"add")):r.startsWith("-")?(this.addClassToHast(e,"line"),this.addClassToHast(e,"diff"),this.addClassToHast(e,"remove")):r.startsWith(" ")&&(this.addClassToHast(e,"line"),this.addClassToHast(e,"diff"))},span(e,t,a){var i,s,r;let n=null!=(r=(null!=(s=null==(i=this.meta)?void 0:i.originalLines)?s:[])[t-1])?r:"";if(0===a&&(n.startsWith("+")||n.startsWith("-")||n.startsWith(" "))){let t=e=>{if(!e)return!1;if("text"===e.type&&e.value){let t=e.value;if(t.length>0&&(t.startsWith("+")||t.startsWith("-")||t.startsWith(" ")))return e.value=t.slice(1),!0}if(e.children&&Array.isArray(e.children)){for(let a of e.children)if(t(a))return!0}return!1};t(e)}}}]})}},96589:(e,t,a)=>{"use strict";var i=Object.create?function(e,t,a,i){void 0===i&&(i=a);var s=Object.getOwnPropertyDescriptor(t,a);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[a]}}),Object.defineProperty(e,i,s)}:function(e,t,a,i){void 0===i&&(i=a),e[i]=t[a]},s=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},r=function(){var e=function(t){return(e=Object.getOwnPropertyNames||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[t.length]=a);return t})(t)};return function(t){if(t&&t.__esModule)return t;var a={};if(null!=t)for(var r=e(t),n=0;n<r.length;n++)"default"!==r[n]&&i(a,t,r[n]);return s(a,t),a}}();t.f$=t.tZ=t.aq=t.EV=void 0;r(a(91256)),r(a(68336));t.EV="recaptcha validation failed";t.aq="prompt failed";t.tZ="This model is not permitted to handle this type of question. Please choose another model.";t.f$="Chosen Model(s) are no longer available"}}]);
//# chunkId=019c97ba-c8b2-7322-9a53-6881c6bed408